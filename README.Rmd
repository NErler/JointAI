---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  fig.align = 'center'
)
```

# JointAI: Joint Analysis and Imputation of Incomplete Data

[![Travis-CI Build Status](https://travis-ci.org/NErler/JointAI.svg?branch=master)](https://travis-ci.org/NErler/JointAI)
[![CRAN_Status_Badge](https://www.r-pkg.org/badges/version-last-release/JointAI)](https://CRAN.R-project.org/package=JointAI)
[![](https://cranlogs.r-pkg.org/badges/grand-total/JointAI)](https://CRAN.R-project.org/package=JointAI)
[![Download counter](http://cranlogs.r-pkg.org/badges/JointAI)](https://cran.r-project.org/package=JointAI)
[![Rdoc](http://www.rdocumentation.org/badges/version/JointAI)](http://www.rdocumentation.org/packages/JointAI)


The package **JointAI** provides joint analysis and imputation of 
(generalized) linear regression models, (generalized) linear mixed models 
and parametric (Weibull) survival models with incomplete (covariate) data in 
the Bayesian framework.

The package performs some preprocessing of the data and creates a 
[JAGS](http://mcmc-jags.sourceforge.net) model, which will then automatically 
be passed to [JAGS](http://mcmc-jags.sourceforge.net)
with the help of the R package [**rjags**](https://CRAN.R-project.org/package=rjags).

**JointAI** also provides summary and plotting functions for the output.

    
## Installation

You can install **JointAI** from GitHub with:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("NErler/JointAI")
```


## Main functions
Currently, there are three main functions that perform linear, generalized linear
or linear mixed regression:
```{r mainfun, eval = FALSE}
lm_imp()
glm_imp()
lme_imp()
glme_imp()
survreg_imp()
```

`lm_imp()` and `glm_imp()` use specification similar to their complete data
counterparts `lm()` and `glm()`, whereas `lme_imp()` uses similar specification 
as `lme()` from the package [**nlme**](https://CRAN.R-project.org/package=nlme).
`glme_imp()` uses a combination of the specifications from `glm()` (with regards
to the family) and `lme` (with regards to the random effects structure).
`survreg_imp()` is a missing data version of `survreg` from the package 
[**survival**](https://CRAN.R-project.org/package=survival).

Functions `summary()`, `traceplot()`, `densityplot()` provide a summary of the
posterior distribution and its visualization.

`GR_crit()` and `MC_error()` provide the Gelman-Rubin diagnostic for convergence
and the Monte Carlo error of the MCMC sample, respectively.


## Minimal Example
### Visualize the observed data and missing data pattern
```{r, fig.width = 8, fig.height = 4, message = FALSE}
library(JointAI)

par(mar = c(2.5, 3, 2.5, 1), mgp = c(2, 0.8, 0))
plot_all(NHANES[c(1, 5:6, 8:12)], fill = '#18bc9c', border = '#2C3E50', ncol = 4, nclass = 30)
```


```{r, fig.height = 5}
md_pattern(NHANES, color = c('#2C3E50', '#18bc9c'))
```

### Fit a linear regression model with incomplete covariates

```{r fit_lm1, message = F}
lm1 <- lm_imp(SBP ~ gender + age + WC + alc + educ + bili,
              data = NHANES, n.iter = 500, progress.bar = 'none')
```

### Visualize the MCMC sample
```{r fig.width = 8, fig.height = 4, out.width = '100%', dpi = 300}
traceplot(lm1, col = c('#E74C3C', '#2C3E50', '#18bc9c'), ncol = 4)
```

```{r fig.width = 8, fig.height = 4, out.width = '100%', dpi = 300}
densplot(lm1, col = c('#E74C3C', '#2C3E50', '#18bc9c'), ncol = 4, lwd = 2)
```

### Summarize the Result
```{r}
summary(lm1)
```

```{r}
coef(lm1)

confint(lm1)
```


[{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"visualizing-the-posterior-sample","dir":"Articles","previous_headings":"","what":"Visualizing the posterior sample","title":"After Fitting","text":"posterior sample can visualized two commonly used plots: trace plot, showing samples across iterations, plot empirical density posterior sample.","code":""},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"trace-plot","dir":"Articles","previous_headings":"Visualizing the posterior sample","what":"Trace plot","title":"After Fitting","text":"trace plot shows sampled values per chain node throughout iterations. allows us evaluate convergence mixing chains visually, can obtained function traceplot():  sampler converged chains show one horizontal band, figure. Consequently, traces show trend convergence reached iterations necessary (e.g., using add_samples()). Graphical aspects traceplot can controlled specifying standard graphical arguments via dots argument \"...\", passed matplot(). allows changing colour, line type -width, limits, forth. Arguments nrow /ncol can supplied set specific numbers rows columns layout grid plots. argument use_ggplot possible get ggplot2 version traceplot. can extended using standard ggplot2 syntax.","code":"mod13a <- lm_imp(SBP ~ gender + WC + alc + creat, data = NHANES, n.iter = 500,                  seed = 2020)  traceplot(mod13a) library(ggplot2) traceplot(mod13a, ncol = 3, use_ggplot = TRUE) +   theme(legend.position = 'bottom') +   scale_color_brewer(palette = 'Dark2')"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"density-plot","dir":"Articles","previous_headings":"Visualizing the posterior sample","what":"Density plot","title":"After Fitting","text":"posterior distributions can also visualized using function densplot(), plots empirical density per node per chain, combining chains (joined = TRUE). argument vlines takes list lists, containing specifications passed abline, allows us add (vertical) lines plot, e.g., marking zero: marking posterior mean 2.5% 97.5% quantiles:  Like traceplot() possible use ggplot2 version densplot() setting use_ggplot = TRUE. , vertical lines can added additional layers:","code":"densplot(mod13a, ncol = 3, col = c(\"darkred\", \"darkblue\", \"darkgreen\"),          vlines = list(list(v = c(rep(0, length(coef(mod13a)$SBP)), NA),                             col = grey(0.8)))) res <- rbind(summary(mod13a)$res$SBP$regcoef[, c('Mean', '2.5%', '97.5%')],              summary(mod13a)$res$SBP$sigma[, c('Mean', '2.5%', '97.5%')])  densplot(mod13a, ncol = 3,          vlines = list(list(v = res[, 'Mean'], lty = 1,                             lwd = 2),                        list(v = res[, \"2.5%\"], lty = 2),                        list(v = res[, \"97.5%\"], lty = 2)          ) ) # fit the complete-case version of the model mod13a_cc <- lm(formula(mod13a), data = NHANES, na.action = na.omit)   # make a dataset containing the quantiles of the posterior sample and # confidence intervals from the complete case analysis: quantDF <- rbind(data.frame(variable = rownames(summary(mod13a)$res$SBP$regcoef),                             type = '2.5%',                             model = 'JointAI',                             value = summary(mod13a)$res$SBP$regcoef[, c('2.5%')]                             ),                  data.frame(variable = rownames(summary(mod13a)$res$SBP$regcoef),                             type = '97.5%',                             model = 'JointAI',                             value = summary(mod13a)$res$SBP$regcoef[, c('97.5%')]                  ),                  data.frame(variable = names(coef(mod13a_cc)),                             type = '2.5%',                             model = 'cc',                             value = confint(mod13a_cc)[, '2.5 %']                  ),                  data.frame(variable = names(coef(mod13a_cc)),                             type = '97.5%',                             model = 'cc',                             value = confint(mod13a_cc)[, '97.5 %']                  ) )   # ggplot version: p13a <- densplot(mod13a, use_ggplot = TRUE, joined = TRUE) +   theme(legend.position = 'bottom')   # add vertical lines for the: # - confidence intervals from the complete case analysis # - quantiles of the posterior distribution p13a +   geom_vline(data = quantDF, aes(xintercept = value, color = model),              lty = 2) +   scale_color_manual(name = 'CI from model: ',                      limits = c('JointAI', 'cc'),                      values = c('blue', 'red'),                      labels = c('JointAI', 'compl.case'))"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"model-summary","dir":"Articles","previous_headings":"","what":"Model Summary","title":"After Fitting","text":"summary posterior distribution estimated JointAI model can obtained using function summary(). posterior summary consists mean, standard deviation quantiles (default, 2.5% 97.5% quantiles) MCMC samples chains combined. Moreover, tail probability (see ), Gelman-Rubin criterion (see section ) ratio Monte Carlo error posterior standard deviation (see section ) given. Additionally, essential characteristics MCMC samples summary based given. includes range number iterations (“Sample size per chain”), thinning interval, number chains. Furthermore, number observations (number rows data) given. mixed models, summary() also returns posterior summary random effects covariance matrix D number groups. argument missinfo = TRUE add information missing values variables involved model: end summary output, summary number proportion missing values per variable printed","code":"summary(mod13a) #>  #> Bayesian linear model fitted with JointAI #>  #> Call: #> lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES,  #>     n.iter = 500, seed = 2020) #>  #>  #> Posterior summary: #>                Mean     SD  2.5%  97.5% tail-prob. GR-crit MCE/SD #> (Intercept)  81.077 9.6921 61.66 99.602      0.000   1.011 0.0258 #> genderfemale  0.368 2.6138 -4.74  5.594      0.871   0.999 0.0258 #> WC            0.306 0.0736  0.16  0.448      0.000   1.012 0.0259 #> alc>=1        6.365 2.4692  1.38 10.897      0.016   1.006 0.0291 #> creat         7.747 7.5949 -7.19 22.496      0.299   1.003 0.0264 #>  #> Posterior summary of residual std. deviation: #>           Mean    SD 2.5% 97.5% GR-crit MCE/SD #> sigma_SBP 14.4 0.779   13    16    1.02 0.0278 #>  #>  #> MCMC settings: #> Iterations = 101:600 #> Sample size per chain = 500  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 186 library(splines) mod13b <- lme_imp(bmi ~ GESTBIR + ETHN + HEIGHT_M + ns(age, df = 3),                   random = ~ 1 | ID,                   data = subset(simLong, !is.na(bmi)),                   n.iter = 500, no_model = 'age', seed = 2020) summary(mod13b, missinfo = TRUE) #>  #> Bayesian linear mixed model fitted with JointAI #>  #> Call: #> lme_imp(fixed = bmi ~ GESTBIR + ETHN + HEIGHT_M + ns(age, df = 3),  #>     data = subset(simLong, !is.na(bmi)), random = ~1 | ID, n.iter = 500,  #>     no_model = \"age\", seed = 2020) #>  #>  #> Posterior summary: #>                       Mean      SD    2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)      17.567738 2.30929 12.9758 21.9295      0.000    1.01 0.0271 #> GESTBIR          -0.049258 0.04749 -0.1427  0.0472      0.312    1.00 0.0258 #> ETHNother         0.022619 0.15328 -0.2763  0.3213      0.883    1.00 0.0269 #> HEIGHT_M          0.000925 0.00962 -0.0174  0.0195      0.936    1.02 0.0274 #> ns(age, df = 3)1 -0.245192 0.07574 -0.3947 -0.0950      0.000    1.00 0.0258 #> ns(age, df = 3)2  1.939673 0.11262  1.7100  2.1489      0.000    1.00 0.0258 #> ns(age, df = 3)3 -1.247972 0.05842 -1.3656 -1.1326      0.000    1.01 0.0258 #>  #>  #> Posterior summary of random effects covariance matrix: #>                Mean     SD  2.5% 97.5% tail-prob. GR-crit MCE/SD #> D_bmi_ID[1,1] 0.696 0.0781 0.552 0.858               1.02 0.0278 #>  #>  #> Posterior summary of residual std. deviation: #>            Mean     SD  2.5% 97.5% GR-crit MCE/SD #> sigma_bmi 0.684 0.0119 0.662 0.709       1 0.0269 #>  #>  #> MCMC settings: #> Iterations = 101:600 #> Sample size per chain = 500  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 1881  #> Number of groups: #>  - ID: 200 #>  #>  #> Number and proportion of complete cases: #>         level    #   % #> ID         ID  190  95 #> lvlone lvlone 1881 100 #>  #> Number and proportion of missing values: #>      level # NA % NA #> bmi lvlone    0    0 #> age lvlone    0    0 #>  #>          level # NA % NA #> GESTBIR     ID    0    0 #> ID          ID    0    0 #> HEIGHT_M    ID    4    2 #> ETHN        ID    6    3"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"tail-probability","dir":"Articles","previous_headings":"Model Summary","what":"Tail probability","title":"After Fitting","text":"tail probability, calculated 2\\times\\min\\left\\{Pr(\\theta > 0), Pr(\\theta < 0)\\right\\}, \\theta parameter interest, measure likely value 0 estimated posterior distribution. figure visualizes three examples posterior distributions corresponding minimum Pr(\\theta > 0) Pr(\\theta < 0) (shaded area):","code":""},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"evaluation-criteria","dir":"Articles","previous_headings":"","what":"Evaluation criteria","title":"After Fitting","text":"convergence MCMC chains precision posterior sample can also evaluated formally. Implemented JointAI Gelman-Rubin criterion convergence1 comparison Monte Carlo Error posterior standard deviation.","code":""},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"sec:grcrit","dir":"Articles","previous_headings":"Evaluation criteria","what":"Gelman-Rubin criterion for convergence","title":"After Fitting","text":"Gelman-Rubin criterion evaluates convergence comparing within chain variability , thus, requires least two MCMC chains calculated. implemented JointAI objects function GR_crit(), based function gelman.diag() package coda. upper limit confidence interval much larger 1. Besides arguments start, end, thin, subset, explained , GR_crit() also takes arguments gelman.diag().","code":"GR_crit(mod13a) #> Potential scale reduction factors: #>  #>              Point est. Upper C.I. #> (Intercept)        1.01       1.02 #> genderfemale       1.00       1.01 #> WC                 1.00       1.01 #> alc>=1             1.00       1.01 #> creat              1.00       1.00 #> sigma_SBP          1.02       1.05 #>  #> Multivariate psrf #>  #> 1.01"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"sec:mcerror","dir":"Articles","previous_headings":"Evaluation criteria","what":"Monte Carlo Error","title":"After Fitting","text":"precision MCMC sample can checked function MC_error(). uses function mcmcse::mcmcse.mat() package mcmcse calculate Monte Carlo error (error made since sample finite) compares standard deviation posterior sample. rule thumb Monte Carlo error 5% standard deviation2. Besides arguments explained , MC_error() takes arguments mcmcse.mat(). MC_error() returns object class MCElist, list containing matrices posterior mean, estimated Monte Carlo error, posterior standard deviation ratio Monte Carlo error posterior standard deviation, scaled (part JointAI object) unscaled (transformed back scale data) posterior samples. associated print method prints latter. facilitate quick evaluation Monte Carlo error posterior standard deviation ratio, plotting object class MCElist using plot() shows ratio (selected) node automatically adds vertical line desired cut-(default 5%).","code":"MC_error(mod13a) #>                est   MCSE    SD MCSE/SD #> (Intercept)  81.08 0.2502 9.692   0.026 #> genderfemale  0.37 0.0675 2.614   0.026 #> WC            0.31 0.0019 0.074   0.026 #> alc>=1        6.37 0.0718 2.469   0.029 #> creat         7.75 0.2007 7.595   0.026 #> sigma_SBP    14.40 0.0217 0.779   0.028 par(mar = c(3, 5, 0.5, 0.5), mgp = c(2, 0.6, 0), mfrow = c(1, 2)) plot(MC_error(mod13a))  # left panel: all iterations 101:600 plot(MC_error(mod13a, end = 250))  # right panel: iterations 101:250"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"sec:subset","dir":"Articles","previous_headings":"","what":"Subset of output","title":"After Fitting","text":"default, functions traceplot(), densplot(), summary(), GR_crit(), MC_Error() predict() use iterations MCMC sample consider parameters analysis model (monitored). section, describe set iterations parameters display can changed using arguments subset, start, end, thin exclude_chains.","code":""},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"subset-of-parameters","dir":"Articles","previous_headings":"Subset of output","what":"Subset of parameters","title":"After Fitting","text":"long main parameters monitored JointAI object, parameters returned model summary, plots criteria shown . main parameters analysis model monitored, .e., monitor_params = c(analysis_main = FALSE), argument subset specified, parameters monitored displayed. display output nodes main parameters analysis model subset nodes, argument subset needs specified.","code":""},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"examples","dir":"Articles","previous_headings":"Subset of output > Subset of parameters","what":"Examples","title":"After Fitting","text":"display parameters imputation models, set subset = c(analysis_main = FALSE, other_models = TRUE) (re-estimating model monitor parameters switched ): select parameters, can specified directly name via element subset.  also works subset imputed values displayed:  number imputed values large order check convergence random effects, may feasible plot inspect trace plots. case random subset , instance random effects, can selected (output shown):","code":"mod13c <- update(mod13a, monitor_params = c(other_models = TRUE)) summary(mod13c, subset = c(analysis_main = FALSE, other_models = TRUE)) #>  #> Bayesian joint model fitted with JointAI  #>  #> Call: #> lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES,  #>     n.iter = 500, monitor_params = c(other_models = TRUE), seed = 2020) #>  #>  #> # --------------------------------------------------------------------- # #>   Bayesian binomial model for \"alc\" #> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # #>  #> Posterior summary: #>                  Mean     SD    2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)   0.51390 1.5325 -2.6068  3.4078     0.7080    1.01 0.0535 #> genderfemale -0.88236 0.3995 -1.6322 -0.0498     0.0373    1.04 0.0762 #> WC            0.00632 0.0115 -0.0169  0.0298     0.5627    1.01 0.0375 #> creat        -1.48151 1.2238 -3.9056  0.9785     0.2213    1.00 0.0603 #>  #>  #> # --------------------------------------------------------------------- # #>   Bayesian linear model for \"creat\" #> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # #>  #> Posterior summary: #>                   Mean       SD      2.5%    97.5% tail-prob. GR-crit MCE/SD #> (Intercept)   0.844704 0.076409  0.694938  0.99127      0.000       1 0.0258 #> genderfemale -0.178815 0.022122 -0.223627 -0.13699      0.000       1 0.0258 #> WC            0.000877 0.000772 -0.000612  0.00243      0.256       1 0.0258 #>  #> Posterior summary of residual std. deviation: #>              Mean      SD  2.5% 97.5% GR-crit MCE/SD #> sigma_creat 0.145 0.00769 0.132 0.161    1.01 0.0277 #>  #>  #> # --------------------------------------------------------------------- # #>   Bayesian linear model for \"WC\" #> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # #>  #> Posterior summary: #>               Mean   SD  2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)  97.41 1.52 94.48 100.469     0.0000    1.00 0.0258 #> genderfemale -5.16 2.21 -9.38  -0.971     0.0147    1.01 0.0258 #>  #> Posterior summary of residual std. deviation: #>          Mean    SD 2.5% 97.5% GR-crit MCE/SD #> sigma_WC 14.5 0.785 13.2  16.3       1 0.0258 #>  #>  #> # ----------------------------------------------------------- # #>  #> MCMC settings: #> Iterations = 101:600 #> Sample size per chain = 500  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 186 densplot(mod13c, subset = list(analysis_main = FALSE,                                other = c('beta[4]', 'beta[5]')), nrow = 1) # re-fit the model and monitor the imputed values mod13d <- update(mod13a, monitor_params = c(imps = TRUE)) # select all imputed values for 'WC' (4th column of M_lvlone) sub3 <- grep('M_lvlone\\\\[[[:digit:]]+,4\\\\]', parameters(mod13d)$coef, value = TRUE) sub3 #> [1] \"M_lvlone[33,4]\"  \"M_lvlone[150,4]\"  # pass \"sub3\" to \"subset\" via \"other\", for example in a traceplot: traceplot(mod13d, subset = list(analysis_main = FALSE, other = sub3), ncol = 2) # re-fit the model monitoring the random effects mod13e <- update(mod13b, monitor_params = c(ranef_main = TRUE)) # extract random intercepts ri <- grep('^b_bmi_ID\\\\[[[:digit:]]+,1\\\\]$', colnames(mod13e$MCMC[[1]]), value = T)  # to plot the chains of 12 randomly selected random intercepts and slopes: traceplot(mod13e, subset = list(analysis_main = FALSE,                                 other = sample(ri, size = 12)), ncol = 4)"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"subset-of-mcmc-samples","dir":"Articles","previous_headings":"Subset of output","what":"Subset of MCMC samples","title":"After Fitting","text":"arguments start, end thin possible select iterations MCMC sample included summary. start end specify first last iterations used, thin thinning interval. Specification start, thus, allows discarding “burn-”, .e., iterations MCMC chain converged. particular chain converged can excluded summary plot using argument exclude_chains. argument takes numeric vector identifying chains excluded, example:","code":"mod14 <- lm_imp(SBP ~ gender + WC + alc + creat, data = NHANES, n.iter = 100,                 progress.bar = 'none', n.chains = 5)  densplot(mod14, ncol = 3) densplot(mod14, exclude_chains = c(2,4), ncol = 3) traceplot(mod14, thin = 10, ncol = 3) traceplot(mod14, start = 150, ncol = 3) traceplot(mod14, end = 120, ncol = 3)"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"predicted-values","dir":"Articles","previous_headings":"","what":"Predicted values","title":"After Fitting","text":"Often, aim analysis estimate association outcome covariates predict future outcomes outcomes new subjects. function predict() allows us obtain predicted values corresponding credible intervals JointAI objects. Note mixed models, currently, marginal prediction prediction conditional random effects implemented. dataset containing data prediction performed specified via argument newdata. newdata given, original data JointAI object used. argument quantiles allows specification quantiles posterior sample used obtain credible interval (default 2.5% 97.5% quantile). Arguments start, end, thin exclude_chains control subset MCMC samples used. predict() returns list elements dat, fit quantiles, containing newdata predicted values quantiles appended, predicted values quantiles form credible interval.","code":"predict(mod13a, newdata = NHANES[27, ]) #> $newdata #>          SBP gender age             race   WC alc educ creat albu #> 392 126.6667   male  32 Mexican American 94.1  <1  low  0.83  4.2 #>     uricacid bili occup  smoke      fit     2.5%    97.5% #> 392      8.7    1  <NA> former 116.3273 112.4343 120.1817 #>  #> $fitted #>        fit     2.5%    97.5% #> 1 116.3273 112.4343 120.1817"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"prediction-to-visualize-non-linear-effects","dir":"Articles","previous_headings":"Predicted values","what":"Prediction to visualize non-linear effects","title":"After Fitting","text":"Another reason obtain predicted values visualization non-linear effects, .e., create effect plot. facilitate generation dataset prediction, function predDF() can used. generates data.frame contains sequence values range observed values covariate specified argument vars, median reference value continuous categorical variables.  possible multiple variables vary set values variables:","code":"# create dataset for prediction newDF <- predDF(mod13b, var = ~ age)  # obtain predicted values pred <- predict(mod13b, newdata = newDF) #> Warning:  #> Prediction in multi-level settings currently only takes into #> account the fixed effects, i.e., assumes that the random #> effect realizations are equal to zero.  # plot predicted values and credible interval matplot(pred$newdata$age, pred$fitted,         lty = c(1,2,2), type = 'l', col = 1,         xlab = 'age in months', ylab = 'predicted value') # create dataset for prediction newDF <- predDF(mod13b, var = ~ age + HEIGHT_M + ETHN, HEIGHT_M = c(150, 180))  # obtain predicted values pred <- predict(mod13b, newdata = newDF) #> Warning:  #> Prediction in multi-level settings currently only takes into #> account the fixed effects, i.e., assumes that the random #> effect realizations are equal to zero. #> Error in `MCMC[, coefs$coef[match(colnames(desgn_mat), coefs$varname)], drop = FALSE]`: #> ! subscript out of bounds   # plot predicted values and credible interval library(ggplot2) ggplot(pred$newdata, aes(x = age, y = fit, color = factor(HEIGHT_M),                          fill = factor(HEIGHT_M))) +   geom_ribbon(aes(ymin = `2.5%`, ymax = `97.5%`), alpha = 0.3) +   geom_line(size = 1) +   facet_wrap('ETHN') +   theme(legend.position = 'top',         panel.grid = element_blank()) +   scale_fill_viridis_d(name = 'maternal height',                        aesthetics = c('colour', 'fill')) +   scale_y_continuous(name = 'Expected BMI', breaks = seq(15, 18, 0.5))"},{"path":"https://nerler.github.io/JointAI/articles/AfterFitting.html","id":"export-of-imputed-values","dir":"Articles","previous_headings":"","what":"Export of imputed values","title":"After Fitting","text":"Imputed datasets can extracted JointAI object (monitor imputed values set, .e., monitor_params = c(imps = TRUE)), function get_MIdat(). completed dataset created taking imputed values randomly chosen iteration MCMC sample, transforming back original scale scaling performed MCMC sampling, filling original incomplete data. argument m specifies number imputed datasets created, include controls whether original data included long format data.frame (default include = TRUE), start specifies first iteration may used minspace minimum number iterations iterations eligible selected. make selection iterations form imputed data reproducible, seed value can specified via argument seed. export_to_SPSS = TRUE imputed data exported SPSS, .e., .txt file containing data .sps file containing SPSS syntax convert data SPSS data file (ending .sav) written. Arguments filename resdir allow specification name .txt .sps file directory written . get_MIdat() returns long-format data.frame containing imputed datasets (default original data) stacked onto . imputation number given variable Imputation_, column .id contains newly created id variable observation cross-sectional data (multi-level data already contain id variable). function plot_imp_distr() allows us visually compare distribution observed imputed values.","code":"impDF <- get_MIdat(mod13d, m = 10, seed = 2018) plot_imp_distr(impDF, nrow = 1)"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"mcmc-related-parameters-in-jointai","dir":"Articles","previous_headings":"","what":"MCMC related parameters in JointAI","title":"MCMC Settings","text":"main functions *_imp() number arguments specify settings MCMC sampling: n.chains: number MCMC chains n.adapt: number iterations adaptive phase n.iter: number iterations sampling phase thin: thinning degree monitor_params: parameters/nodes monitored seed: optional seed value reproducibility inits: initial values parameters passed functions rjags: quiet: printing information suppressed? progress.bar: type progress bar","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"chains-and-iterations","dir":"Articles","previous_headings":"","what":"Chains and Iterations","title":"MCMC Settings","text":"MCMC sampling, values drawn probability distribution. distribution current value drawn depends previously drawn value (values ). Values, thus, form chain. chain converged, elements can seen sample target posterior distribution.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"number-of-chains","dir":"Articles","previous_headings":"Chains and Iterations","what":"Number of chains","title":"MCMC Settings","text":"evaluate convergence MCMC chains helpful create multiple chains different starting values. argument n.chains selects number chains (default, n.chains = 3). calculating model summary, multiple chains merged.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"adaptive-phase","dir":"Articles","previous_headings":"Chains and Iterations","what":"Adaptive phase","title":"MCMC Settings","text":"JAGS adaptive mode, samplers optimized (example step size adjusted). Samples obtained adaptive mode form Markov chain discarded. argument n.adapt controls length adaptive phase. default value n.adapt 100, works well many examples considered . Complex models may require longer adaptive phases. adaptive phase sufficient JAGS optimize samplers, warning message printed (see example ).","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"sampling-iterations","dir":"Articles","previous_headings":"Chains and Iterations","what":"Sampling iterations","title":"MCMC Settings","text":"n.iter specifies number iterations sampling phase, .e., length MCMC chain. many samples required reach convergence sufficient precision depends complexity data model, may range 100 several million.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"side-note-how-to-evaluate-convergence","dir":"Articles","previous_headings":"Chains and Iterations > Sampling iterations","what":"Side note: How to evaluate convergence?","title":"MCMC Settings","text":"Convergence can, instance, evaluated visually using traceplot() using Gelman-Rubin diagnostic criterion1 (implemented GR_crit(), also returned model summary). latter compares within chain variability requires JointAI object least two chains.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"side-note-how-to-check-precision","dir":"Articles","previous_headings":"Chains and Iterations > Sampling iterations","what":"Side note: How to check precision?","title":"MCMC Settings","text":"precision MCMC sample can checked function MC_error(). calculates Monte Carlo error (error made since sample finite) compares standard deviation posterior sample. rule thumb Monte Carlo error 5% standard deviation.2","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"thinning","dir":"Articles","previous_headings":"Chains and Iterations","what":"Thinning","title":"MCMC Settings","text":"settings high autocorrelation, .e., large jumps chain sampled values always close previous value, may take many iterations sample created sufficiently represents whole range posterior distribution. Processing long chains can slow take lot memory. parameter thin allows user specify much MCMC chains thinned storing . default thin = 1 used, corresponds keeping values. value thin = 10 result keeping every 10th value discarding values.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"default-settings","dir":"Articles","previous_headings":"Chains and Iterations > Examples","what":"Default settings","title":"MCMC Settings","text":"n.adapt = 100 thin = 1 100 sampling iterations relevant part model summary (obtained summary()) shows first 100 iterations (adaptive phase) discarded, 100 iterations follow form posterior sample. Thinning set 1 3 chains.","code":"mod1 <- lm_imp(SBP ~ alc, data = NHANES, n.iter = 100, progress.bar = 'none') #> [...] #> MCMC settings: #> Iterations = 101:200 #> Sample size per chain = 100  #> Thinning interval = 1  #> Number of chains = 3"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"insufficient-adaptation-phase","dir":"Articles","previous_headings":"Chains and Iterations > Examples","what":"Insufficient adaptation phase","title":"MCMC Settings","text":"Specifying n.adapt = 10 results warning message. relevant part model summary resulting model :","code":"mod2 <- lm_imp(   SBP ~ alc,   data = NHANES,   n.adapt = 10,   n.iter = 100,   progress.bar = 'none' ) #> Warning in rjags::jags.model(file = modelfile, data = data_list, inits = inits, : Adaptation #> incomplete #> NOTE: Stopping adaptation #> [...] #> MCMC settings: #> Iterations = 11:110 #> Sample size per chain = 100  #> Thinning interval = 1  #> Number of chains = 3"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"thinning-1","dir":"Articles","previous_headings":"Chains and Iterations > Examples","what":"Thinning","title":"MCMC Settings","text":", iterations 110 600 used output, due thinning interval ten, resulting MCMC chains contain 50 samples instead 500, , samples iteration 110, 120, 130, …","code":"mod3 <- lm_imp(   SBP ~ alc,   data = NHANES,   n.iter = 500,   thin = 10,   progress.bar = 'none' ) #> [...] #> MCMC settings: #> Iterations = 110:600 #> Sample size per chain = 49  #> Thinning interval = 10  #> Number of chains = 3"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"parameters-to-follow","dir":"Articles","previous_headings":"","what":"Parameters to follow","title":"MCMC Settings","text":"JAGS saves values MCMC chains nodes/parameters user specified monitored. also case JointAI.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"what-are-nodes","dir":"Articles","previous_headings":"Parameters to follow","what":"What are nodes?","title":"MCMC Settings","text":"Nodes variables Bayesian framework, .e., everything observed unobserved. includes data parameters estimated, also missing values data parts data generally unobserved, random effects latent class indicators.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"specifying-which-nodes-should-be-monitored","dir":"Articles","previous_headings":"Parameters to follow","what":"Specifying which nodes should be monitored","title":"MCMC Settings","text":"purpose, main analysis functions *_imp argument monitor_params. details, explanation examples see vignette Parameter Selection.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"initial-values","dir":"Articles","previous_headings":"","what":"Initial values","title":"MCMC Settings","text":"Initial values starting point MCMC sampler. Setting good initial values, .e., initial values likely posterior distribution, can speed convergence. default, argument inits = NULL, means initial values nodes generated JAGS. JointAI sets initial values random number generators allow reproducibility results. argument seed allows specification seed value starting values random number generator can reproduced.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"user-specified-initial-values","dir":"Articles","previous_headings":"Initial values","what":"User-specified initial values","title":"MCMC Settings","text":"possible supply initial values directly list function. Initial values can specified every unobserved node, , parameters missing values, possible specify initial values subset nodes. Unless user-specified initial values contain initial values random number generator (named .RNG.name .RNG.seed), JointAI add initial values. necessary reproducibility results also MCMC chains sampled parallel.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"initial-values-in-a-list-of-lists","dir":"Articles","previous_headings":"Initial values > User-specified initial values","what":"Initial values in a list of lists","title":"MCMC Settings","text":"list containing initial values length number chains, element named list initial values. Initial values differ chains. example, create initial values parameter vector beta precision parameter tau_SBP three chains: list passed argument inits. amended version user provided lists initial values stored JointAI object:","code":"init_list <- lapply(1:3, function(i) {   list(beta = rnorm(4), tau_SBP = rgamma(1, 1, 1)) })  init_list #> [[1]] #> [[1]]$beta #> [1] -0.005571287  0.621552721  1.148411606 -1.821817661 #>  #> [[1]]$tau_SBP #> [1] 0.3404071 #>  #>  #> [[2]] #> [[2]]$beta #> [1] -1.5247442  1.9694248  0.4631747 -0.8561524 #>  #> [[2]]$tau_SBP #> [1] 1.063226 #>  #>  #> [[3]] #> [[3]]$beta #> [1]  0.07580396  0.49176144 -0.75354071  0.34902735 #>  #> [[3]]$tau_SBP #> [1] 0.3864889 mod4a <- lm_imp(   SBP ~ gender + age + WC,   data = NHANES,   progress.bar = 'none',   inits = init_list )  mod4a$mcmc_settings$inits #> [[1]] #> [[1]]$beta #> [1] -0.005571287  0.621552721  1.148411606 -1.821817661 #>  #> [[1]]$tau_SBP #> [1] 0.3404071 #>  #> [[1]]$.RNG.name #> [1] \"base::Marsaglia-Multicarry\" #>  #> [[1]]$.RNG.seed #> [1] 98229 #>  #>  #> [[2]] #> [[2]]$beta #> [1] -1.5247442  1.9694248  0.4631747 -0.8561524 #>  #> [[2]]$tau_SBP #> [1] 1.063226 #>  #> [[2]]$.RNG.name #> [1] \"base::Super-Duper\" #>  #> [[2]]$.RNG.seed #> [1] 25506 #>  #>  #> [[3]] #> [[3]]$beta #> [1]  0.07580396  0.49176144 -0.75354071  0.34902735 #>  #> [[3]]$tau_SBP #> [1] 0.3864889 #>  #> [[3]]$.RNG.name #> [1] \"base::Wichmann-Hill\" #>  #> [[3]]$.RNG.seed #> [1] 20660"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"initial-values-as-a-function","dir":"Articles","previous_headings":"Initial values > User-specified initial values","what":"Initial values as a function","title":"MCMC Settings","text":"Initial values can specified function. function either take arguments single argument called chain, return named list supplies values one chain. example, create initial values parameter vectors beta alpha: function supplied, function evaluated per chain resulting list stored.","code":"inits_fun <- function() {   list(beta = rnorm(4), alpha = rnorm(3)) }  inits_fun() #> $beta #> [1]  0.4681544  0.3629513 -1.3045435  0.7377763 #>  #> $alpha #> [1]  1.8885049 -0.0974451 -0.9358474   mod4b <- lm_imp(   SBP ~ gender + age + WC,   data = NHANES,   progress.bar = 'none',   inits = inits_fun )  mod4b$mcmc_settings$inits #> [[1]] #> [[1]]$beta #> [1] -0.8267890 -1.5123997  0.9353632  0.1764886 #>  #> [[1]]$alpha #> [1] 0.2436855 1.6235489 0.1120381 #>  #> [[1]]$.RNG.name #> [1] \"base::Wichmann-Hill\" #>  #> [[1]]$.RNG.seed #> [1] 30762 #>  #>  #> [[2]] #> [[2]]$beta #> [1] -0.1339970 -1.9100875 -0.2792372 -0.3134460 #>  #> [[2]]$alpha #> [1]  1.06730788  0.07003485 -0.63912332 #>  #> [[2]]$.RNG.name #> [1] \"base::Marsaglia-Multicarry\" #>  #> [[2]]$.RNG.seed #> [1] 14316 #>  #>  #> [[3]] #> [[3]]$beta #> [1] -0.0499649 -0.2514834  0.4447971  2.7554176 #>  #> [[3]]$alpha #> [1] 0.04653138 0.57770907 0.11819487 #>  #> [[3]]$.RNG.name #> [1] \"base::Mersenne-Twister\" #>  #> [[3]]$.RNG.seed #> [1] 54759"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"for-which-nodes-can-initial-values-be-specified","dir":"Articles","previous_headings":"Initial values","what":"For which nodes can initial values be specified?","title":"MCMC Settings","text":"Initial values can specified unobserved stochastic nodes, .e., parameters unobserved data distribution specified JAGS model. Initial values supplied format parameter unobserved value used JAGS model. find nodes model, function coef() package rjags can used JAGS model object. returns list current values MCMC chains, default first chain. Elements initial values structure elements list. Example: using longitudinal model simLong data example. output abbreviated show relevant parts. M_ID M_lvlone design matrices containing parts variables belong given level hierarchy. example, M_ID contains subject specific variables, M_lvlone time-varying variables. JointAI, design matrices always named M_<level>, lvlone refers lowest level, level grouping variable. first eight rows M_ID data passed JAGS (stored data_list JointAI object) : wanted specify initial values incomplete subject specific variables specify full matrix initial values corresponding M_ID. matrix look like : matrix initial values dimension matrix containing data, NA wherever value data observed (e.g., first 5 elements first column) numeric value data missing (e.g., 6th value first column). Since SMOKE categorical covariate coded using dummy coding, columns containing dummy variables (columns 4 5) well column containing original version SMOKE (first column). dummy variables calculated (sampled) JAGS model thus completely empty data matrix (otherwise JAGS throw error) matrix initial values. corresponding part JAGS model : RinvD_bmi_ID refers scale matrix Wishart prior inverse random effects design matrix D_bmi_ID. distinguish random effects different models grouping levels, names always end ..._<response>_<level>. data passed JAGS matrix specified diagonal matrix, unknown diagonal elements: diagonal elements estimated model Gamma prior. corresponding part JAGS model : element RinvD_bmi_ID initial values 2 \\times 2 matrix, positive values diagonal NA -diagonal elements, since fixed data: Elements completely unobserved, like parameter vectors alpha beta, random effects b_<response>_<level> (e.g. b_bmi_ID b_hc_ID) scalar parameters delta_<response> tau_<response> entirely specified initial values.","code":"mod4c <- lme_imp(   bmi ~ time + HEIGHT_M + hc + SMOKE,   random = ~ time | ID,   data = simLong,   no_model = 'time',   progress.bar = 'none' )  str(coef(mod4c$model)) #> List of 15 #>  $ M_ID        : num [1:200, 1:5] NA NA NA NA NA 1 NA NA NA NA ... #>  $ M_lvlone    : num [1:2400, 1:3] NA NA 0 0 NA NA NA NA NA NA ... #>  $ RinvD_bmi_ID: num [1:2, 1:2] 0.836 NA NA 0.114 #>  $ alpha       : num [1:7] 45.5303 0.1008 0.0652 0.0802 3.8216 ... #>  $ b_bmi_ID    : num [1:200, 1:2] 16 17 15.4 15.6 17.2 ... #>  $ b_hc_ID     : num [1:200, 1] 44.3 45.2 47.2 47.4 45.7 ... #>  $ beta        : num [1:6] 16.4886 0.1199 0.1475 -0.0524 -1.3963 ... #>  $ delta_SMOKE : num -1.53 #>  $ gamma_SMOKE : num [1:2] -1.2 NA #>  $ invD_bmi_ID : num [1:2, 1:2] 1.69 -1.87 -1.87 8.16 #>  $ invD_hc_ID  : num [1, 1] 0.637 #>  $ mu_b_bmi_ID : num [1:200, 1:2] NA NA NA NA NA NA NA NA NA NA ... #>  $ tau_HEIGHT_M: num 0.0195 #>  $ tau_bmi     : num 4.19 #>  $ tau_hc      : num 0.232 head(mod4c$data_list$M_ID, 8) #>       SMOKE HEIGHT_M (Intercept) SMOKEsmoked until[...] SMOKEcontin[...] #> 1.1       1 172.2782           1                     NA               NA #> 10.1      1 170.5049           1                     NA               NA #> 100.1     3 170.0612           1                     NA               NA #> 101.1     1 161.7947           1                     NA               NA #> 102.1     1 175.9738           1                     NA               NA #> 103.1    NA 163.9138           1                     NA               NA #> 104.1     3 174.1171           1                     NA               NA #> 105.1     1 154.9146           1                     NA               NA head(coef(mod4c$model)$M_ID, 8) #>      [,1] [,2] [,3] [,4] [,5] #> [1,]   NA   NA   NA   NA   NA #> [2,]   NA   NA   NA   NA   NA #> [3,]   NA   NA   NA   NA   NA #> [4,]   NA   NA   NA   NA   NA #> [5,]   NA   NA   NA   NA   NA #> [6,]    1   NA   NA   NA   NA #> [7,]   NA   NA   NA   NA   NA #> [8,]   NA   NA   NA   NA   NA #> [...] #>   # Cumulative logit model for SMOKE ---------------------------------------------- #>   for (ii in 1:200) { #>     M_ID[ii, 1] ~ dcat(p_SMOKE[ii, 1:3]) #>  #> [...] #>  #>     M_ID[ii, 4] <- ifelse(M_ID[ii, 1] == 2, 1, 0) #>     M_ID[ii, 5] <- ifelse(M_ID[ii, 1] == 3, 1, 0) #>   } #>  #> [...] mod4c$data_list['RinvD_bmi_ID'] #> $RinvD_bmi_ID #>      [,1] [,2] #> [1,]   NA    0 #> [2,]    0   NA #> [...] #>  #>   for (k in 1:2) { #>     RinvD_bmi_ID[k, k] ~ dgamma(shape_diag_RinvD, rate_diag_RinvD) #>   } #>   invD_bmi_ID[1:2, 1:2] ~ dwish(RinvD_bmi_ID[ , ], KinvD_bmi_ID) #>   D_bmi_ID[1:2, 1:2] <- inverse(invD_bmi_ID[ , ]) #>  #> [...] coef(mod4c$model)$RinvD_bmi_ID #>           [,1]      [,2] #> [1,] 0.1996369        NA #> [2,]        NA 0.9486955"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"parallel-sampling","dir":"Articles","previous_headings":"","what":"Parallel sampling","title":"MCMC Settings","text":"reduce computational time, possible perform sampling multiple MCMC chains parallel multiple cores. can achieved help package future. perform parallel sampling, plan “resolve futures” needs specified; specification determines sampling performed sequentially parallel. example, specifies different MCMC chains sampled 4 different R sessions. specification done JointAI model function called remains place overwritten. re-set sequential evaluation, can used. information parallel computation can found help files vignette package future. Unfortunately, currently possible obtain progress bar using parallel computation warning messages produced sampling returned.","code":"future::plan(future::multisession, workers = 4) future::plan(future::sequential())"},{"path":"https://nerler.github.io/JointAI/articles/MCMCsettings.html","id":"other-arguments","dir":"Articles","previous_headings":"","what":"Other arguments","title":"MCMC Settings","text":"two arguments *_imp() passed directly rjags functions jags.model() coda.samples(): quiet: messages generated compilation suppressed? progress.bar: allows select type progress bar. Possible values \"text\", \"gui\" \"none\".","code":""},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"fitting-a-linear-regression-model","dir":"Articles","previous_headings":"","what":"Fitting a linear regression model","title":"Minimal Example","text":"Fitting linear regression model JointAI straightforward function lm_imp(): specification lm_imp() similar specification linear regression model complete data using lm(). minimal example, difference lm_imp() number iterations n.iter specified. course, many parameters can (sometimes ) specified. vignette Model Specification, many parameters explained detail. n.iter specifies length Markov chain, .e., number draws posterior distribution parameter unobserved value. many iterations necessary depends data complexity model can vary 100 thousands millions. One important criterion Markov chains need converged. Convergence can evaluated visually trace plot.","code":"lm1 <- lm_imp(SBP ~ gender + age + race + WC + alc + educ + albu + bili,               data = NHANES, n.iter = 500, progress.bar = \"none\")"},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"traceplot","dir":"Articles","previous_headings":"","what":"Traceplot","title":"Minimal Example","text":"function traceplot() produces plot sampled values across iterations per parameter. Different chains represented different colours. sampler converged, chains show horizontal band, figure. Consequently, traces show trend, convergence reached, iterations necessary (e.g., using function add_samples()). chains converged, can obtain result model model summary.","code":"traceplot(lm1)"},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"model-summary","dir":"Articles","previous_headings":"","what":"Model Summary","title":"Minimal Example","text":"Results model fitted JointAI can printed using summary(): output gives posterior summary, .e., summary MCMC (Markov Chain Monte Carlo) sample, consists chains combined. default, summary() print posterior summary main model parameters analysis model. one can select parameters shown described vignette Selecting Parameters. summary consists posterior mean, standard deviation, 2.5% 97.5% quantiles MCMC sample, tail probability, Gelman-Rubin criterion convergence ratio Monte Carlo error standard deviation posterior sample.","code":"summary(lm1) #>  #> Bayesian linear model fitted with JointAI #>  #> Call: #> lm_imp(formula = SBP ~ gender + age + race + WC + alc + educ +  #>     albu + bili, data = NHANES, n.iter = 500, progress.bar = \"none\") #>  #>  #> Posterior summary: #>                          Mean      SD     2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)            60.879 22.8704  19.1247 106.227     0.0040    1.00 0.0271 #> genderfemale           -3.177  2.2549  -7.6423   1.099     0.1640    1.00 0.0258 #> age                     0.364  0.0708   0.2196   0.505     0.0000    1.01 0.0258 #> raceOther Hispanic      0.518  5.0580  -9.2403  10.675     0.9373    1.00 0.0258 #> raceNon-Hispanic White -1.451  3.0937  -7.2049   4.686     0.6227    1.00 0.0276 #> raceNon-Hispanic Black  9.047  3.6389   2.0441  16.042     0.0147    1.00 0.0267 #> raceother               3.686  3.4550  -3.0852  10.725     0.2653    1.00 0.0268 #> WC                      0.236  0.0822   0.0754   0.392     0.0040    1.00 0.0258 #> alc>=1                  7.272  2.3870   2.5418  11.763     0.0040    1.03 0.0284 #> educhigh               -3.397  2.1457  -7.3896   0.869     0.1120    1.00 0.0258 #> albu                    5.320  4.0590  -2.7810  12.922     0.1987    1.00 0.0291 #> bili                   -5.516  4.9060 -15.2486   4.592     0.2413    1.01 0.0274 #>  #> Posterior summary of residual std. deviation: #>           Mean    SD 2.5% 97.5% GR-crit MCE/SD #> sigma_SBP 13.2 0.738 11.9  14.7    1.02 0.0282 #>  #>  #> MCMC settings: #> Iterations = 101:600 #> Sample size per chain = 500  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 186"},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"tail-probability","dir":"Articles","previous_headings":"Model Summary","what":"Tail probability","title":"Minimal Example","text":"tail probability measure likely value 0 estimated posterior distribution, calculated 2\\times\\min\\left\\{Pr(\\theta > 0), Pr(\\theta < 0)\\right\\} (\\theta parameter interest). following graphics, shaded areas represent minimum Pr(\\theta > 0) Pr(\\theta < 0):","code":""},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"gelman-rubin-criterion","dir":"Articles","previous_headings":"Model Summary","what":"Gelman-Rubin criterion","title":"Minimal Example","text":"Gelman-Rubin1 criterion, also available via function GR_crit(), compares within chain variation. close enough 12, chains can assumed converged.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"monte-carlo-error","dir":"Articles","previous_headings":"Model Summary","what":"Monte Carlo error","title":"Minimal Example","text":"Monte Carlo error measure error made estimate based finite sample. can also obtained using function MC_error(). Ideally, Monte Carlo error small compared standard error posterior sample. values shown model summary Monte Carlo error divided posterior standard deviation.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"additional-information","dir":"Articles","previous_headings":"Model Summary","what":"Additional information","title":"Minimal Example","text":"model summary, additionally, important characteristics MCMC samples summary based, given. includes range number iterations (= Sample size per chain), thinning interval number chains. Furthermore, number observations (sample size data) given. arguments start, end thin possible select iterations MCMC sample included summary. example: traceplot shows chains converged 1500 iterations, start = 1500 specified summary(). summary missing values variables involved model can added summary setting missinfo = TRUE.","code":""},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"plot-of-the-posterior-distributions","dir":"Articles","previous_headings":"","what":"Plot of the posterior distributions","title":"Minimal Example","text":"posterior distributions can visualized using function densplot():  default, densplot() plots empirical distribution chains separately. joined = TRUE distributions combined chains plotted.","code":"densplot(lm1)"},{"path":"https://nerler.github.io/JointAI/articles/MinimalExample.html","id":"other-types-of-models","dir":"Articles","previous_headings":"","what":"Other types of models","title":"Minimal Example","text":"Besides linear regression models, also possible fit generalized linear models: glm_imp() log-normal models: lognorm_imp() beta models continuous outcomes 0 1 (proportions): betareg_imp() cumulative logit models ordinal outcomes: clm_imp() multinomial logit models unordered factors multiple levels: mlogit_imp() linear mixed models: lme_imp() lmer_imp() (identical) generalized linear mixed models: glme_imp() glmer_imp() (identical) log-normal mixed models: lognormmm_imp() beta mixed models: betamm_imp() cumulative logit mixed models: clmm_imp() multinomial logit mixed models: mlogitmm_imp() parametric (Weibull) survival models: survreg_imp() proportional hazards survival models: coxph_imp() joint models longitudinal survival data: JM_imp() also possible specify multiple analysis models time, providing list model formulas.","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"analysis-model-type","dir":"Articles","previous_headings":"","what":"Analysis model type","title":"Model Specification","text":"JointAI several main functions (abbreviated *_imp()): lm_imp(): linear regression glm_imp(): generalized linear regression lognorm_imp(): log-normal regression betareg_imp(): beta regression clm_imp(): cumulative logit models ordinal data mlogit_imp(): multinomial logit models unordered factors lme_imp() / lmer_imp(): linear mixed effects regression glme_imp() / glmer_imp(): generalized linear mixed effects regression lognormmm_imp(): log-normal mixed effects regression betamm_imp(): beta mixed effects regression clmm_imp(): cumulative logit mixed models mlogitmm_imp(): multinomial logit mixed models survreg_imp(): parametric (Weibull) survival models coxph_imp(): Proportional hazards survival models JM_imp(): Joint model longitudinal survival data Specification functions similar specification complete data versions lm(), glm(), lme() (package nlme) lmer() (package lme4) survreg() coxph() (package survival). functions require arguments formula (fixed random mixed models) data. Specification (fixed effects) model formula demonstrated section Model formula, specification random random effects section Multi-level structure & longitudinal covariates. Additionally, glm_imp(), glme_imp() glmer_imp() require specification model family (link function).","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"model-family-and-link-functions","dir":"Articles","previous_headings":"Analysis model type","what":"Model family and link functions","title":"Model Specification","text":"Implemented families links glm_imp(), glme_imp() glmer_imp() argument family can provided character string function. link function omitted, default link used. Example: following three specifications equal: use, instance, “probit” link instead, needs specified explicitly:","code":"mod1a <- glm_imp(educ ~ age + gender + creat, data = NHANES,                  family = \"binomial\", n.adapt = 0)  mod1b <- glm_imp(educ ~ age + gender + creat, data = NHANES,                  family = binomial(), n.adapt = 0)  mod1c <- glm_imp(educ ~ age + gender + creat, data = NHANES,                  family = binomial(link = 'logit'), n.adapt = 0)  mod1a$analysis_type #> [1] \"glm\" #> attr(,\"family\") #>  #> Family: binomial  #> Link function: logit mod1d <- glm_imp(educ ~ age + gender + creat, data = NHANES,                family = binomial(link = 'probit'), n.adapt = 0)  mod1d$analysis_type #> [1] \"glm\" #> attr(,\"family\") #>  #> Family: binomial  #> Link function: probit"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"ModelFormula","dir":"Articles","previous_headings":"","what":"Model formula","title":"Model Specification","text":"arguments formula fixed take two-sided formula object, ~ separates response (outcome / dependent variable) linear predictor, covariates (independent variables) separated +. intercept added automatically (except proportional hazard models models ordinal outcomes). survreg_imp() coxph_imp() expect survival object (created Surv()) left hand side model formula. Currently, right censored data can handled can one type event (.e., competing risks multi-state models). Note: formula fixed can specified together. either need provide argument formula arguments fixed random.","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"interactions","dir":"Articles","previous_headings":"Model formula","what":"Interactions","title":"Model Specification","text":"Interactions variables can introduced using : *, adds interaction term main effects, .e., equivalent ","code":"SBP ~ age + gender + smoke * creat SBP ~ age + gender + smoke + creat + smoke:creat"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"interaction-with-multiple-variables","dir":"Articles","previous_headings":"Model formula > Interactions","what":"Interaction with multiple variables","title":"Model Specification","text":"Interactions multiple variables can specified using parentheses: function parameters() returns matrix parameters specified followed (column coef) , regression coefficients, name variable coefficient relates (varname), outcome variable respective model outcome. multinomial models, multiple linear predictors, column outcat identifies category outcome parameters refer . use function parameters() vignettes demonstrate effect different model specifications .","code":"mod2a <- glm_imp(educ ~ gender * (age + smoke + creat),                  data = NHANES, family = binomial(), n.adapt = 0) parameters(mod2a) #>  #> Note: \"mod2a\" does not contain MCMC samples. #>    outcome outcat                   varname     coef #> 1     educ   <NA>               (Intercept)  beta[1] #> 2     educ   <NA>              genderfemale  beta[2] #> 3     educ   <NA>                       age  beta[3] #> 4     educ   <NA>               smokeformer  beta[4] #> 5     educ   <NA>              smokecurrent  beta[5] #> 6     educ   <NA>                     creat  beta[6] #> 7     educ   <NA>          genderfemale:age  beta[7] #> 8     educ   <NA>  genderfemale:smokeformer  beta[8] #> 9     educ   <NA> genderfemale:smokecurrent  beta[9] #> 10    educ   <NA>        genderfemale:creat beta[10] #> 11   creat   <NA>               (Intercept) alpha[1] #> 12   creat   <NA>              genderfemale alpha[2] #> 13   creat   <NA>                       age alpha[3] #> 14   creat   <NA>               smokeformer alpha[4] #> 15   creat   <NA>              smokecurrent alpha[5] #> 16   smoke   <NA>              genderfemale alpha[6] #> 17   smoke   <NA>                       age alpha[7]"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"higher-level-interactions","dir":"Articles","previous_headings":"Model formula > Interactions","what":"Higher level interactions","title":"Model Specification","text":"specify interactions given level, ^ can used: JointAI, interactions variables, observed incomplete, variables different levels hierarchical structure, can handled. incomplete variable involved, interaction term re-calculated within iteration MCMC sampling, using imputed values current iteration. important pre-calculate interactions incomplete variables extra variables dataset, specify model formula. Otherwise, imputed values main effect interaction term match, results may incorrect.","code":"# all two-way interactions: mod2b <- glm_imp(educ ~ gender + (age + smoke + creat)^2,                  data = NHANES, family = binomial(), n.adapt = 0)  parameters(mod2b) #>    outcome outcat            varname     coef #> 1     educ   <NA>        (Intercept)  beta[1] #> 2     educ   <NA>       genderfemale  beta[2] #> 3     educ   <NA>                age  beta[3] #> 4     educ   <NA>        smokeformer  beta[4] #> 5     educ   <NA>       smokecurrent  beta[5] #> 6     educ   <NA>              creat  beta[6] #> 7     educ   <NA>    age:smokeformer  beta[7] #> 8     educ   <NA>   age:smokecurrent  beta[8] #> 9     educ   <NA>          age:creat  beta[9] #> 10    educ   <NA>  smokeformer:creat beta[10] #> 11    educ   <NA> smokecurrent:creat beta[11] #> 12   creat   <NA>        (Intercept) alpha[1] #> 13   creat   <NA>       genderfemale alpha[2] #> 14   creat   <NA>                age alpha[3] #> 15   creat   <NA>        smokeformer alpha[4] #> 16   creat   <NA>       smokecurrent alpha[5] #> 17   smoke   <NA>       genderfemale alpha[6] #> 18   smoke   <NA>                age alpha[7]  # all two- and three-way interactions: mod2c <- glm_imp(educ ~ gender + (age + smoke + creat)^3,                  data = NHANES, family = binomial(), n.adapt = 0)  parameters(mod2c) #>    outcome outcat                varname     coef #> 1     educ   <NA>            (Intercept)  beta[1] #> 2     educ   <NA>           genderfemale  beta[2] #> 3     educ   <NA>                    age  beta[3] #> 4     educ   <NA>            smokeformer  beta[4] #> 5     educ   <NA>           smokecurrent  beta[5] #> 6     educ   <NA>                  creat  beta[6] #> 7     educ   <NA>        age:smokeformer  beta[7] #> 8     educ   <NA>       age:smokecurrent  beta[8] #> 9     educ   <NA>              age:creat  beta[9] #> 10    educ   <NA>      smokeformer:creat beta[10] #> 11    educ   <NA>     smokecurrent:creat beta[11] #> 12    educ   <NA>  age:smokeformer:creat beta[12] #> 13    educ   <NA> age:smokecurrent:creat beta[13] #> 14   creat   <NA>            (Intercept) alpha[1] #> 15   creat   <NA>           genderfemale alpha[2] #> 16   creat   <NA>                    age alpha[3] #> 17   creat   <NA>            smokeformer alpha[4] #> 18   creat   <NA>           smokecurrent alpha[5] #> 19   smoke   <NA>           genderfemale alpha[6] #> 20   smoke   <NA>                    age alpha[7]"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"non-linear-functional-forms","dir":"Articles","previous_headings":"Model formula","what":"Non-linear functional forms","title":"Model Specification","text":"practice, associations outcome covariates always meet standard assumption covariate effects linear. Often, assuming logarithmic, quadratic, non-linear effect appropriate. Non-linear associations can specified model formula using functions log() (natural logarithm), sqrt() (square root) exp() (exponential function). also possible use algebraic operations calculate new variable one covariates. indicate R operators used formula interpreted algebraic operators formula operators, calculations need wrapped function (). example, include quadratic effect variable x use (x^2). Just writing x^2 interpreted interaction x , simplifies just x. completely observed covariates, JointAI can handle standard type function implemented R. also includes splines, e.g., using ns() bs() package splines (automatically installed R). Functions involving variables missing values need re-calculated iteration MCMC sampling. Therefore, currently, functions can interpreted JAGS can used incomplete variables. functions include: log(), exp() sqrt(), abs() sin(), cos() polynomials (using ()) algebraic operations involving one multiple ()complete variables, long formula can interpreted JAGS. list functions implemented JAGS can found JAGS user manual. examples:1","code":"# Absolute difference between bili and creat mod3a <- lm_imp(SBP ~ age + gender + abs(bili - creat), data = NHANES)  # Using a natural cubic spline for age (completely observed) and a quadratic # and a cubic effect for bili library(splines) mod3b <- lm_imp(SBP ~ ns(age, df = 2) + gender + I(bili^2) + I(bili^3), data = NHANES)  # A function of creat and albu mod3c <- lm_imp(SBP ~ age + gender + I(creat/albu^2), data = NHANES,                 models = c(creat = 'lognorm', albu = 'lognorm')) # This function may make more sense to calculate BMI as weight/height^2, but # we currently do not have those variables in the NHANES dataset.  # Using the sine and cosine mod3d <- lm_imp(SBP ~ bili + sin(creat) + cos(albu), data = NHANES)"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"what-happens-inside-jointai","dir":"Articles","previous_headings":"Model formula > Non-linear functional forms","what":"What happens inside JointAI?","title":"Model Specification","text":"model formula includes function complete incomplete variable, main effect variable automatically added auxiliary variable. (info auxiliary variables, see section “Auxiliary variables”.) linear predictors models covariates, usually, main effects used. mod3b , example, spline age used predictor SBP, imputation model bili, age enters linear effect. function list_models() prints information sub-models specified JointAI object. includes model(s) specified user via model formula models covariates JointAI specified automatically. Since interested predictor variables, suppress printing information prior distributions, regression coefficients parameters setting priors, regcoef otherpars FALSE.  function variable specified auxiliary variable, function used (well) models covariates. example, mod3e, waist circumference (WC) part model SBP, auxiliary variable (WC^2) used linear predictor imputation model bili: WC used predictor variable main model function WC specified auxiliary variable, variables used predictors imputation models: function covariate used linear predictor analysis model, function also used linear predictor imputation models, necessary also include function argument auxvars: Incomplete variables always imputed original scale, .e., mod3b variable bili imputed quadratic cubic versions calculated imputed values. Likewise, creat albu mod3c imputed separately, (creat/albu^2) calculated imputed (observed) values. Important:  different transformations incomplete variable used one model, strongly discouraged calculate transformations beforehand supply separate variables. case interactions.  , example, model formula contains x x2 (x2 = x^2), treated separate variables imputed different models. Imputed values x2 thus equal square imputed values x. Instead, x + (x^2) used model formula. , x imputed used linear predictor models incomplete variables, x^2 calculated imputed values x.","code":"list_models(mod3b, priors = FALSE, regcoef = FALSE, otherpars = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), ns(age, df = 2)1, ns(age, df = 2)2, genderfemale, I(bili^2), I(bili^3)  #>  #>  #> Linear model for \"bili\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale mod3e <- lm_imp(SBP ~ age + gender + bili, auxvars = ~ I(WC^2), data = NHANES)  list_models(mod3e, priors = FALSE, regcoef = FALSE, otherpars = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, bili  #>  #>  #> Linear model for \"bili\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, WC  #>  #>  #> Linear model for \"WC\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale mod3f <- lm_imp(SBP ~ age + gender + bili + WC, auxvars = ~ I(WC^2), data = NHANES)  list_models(mod3f, priors = FALSE, regcoef = FALSE, otherpars = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, bili, WC  #>  #>  #> Linear model for \"bili\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, WC  #>  #>  #> Linear model for \"WC\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale mod3g <- lm_imp(SBP ~ age + gender + bili + I(WC^2), auxvars = ~ I(WC^2), data = NHANES)  list_models(mod3g, priors = FALSE, regcoef = FALSE, otherpars = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, bili, I(WC^2)  #>  #>  #> Linear model for \"bili\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, WC  #>  #>  #> Linear model for \"WC\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"functions-with-restricted-support","dir":"Articles","previous_headings":"Model formula > Non-linear functional forms","what":"Functions with restricted support","title":"Model Specification","text":"function restricted support, e.g., log(x) defined x > 0, model used impute x needs comply restrictions. can either achieved truncating distribution assumed x, using argument trunc, specifying model x meets restrictions. information imputation methods (models covariates), see section Imputation model types. Example: using log() transformation covariate bili, can either use default model continuous variables, \"lm\", linear model, .e., assuming normal distribution truncate distribution specifying trunc = list(bili = c(<lower>, <upper>)) (lower upper limits smallest largest allowed values) choose model (using argument models; details see section covariate model types) imputes positive values log-normal distribution (\"glm_lognorm\") Gamma distribution (e.g., \"glm_gamma_log\"): one-sided truncation needed, limit can provided NA.","code":"# truncation of the distribution of  bili mod4a <- lm_imp(SBP ~ age + gender + log(bili) + exp(creat),                 trunc = list(bili = c(1e-5, NA)), data = NHANES)  # log-normal model for bili mod4b <- lm_imp(SBP ~ age + gender + log(bili) + exp(creat),                 models = c(bili = 'lognorm', creat = 'lm'), data = NHANES)  # gamma model with log-link for bili mod4c <- lm_imp(SBP ~ age + gender + log(bili) + exp(creat),                 models = c(bili = 'glm_gamma_log', creat = 'lm'), data = NHANES)"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"functions-that-are-not-available-in-r","dir":"Articles","previous_headings":"Model formula > Non-linear functional forms","what":"Functions that are not available in R","title":"Model Specification","text":"possible use functions different names R JAGS, exist JAGS, R, defining new function R name function JAGS. Example: JAGS inverse logit transformation defined function ilogit. R, function ilogit, inverse logit available distribution function logistic distribution plogis().","code":"# Define the function ilogit ilogit <- plogis  # Use ilogit in the model formula mod5a <- lm_imp(SBP ~ age + gender + ilogit(creat), data = NHANES) #> Error in `ilogit()`: #> ! could not find function \"ilogit\""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"nested-functions","dir":"Articles","previous_headings":"Model formula > Non-linear functional forms","what":"Nested functions","title":"Model Specification","text":"also possible nest function another function. Example:2 complementary log log transformation restricted values larger 0 smaller 1. order use function variable exceeds range, case creat, second transformation might used, instance inverse logit previous example. JAGS, complementary log-log transformation implemented cloglog, since function exist (base) R, first need define :","code":"# define the complementary log log transformation cloglog <- function(x) log(-log(1 - x))  # define the inverse logit (in case you have not done it in the previous example) ilogit <- plogis  # nest ilogit inside cloglog mod6a <- lm_imp(SBP ~ age + gender + cloglog(ilogit(creat)), data = NHANES) #> Error in `cloglog()`: #> ! could not find function \"cloglog\""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"MultiLevelStructure","dir":"Articles","previous_headings":"","what":"Multi-level structure & longitudinal covariates","title":"Model Specification","text":"multi-level models, additional fixed effects structure specified argument fixed random effects structure needs provided via argument random. Alternatively, possible provide formula contains fixed random effects structure (corresponding specification used lme4).","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"random-effects","dir":"Articles","previous_headings":"Multi-level structure & longitudinal covariates","what":"Random effects","title":"Model Specification","text":"random takes one-sided formula starting ~. Variables random effect included usually separated +, grouping variable separated |. random intercept added automatically needs specified random intercept model. examples: random = ~ 1 | id: random intercept , id grouping variable random = ~ time | id: random intercept slope variable time random = ~ time + (time^2) | id: random intercept, slope quadratic random effect time random = ~ time + x | id random intercept, random slope time random effect variable x corresponding specifications using argument formula <fixed effects> + (1 | id) <fixed effects> + (time | id) <fixed effects> + (time + (time^2) | id) <fixed effects> + (time + x | id) possible use splines random effects structure (completely observed variables), e.g.: Since JointAI version 1.0.0 possible model multi-level data multiple levels grouping setting, formula specification needs used: possible model crossed nested random effects, however distinction crossed nested random effects must come coding id variables. example, patients nested hospitals, observations patient id also need hospital id. case, .e., patients measured multiple hospitals, random effects crossed. (theoretically) restriction many grouping levels possible.","code":"mod7a <- lme_imp(bmi ~ GESTBIR + ETHN + HEIGHT_M + ns(age, df = 2),                  random = ~ns(age, df = 2) | ID, data = simLong) <fixed effects> + (1 | id) + (1 | center)"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"longitudinal-covariates","dir":"Articles","previous_headings":"Multi-level structure & longitudinal covariates","what":"Longitudinal covariates","title":"Model Specification","text":"JointAI version 0.5.0 onward imputation longitudinal covariates possible. details types models available covariates multi-level setting, see section covariate model types . Note: incomplete baseline covariates (level > 1) involved model usually necessary specify models variables lower levels, even completely observed. done automatically JointAI, may necessary change default model types models better fit distributions respective variables. typically necessary specify models variables higher levels incomplete covariates lower levels. example, 2-level setting, missing values level-2 variables, necessary specify models completely observed level-1 variables. missing values level-2 variables, models need specified level-1 variables.","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"why-do-we-need-models-for-completely-observed-covariates","dir":"Articles","previous_headings":"Multi-level structure & longitudinal covariates > Longitudinal covariates","what":"Why do we need models for completely observed covariates?","title":"Model Specification","text":"joint distribution outcome y, covariates x, random effects b parameters \\theta, p(y, x, b, \\theta), modelled product univariate conditional distributions. facilitate specification distributions ordered longitudinal (level-1) variables may baseline (level-2) variables linear predictors vice versa. example: \\begin{align} p(y, x, b, \\theta) = & p(y \\mid x_1, ..., x_4, b_y, \\theta_y) && \\text{analysis model}\\\\ & p(x_1\\mid \\theta_{x1}) && \\text{model complete baseline covariate}\\\\ & p(x_2\\mid x_1, \\theta_{x2}) && \\text{model incomplete baseline covariate}\\\\ & p(x_3\\mid x_1, x_2, b_{x3}, \\theta_{x3}) && \\text{model complete longitudinal covariate}\\\\ & p(x_4\\mid x_1, x_2, x_3, b_{x4}, \\theta_{x4}) && \\text{model incomplete longitudinal covariate}\\\\ & p(b_y|\\theta_b) p(b_{x3}|\\theta_b) p(b_{x4}|\\theta_b) && \\text{models random effects}\\\\ & p(\\theta_y) p(\\theta_{x1}) \\ldots p(\\theta_{x4}) p(\\theta_b) && \\text{prior distributions} \\end{align} Since parameter vectors \\theta_{x1}, \\theta_{x2}, … assumed priori independent, furthermore x_1 completely observed modelled independently incomplete variables, estimation model parts affected p(x_1\\mid \\theta_{x1}) , hence, model can omitted. p(x_3 \\mid x_1, x_2, b_{x3}, \\theta_{x3}), hand modelled conditional incomplete covariate x_2 can therefore omitted. incomplete baseline covariates, .e., x_2 completely observed, p(x_3 \\mid x_1, x_2, b_{x3}, \\theta_{x3}) also affect estimation parameters parts model omitted.","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"meth","dir":"Articles","previous_headings":"","what":"Covariate model types","title":"Model Specification","text":"JointAI automatically selects models incomplete covariates (necessary also complete covariates). type model selected automatically based class variable number levels. automatically selected types baseline (highest level) covariates : default methods lower level covariates : imputation models chosen default may necessarily appropriate data hand, especially continuous variables, often comply assumptions (conditional) normality. Therefore, alternative imputation methods available baseline covariates: lognorm assumes normal distribution natural logarithm variable, variable enters linear predictor analysis model (possibly imputation models) original scale. longitudinal (lower-level) covariates corresponding model types . available: Logistic (mixed) models can abbreviated glm_logit (glmm_logit).","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"specification-of-covariate-model-types","dir":"Articles","previous_headings":"Covariate model types","what":"Specification of covariate model types","title":"Model Specification","text":"models mod4b mod4c already seen two examples imputation model type changed using argument models. models takes named vector (imputation/covariate) model types, names names covariates. vector supplied models contains specifications subset covariates, default models used remaining variables. “time” variable model, age (age child time measurement) simLong may meaningful specify model variable. Especially “time” variable pre-specified design study can usually assumed independent covariates model useful interpretation. argument no_model allows us exclude models variables (long completely observed): excluding model age implicitly assume incomplete baseline variables independent age. Note: continuous incomplete variable two different values assumed binary coding default imputation model changed accordingly. behaviour can overwritten imputation method variable specified directly user. Variables type logical automatically converted binary factors.","code":"mod8a <- lm_imp(SBP ~ age + gender + WC + alc + bili + occup + smoke,                 models = c(bili = 'glm_gamma_log', WC = 'lognorm'),                 data = NHANES, n.adapt = 0, progress.bar = 'none')  mod8a$models #>                     SBP                     alc                   occup                    bili  #> \"glm_gaussian_identity\"    \"glm_binomial_logit\"                \"mlogit\"         \"glm_gamma_log\"  #>                   smoke                      WC  #>                   \"clm\"               \"lognorm\" mod8b <- lme_imp(bmi ~ GESTBIR + ETHN + HEIGHT_M + SMOKE + hc + MARITAL +                    ns(age, df = 2),                  random = ~ns(age, df = 2) | ID, data = simLong,                  no_model = \"age\", n.adapt = 0) mod8b$models #>                      bmi                       hc                    SMOKE                  MARITAL  #> \"glmm_gaussian_identity\"                    \"lmm\"                    \"clm\"                 \"mlogit\"  #>                     ETHN                 HEIGHT_M  #>     \"glm_binomial_logit\"                     \"lm\""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"order-of-the-sequence-of-imputation-models","dir":"Articles","previous_headings":"Covariate model types","what":"Order of the sequence of imputation models","title":"Model Specification","text":"JointAI, models automatically specified covariates ordered hierarchical level respective response variable (descending). linear predictor model contains incomplete variables specified later sequence complete variables lower level. Within level, models ordered proportion missing values respective response variables, variable missing values covariates linear predictor.","code":"get_missinfo(mod8a) #> $complete_cases #>          #        % #> lvlone 116 62.36559 #>  #> $miss_list #> $miss_list$lvlone #>        # NA      % NA #> SBP       0  0.000000 #> age       0  0.000000 #> gender    0  0.000000 #> WC        2  1.075269 #> smoke     7  3.763441 #> bili      8  4.301075 #> occup    28 15.053763 #> alc      34 18.279570  # print information on the imputation models (and omit everything but the predictor variables) list_models(mod8a, priors = FALSE, regcoef = FALSE, otherpars = FALSE, refcat = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale, WC, alc>=1, bili, occuplooking for work, occupnot  #>   working, smokeformer, smokecurrent  #>  #>  #> Binomial model for \"alc\"  #>    family: binomial  #>    link: logit  #> * Predictor variables: #>   (Intercept), age, genderfemale, WC, bili, occuplooking for work, occupnot working,  #>   smokeformer, smokecurrent  #>  #>  #> Multinomial logit model for \"occup\"  #> * Predictor variables: #>   (Intercept), age, genderfemale, WC, bili, smokeformer, smokecurrent  #>  #>  #> Gamma model for \"bili\"  #>    family: Gamma  #>    link: log  #> * Parametrization: #>   - shape: shape_bili = mu_bili^2 * tau_bili #>   - rate: rate_bili = mu_bili * tau_bili #> * Predictor variables: #>   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent  #>  #>  #> Cumulative logit model for \"smoke\"  #> * Predictor variables: #>   age, genderfemale, WC  #>  #>  #> Log-normal model for \"WC\"  #>    family: lognorm  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, genderfemale"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"auxvars","dir":"Articles","previous_headings":"","what":"Auxiliary variables","title":"Model Specification","text":"Auxiliary variables variables part analysis model, considered predictor variables imputation models can inform imputation unobserved values. Good auxiliary variables 3 associated incomplete variable interest, associated missingness variable, many missing values . Importantly, observed large proportion cases missing value variable imputed. main functions, *_imp(), auxiliary variables can specified argument auxvars, one-sided formula. Example: might consider variables educ smoke predictors imputation occup: variables educ smoke used predictors analysis model. , however, used predictors imputation occup imputed (missing values):","code":"mod9a <- lm_imp(SBP ~ gender + age + occup, auxvars = ~ educ + smoke,                 data = NHANES, n.adapt = 0) list_models(mod9a, priors = FALSE, regcoef = FALSE, otherpars = FALSE, refcat = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), genderfemale, age, occuplooking for work, occupnot working  #>  #>  #> Multinomial logit model for \"occup\"  #> * Predictor variables: #>   (Intercept), genderfemale, age, educhigh, smokeformer, smokecurrent  #>  #>  #> Cumulative logit model for \"smoke\"  #> * Predictor variables: #>   genderfemale, age, educhigh"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"functions-of-variables-as-auxiliary-variables","dir":"Articles","previous_headings":"Auxiliary variables","what":"Functions of variables as auxiliary variables","title":"Model Specification","text":"shown mod3e mod3f, possible specify functions auxiliary variables. case, auxiliary variable considered linear effect specified function: Note: Omitting auxiliary variables analysis model implies outcome independent variables, conditional variables model. true, model mis-specified may lead biased results (similar leaving confounding variable model).","code":"mod9b <- lm_imp(SBP ~ gender + age + occup, data = NHANES,                 auxvars = ~ educ + smoke + log(WC),                 trunc = list(WC = c(1e-10, 1e10)), n.adapt = 0) list_models(mod9b, priors = FALSE, regcoef = FALSE, otherpars = FALSE, refcat = FALSE) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), genderfemale, age, occuplooking for work, occupnot working  #>  #>  #> Multinomial logit model for \"occup\"  #> * Predictor variables: #>   (Intercept), genderfemale, age, educhigh, smokeformer, smokecurrent, WC  #>  #>  #> Cumulative logit model for \"smoke\"  #> * Predictor variables: #>   genderfemale, age, educhigh, WC  #>  #>  #> Linear model for \"WC\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), genderfemale, age, educhigh"},{"path":[]},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"coding","dir":"Articles","previous_headings":"Categorical covariates: coding and reference categories","what":"Coding","title":"Model Specification","text":"practice, often, dummy coding used categorical predictor variables, .e., binary variables created category, except reference category. binary variables value one category observed zero otherwise. default behaviour unordered factors R (contr.treatment()). ordered factors orthogonal polynomials (contr.poly()) used. type contrasts (.e. “coding”) used unordered ordered factors can checked set global options: Since imputation incomplete factors done original variable, re-coding original categorical variable dummy variables contrasts needs done within JAGS model. Currently, dummy coding reference coding (contr.sum()) possible factors missing values. means , default contr.poly set ordinal factors, warning message printed dummy coding used variables instead.","code":"options('contrasts') #> $contrasts #>         unordered           ordered  #> \"contr.treatment\"      \"contr.poly\""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"reference-categories","dir":"Articles","previous_headings":"Categorical covariates: coding and reference categories","what":"Reference categories","title":"Model Specification","text":"JointAI, first category categorical variable set reference category using dummy reference coding. However, may always allow desired interpretation regression coefficients. Moreover, categories unbalanced, setting largest group reference may result better mixing MCMC chains. unordered factors, possible change reference category directly data, example using base R function relevel(). ordinal variables, however, possible, especially ordinal variable needs imputation desirable maintain ordering categories. Therefore, JointAI allows specification reference category separately variable, via argument refcats.","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"setting-reference-categories-for-all-variables","dir":"Articles","previous_headings":"Categorical covariates: coding and reference categories > Reference categories","what":"Setting reference categories for all variables","title":"Model Specification","text":"specify choice reference category globally variables model, refcats can set refcats = \"first\" refcats = \"last\" refcats = \"largest\" example:","code":"mod10a <- lm_imp(SBP ~ gender + age + race + educ + occup + smoke,                  refcats = \"largest\", data = NHANES, n.adapt = 0) #> Warning:  #> It is currently not possible to use \"contr.poly\" for incomplete categorical covariates. I #> will use \"contr.treatment\" instead.  You can specify (globally) which types of contrasts #> are used by changing \"options('contrasts')\"."},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"setting-reference-categories-for-individual-variables","dir":"Articles","previous_headings":"Categorical covariates: coding and reference categories > Reference categories","what":"Setting reference categories for individual variables","title":"Model Specification","text":"Alternatively, refcats takes named vector, reference category variable can specified either number name, one three global types: “first”, “last” “largest”. variables reference category specified list default used. help specify reference category, function set_refcat() can used. prints names categorical variables selected specified model formula /vector auxiliary variables, vector naming covariates categorical variables data data provided, asks number questions user needs reply input number. option 4 chosen, question categorical variable asked, example: specification reference categories categorical variables, determined specification argument refcats printed: set_refcat() also returns named vector can passed argument refcats: Note: Changing reference category via argument refcats change order levels dataset data matrices inside JointAI. , JAGS model, categorical variables converted dummy variables, reference category used determine levels dummies created.","code":"mod10b <- lm_imp(SBP ~ gender + age + race + educ + occup + smoke,                  refcats = list(occup = \"not working\", race = 3, educ = 'largest'),                  data = NHANES, n.adapt = 0) #> Warning:  #> It is currently not possible to use \"contr.poly\" for incomplete categorical covariates. I #> will use \"contr.treatment\" instead.  You can specify (globally) which types of contrasts #> are used by changing \"options('contrasts')\". refs_mod10 <- set_refcat(NHANES, formula = formula(mod10b)) #> Warning in JointAI:::extract_outcome(formula): 'JointAI:::extract_outcome' is deprecated. #> Use 'extract_outcomes_list ' instead. #> See help(\"Deprecated\") and help(\"JointAI-deprecated\"). #> Warning in extract_lhs(x): 'extract_lhs' is deprecated. #> Use 'extract_lhs_string ' instead. #> See help(\"Deprecated\") and help(\"JointAI-deprecated\"). #> Warning in FUN(X[[i]], ...): 'FUN' is deprecated. #> Use 'extract_lhs_string ' instead. #> See help(\"Deprecated\") and help(\"JointAI-deprecated\"). #> The categorical variables are: #> - \"gender\" #> - \"race\" #> - \"educ\" #> - \"occup\" #> - \"smoke\" #>  #> How do you want to specify the reference categories? #>  #> 1: Use the first category for each variable. #> 2: Use the last category for each variabe. #> 3: Use the largest category for each variable. #> 4: Specify the reference categories individually. #> The reference category for “race” should be #> #> 1: Mexican American #> 2: Other Hispanic #> 3: Non-Hispanic White #> 4: Non-Hispanic Black #> 5: other #> In the JointAI model specify: #>  refcats = c(gender = 'female', race = 'Non-Hispanic White', educ = 'low', #>              occup = 'not working', smoke = 'never') #> #> or use the output of this function. mod10c <- lm_imp(SBP ~ gender + age + race + educ + occup + smoke,                  refcats = refs_mod10, data = NHANES, n.adapt = 0) #> Warning:  #> It is currently not possible to use \"contr.poly\" for incomplete categorical covariates. I #> will use \"contr.treatment\" instead.  You can specify (globally) which types of contrasts #> are used by changing \"options('contrasts')\"."},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"hyper-parameters","dir":"Articles","previous_headings":"","what":"Hyper-parameters","title":"Model Specification","text":"Bayesian framework, parameters random variables distribution needs specified. distributions depend parameters , .e., hyper-parameters. function default_hyperpars() returns list containing default hyper parameters used JointAI model. change hyper-parameters JointAI model, list obtained default_hyperpars() can edited passed argument hyperpars main functions *_imp(). mu_reg_* tau_reg_* refer mean precision distribution regression coefficients. shape_tau_* rate_tau_* shape rate parameters Gamma distribution used prior precision parameters. KinvD refers degrees freedom Wishart prior used inverse random effects design matrix D. KinvD_exp string can evaluated calculate number degrees freedom depending number random effects nranef (dimension D). default, KinvD set number random effects plus one. shape_diag_RinvD rate_diag_RinvD scale rate parameters Gamma prior diagonal elements RinvD. random effects models one random effect, instead Wishart distribution Gamma prior used inverse D.","code":"default_hyperpars() #> $norm #>    mu_reg_norm   tau_reg_norm shape_tau_norm  rate_tau_norm  #>          0e+00          1e-04          1e-02          1e-02  #>  #> $gamma #>    mu_reg_gamma   tau_reg_gamma shape_tau_gamma  rate_tau_gamma  #>           0e+00           1e-04           1e-02           1e-02  #>  #> $beta #>    mu_reg_beta   tau_reg_beta shape_tau_beta  rate_tau_beta  #>          0e+00          1e-04          1e-02          1e-02  #>  #> $binom #>  mu_reg_binom tau_reg_binom  #>         0e+00         1e-04  #>  #> $poisson #>  mu_reg_poisson tau_reg_poisson  #>           0e+00           1e-04  #>  #> $multinomial #>  mu_reg_multinomial tau_reg_multinomial  #>               0e+00               1e-04  #>  #> $ordinal #>    mu_reg_ordinal   tau_reg_ordinal  mu_delta_ordinal tau_delta_ordinal  #>             0e+00             1e-04             0e+00             1e-04  #>  #> $ranef #> shape_diag_RinvD  rate_diag_RinvD       KinvD_expr  #>           \"0.01\"          \"0.001\"   \"nranef + 1.0\"  #>  #> $surv #>  mu_reg_surv tau_reg_surv  #>        0.000        0.001"},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"scaling","dir":"Articles","previous_headings":"","what":"Scaling","title":"Model Specification","text":"variables measured different scales can result slow convergence bad mixing. Therefore, JointAI includes scaling continuous covariates JAGS model (.e., instead writing ... + covar + ... linear predictor, ... + (covar - mean)/sd) + ... written). scaling parameters (mean standard deviation) calculated based design matrices containing original data. Results transformed back original scale. setting argument scale_vars = FALSE scaling can prevented. scale_vars vector variable names, scaling done variables. default, MCMC samples scaled back scale data stored JointAI object. argument keep_scaled_mcmc = TRUE also scaled sample kept. mainly de-bugging purposes.","code":""},{"path":"https://nerler.github.io/JointAI/articles/ModelSpecification.html","id":"shrinkage","dir":"Articles","previous_headings":"","what":"Shrinkage","title":"Model Specification","text":"possible use shrinkage priors penalize large regression coefficients. can specified via argument shrinkage. moment, ridge regression implemented. Setting shrinkage = 'ridge' impose ridge priors regression coefficients. use shrinkage sub-models (main analysis model covariate models), vector can provided contains names response variables models shrinkage applied, type shrinkage . example, mod11a ridge regression used models, modd11b models SBP educ: Ridge regression implemented \\text{Ga}(0.01, 0.01) prior precision regression coefficients \\beta instead setting precision fixed (small) value.","code":"mod11a <- lm_imp(SBP ~ gender + age + race + educ + occup + smoke,                 data = NHANES, shrinkage = 'ridge',                 n.adapt = 0) #>  #> Note: No MCMC sample will be created when n.iter is set to 0.  mod11b <- lm_imp(SBP ~ gender + age + race + educ + occup + smoke,                 data = NHANES, shrinkage = c(SBP = 'ridge', educ = 'ridge'),                 n.adapt = 0) #>  #> Note: No MCMC sample will be created when n.iter is set to 0."},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"monitoring-parameters","dir":"Articles","previous_headings":"","what":"Monitoring parameters","title":"Parameter Selection","text":"JointAI uses JAGS performing MCMC (Markov Chain Monte Carlo) sampling. Since JAGS saves values MCMC chains parameters/variables user specified monitored, also case JointAI. purpose, main functions *_imp() argument monitor_params. monitor_params takes named list (often named vector also works) following possible entries: key words works switch, except , vector character strings.","code":""},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"parameters-of-the-analysis-model","dir":"Articles","previous_headings":"Monitoring parameters","what":"Parameters of the analysis model","title":"Parameter Selection","text":"default setting monitor_params = c(analysis_main = TRUE), .e., main parameters analysis model monitored, monitoring switched parameters. main parameters regression coefficients analysis model (beta) potentially residual standard deviation, example linear Gamma models, second parameter beta distribution (parametrized \\mu \\tau instead two shape parameters), variance-covariance matrices random effects used main models, shape parameter parametric Weibull survival model, coefficients used spline specification baseline hazard proportional hazards survival models. function parameters() returns parameters specified followed (even models MCMC sampling performed, .e. n.iter = 0 n.adapt = 0). example: column outcome refers response variable particular model, distinguish regression coefficients different sub-models, column outcat contain category response variable particular linear predictor corresponds multinomial logit models.","code":"lm1 <- lm_imp(SBP ~ gender + WC + alc + creat, data = NHANES,  n.adapt = 0)  parameters(lm1) #>   outcome outcat      varname      coef #> 1     SBP   <NA>  (Intercept)   beta[1] #> 2     SBP   <NA> genderfemale   beta[2] #> 3     SBP   <NA>           WC   beta[3] #> 4     SBP   <NA>       alc>=1   beta[4] #> 5     SBP   <NA>        creat   beta[5] #> 6     SBP   <NA>         <NA> sigma_SBP"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"imputed-values-parameters-of-the-imputation-models","dir":"Articles","previous_headings":"Monitoring parameters","what":"Imputed values & parameters of the imputation models","title":"Parameter Selection","text":"generate (multiple) imputed datasets can used analyses, imputed values need monitored. can done setting monitor_params = c(imps = TRUE). JointAI uses separate data matrices per level hierarchy multi-level model. lowest level (level models hierarchical structure) called lvlone, levels named based corresponding grouping/id variables. categorical variables original variable well corresponding dummy variables stored matrices. case interaction terms transformations variables. parameters models incomplete variables can selected monitor_params = c(other_models = TRUE). set monitors regression coefficients (alpha) parameters, precision (tau_*) intercepts & increments (gamma_* delta_*) cumulative logit models.","code":"lm2 <- lm_imp(SBP ~ age + WC + alc + smoke + occup,               data = NHANES, n.adapt = 0,               monitor_params = c(imps = TRUE, analysis_main = FALSE) )  parameters(lm2) #>    outcat varname            coef outcome #> 1      NA      NA   M_lvlone[1,2]      NA #> 2      NA      NA   M_lvlone[7,2]      NA #> 3      NA      NA   M_lvlone[8,2]      NA #> 4      NA      NA  M_lvlone[12,2]      NA #> 5      NA      NA  M_lvlone[13,2]      NA #> 6      NA      NA  M_lvlone[21,2]      NA #> 7      NA      NA  M_lvlone[22,2]      NA #> 8      NA      NA  M_lvlone[31,2]      NA #> 9      NA      NA  M_lvlone[33,2]      NA #> 10     NA      NA  M_lvlone[34,2]      NA #> 11     NA      NA  M_lvlone[39,2]      NA #> 12     NA      NA  M_lvlone[49,2]      NA #> 13     NA      NA  M_lvlone[66,2]      NA #> 14     NA      NA  M_lvlone[67,2]      NA #> 15     NA      NA  M_lvlone[80,2]      NA #> 16     NA      NA  M_lvlone[86,2]      NA #> 17     NA      NA  M_lvlone[91,2]      NA #> 18     NA      NA  M_lvlone[92,2]      NA #> 19     NA      NA M_lvlone[105,2]      NA #> 20     NA      NA M_lvlone[111,2]      NA #> 21     NA      NA M_lvlone[115,2]      NA #> 22     NA      NA M_lvlone[118,2]      NA #> 23     NA      NA M_lvlone[120,2]      NA #> 24     NA      NA M_lvlone[127,2]      NA #> 25     NA      NA M_lvlone[132,2]      NA #> 26     NA      NA M_lvlone[139,2]      NA #> 27     NA      NA M_lvlone[146,2]      NA #> 28     NA      NA M_lvlone[149,2]      NA #> 29     NA      NA M_lvlone[152,2]      NA #> 30     NA      NA M_lvlone[163,2]      NA #> 31     NA      NA M_lvlone[165,2]      NA #> 32     NA      NA M_lvlone[169,2]      NA #> 33     NA      NA M_lvlone[180,2]      NA #> 34     NA      NA M_lvlone[185,2]      NA #> 35     NA      NA   M_lvlone[6,3]      NA #> 36     NA      NA  M_lvlone[16,3]      NA #> 37     NA      NA  M_lvlone[24,3]      NA #> 38     NA      NA  M_lvlone[27,3]      NA #> 39     NA      NA  M_lvlone[45,3]      NA #> 40     NA      NA  M_lvlone[57,3]      NA #> 41     NA      NA  M_lvlone[58,3]      NA #> 42     NA      NA  M_lvlone[60,3]      NA #> 43     NA      NA  M_lvlone[61,3]      NA #> 44     NA      NA  M_lvlone[65,3]      NA #> 45     NA      NA  M_lvlone[66,3]      NA #> 46     NA      NA  M_lvlone[70,3]      NA #> 47     NA      NA  M_lvlone[80,3]      NA #> 48     NA      NA  M_lvlone[81,3]      NA #> 49     NA      NA  M_lvlone[85,3]      NA #> 50     NA      NA  M_lvlone[88,3]      NA #> 51     NA      NA  M_lvlone[89,3]      NA #> 52     NA      NA  M_lvlone[90,3]      NA #> 53     NA      NA M_lvlone[101,3]      NA #> 54     NA      NA M_lvlone[104,3]      NA #> 55     NA      NA M_lvlone[116,3]      NA #> 56     NA      NA M_lvlone[133,3]      NA #> 57     NA      NA M_lvlone[137,3]      NA #> 58     NA      NA M_lvlone[143,3]      NA #> 59     NA      NA M_lvlone[168,3]      NA #> 60     NA      NA M_lvlone[170,3]      NA #> 61     NA      NA M_lvlone[180,3]      NA #> 62     NA      NA M_lvlone[186,3]      NA #> 63     NA      NA  M_lvlone[16,4]      NA #> 64     NA      NA  M_lvlone[99,4]      NA #> 65     NA      NA M_lvlone[123,4]      NA #> 66     NA      NA M_lvlone[156,4]      NA #> 67     NA      NA M_lvlone[158,4]      NA #> 68     NA      NA M_lvlone[166,4]      NA #> 69     NA      NA M_lvlone[172,4]      NA #> 70     NA      NA  M_lvlone[33,5]      NA #> 71     NA      NA M_lvlone[150,5]      NA head(lm2$data_list$M_lvlone) #>          SBP alc occup smoke    WC (Intercept) age alc>=1 smokeformer #> 10  108.0000  NA     1     1  99.0           1  35     NA          NA #> 14  105.3333   0     1     1  82.7           1  38     NA          NA #> 41  110.0000   0     3     1  94.9           1  78     NA          NA #> 77  106.0000   1     2     1  82.4           1  23     NA          NA #> 91  114.6667   0     3     1  93.1           1  40     NA          NA #> 105 139.3333   1    NA     3 105.4           1  54     NA          NA #>     smokecurrent occuplooking for work occupnot working #> 10            NA                    NA               NA #> 14            NA                    NA               NA #> 41            NA                    NA               NA #> 77            NA                    NA               NA #> 91            NA                    NA               NA #> 105           NA                    NA               NA lm3 <- lm_imp(SBP ~ age + WC + alc + smoke + occup, data = NHANES, n.adapt = 0,               monitor_params = c(other_models = TRUE, analysis_main = FALSE) )  parameters(lm3) #>    outcome                outcat               varname           coef #> 1      alc                  <NA>           (Intercept)       alpha[1] #> 2      alc                  <NA>                   age       alpha[2] #> 3      alc                  <NA>                    WC       alpha[3] #> 4      alc                  <NA>           smokeformer       alpha[4] #> 5      alc                  <NA>          smokecurrent       alpha[5] #> 6      alc                  <NA> occuplooking for work       alpha[6] #> 7      alc                  <NA>      occupnot working       alpha[7] #> 8    occup occuplooking for work           (Intercept)       alpha[8] #> 9    occup occuplooking for work                   age       alpha[9] #> 10   occup occuplooking for work                    WC      alpha[10] #> 11   occup occuplooking for work           smokeformer      alpha[11] #> 12   occup occuplooking for work          smokecurrent      alpha[12] #> 13   occup      occupnot working           (Intercept)      alpha[13] #> 14   occup      occupnot working                   age      alpha[14] #> 15   occup      occupnot working                    WC      alpha[15] #> 16   occup      occupnot working           smokeformer      alpha[16] #> 17   occup      occupnot working          smokecurrent      alpha[17] #> 18   smoke                  <NA>                   age      alpha[18] #> 19   smoke                  <NA>                    WC      alpha[19] #> 23   smoke                  <NA>                  <NA> gamma_smoke[1] #> 24   smoke                  <NA>                  <NA> gamma_smoke[2] #> 20      WC                  <NA>           (Intercept)      alpha[20] #> 21      WC                  <NA>                   age      alpha[21] #> 22      WC                  <NA>                  <NA>       sigma_WC"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"side-note-getting-information-about-of-the-imputation-models","dir":"Articles","previous_headings":"Monitoring parameters > Imputed values & parameters of the imputation models","what":"Side note: Getting information about of the imputation models","title":"Parameter Selection","text":"overview models form part joint model, including names parameters hyper-parameters can obtained ","code":"list_models(lm2) #> Linear model for \"SBP\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age, WC, alc>=1, smokeformer, smokecurrent,  #>   occuplooking for work, occupnot working  #> * Regression coefficients: #>   beta[1:8] (normal prior(s) with mean 0 and precision 1e-04)  #> * Precision of  \"SBP\" : #>   tau_SBP (Gamma prior with shape parameter 0.01 and rate parameter 0.01) #>  #>  #> Binomial model for \"alc\"  #>    family: binomial  #>    link: logit  #> * Reference category: \"<1\" #> * Predictor variables: #>   (Intercept), age, WC, smokeformer, smokecurrent,  #>   occuplooking for work, occupnot working  #> * Regression coefficients: #>   alpha[1:7] (normal prior(s) with mean 0 and precision 1e-04)  #>  #>  #> Multinomial logit model for \"occup\"  #> * Reference category: \"working\" #> * Predictor variables: #>   (Intercept), age, WC, smokeformer, smokecurrent  #> * Regression coefficients: #>   occuplooking for work: alpha[8:12] #>   occupnot working: alpha[13:17] (normal prior(s) with mean 0 and precision 1e-04)  #>  #>  #> Cumulative logit model for \"smoke\"  #> * Reference category: \"never\" #> * Predictor variables: #>   age, WC  #> * Regression coefficients: #>   alpha[18:19] (normal prior(s) with mean 0 and precision 1e-04)  #> * Intercepts: #>   - never: gamma_smoke[1] (normal prior with mean 0 and precision 1e-04) #>   - former: gamma_smoke[2] = gamma_smoke[1] + exp(delta_smoke[1]) #> * Increments: #>   delta_smoke[1] (normal prior(s) with mean 0 and precision 1e-04) #>  #>  #> Linear model for \"WC\"  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), age  #> * Regression coefficients: #>   alpha[20:21] (normal prior(s) with mean 0 and precision 1e-04)  #> * Precision of  \"WC\" : #>   tau_WC (Gamma prior with shape parameter 0.01 and rate parameter 0.01)"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"side-note-how-to-extract-imputed-datasets","dir":"Articles","previous_headings":"Monitoring parameters > Imputed values & parameters of the imputation models","what":"Side note: How to extract imputed datasets","title":"Parameter Selection","text":"Imputed datasets can extracted exported function get_MIdat(). completed dataset created taking imputed values randomly chosen iteration MCMC sample (transforming back original scale, scaling performed MCMC sampling) filling original, incomplete data. get_MIdat() returns long-format data.frame containing imputed datasets (possibly original data) stacked onto . imputation number given variable Imputation_, column .id contains newly created id variable observation cross-sectional data (multi-level data already contain id variable). get_MIdat() takes arguments:","code":""},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"random-effects","dir":"Articles","previous_headings":"Monitoring parameters","what":"Random effects","title":"Parameter Selection","text":"mixed models, analysis_main also includes random effects covariance matrix D: Setting analysis_random = TRUE switch monitoring random effects (ranef), random effects covariance matrix (D), inverse random effects covariance matrix (invD) diagonal scale matrix Wishart-prior invD (RinvD). possible select subset random effects parameters specifying directly, e.g. switching unwanted parts analysis_random , e.g.","code":"lme1 <- lme_imp(bmi ~ age + EDUC, random = ~age | ID, data = simLong, n.adapt = 0)  parameters(lme1) #>   outcome outcat     varname          coef #> 1     bmi   <NA> (Intercept)       beta[1] #> 2     bmi   <NA>     EDUCmid       beta[2] #> 3     bmi   <NA>     EDUClow       beta[3] #> 4     bmi   <NA>         age       beta[4] #> 5     bmi   <NA>        <NA>     sigma_bmi #> 6     bmi   <NA>        <NA> D_bmi_ID[1,1] #> 7     bmi   <NA>        <NA> D_bmi_ID[1,2] #> 8     bmi   <NA>        <NA> D_bmi_ID[2,2] lme2 <- lme_imp(bmi ~ age + EDUC, random = ~age | ID, data = simLong, n.adapt = 0,                 monitor_params = c(analysis_random = TRUE))  parameters(lme2) #>    outcome outcat     varname              coef #> 1      bmi   <NA> (Intercept)           beta[1] #> 2      bmi   <NA>     EDUCmid           beta[2] #> 3      bmi   <NA>     EDUClow           beta[3] #> 4      bmi   <NA>         age           beta[4] #> 5      bmi   <NA>        <NA>         sigma_bmi #> 6      bmi   <NA>        <NA>          b_bmi_ID #> 7      bmi   <NA>        <NA>  invD_bmi_ID[1,1] #> 8      bmi   <NA>        <NA>  invD_bmi_ID[1,2] #> 9      bmi   <NA>        <NA>  invD_bmi_ID[2,2] #> 10     bmi   <NA>        <NA>     D_bmi_ID[1,1] #> 11     bmi   <NA>        <NA>     D_bmi_ID[1,2] #> 12     bmi   <NA>        <NA>     D_bmi_ID[2,2] #> 13     bmi   <NA>        <NA> RinvD_bmi_ID[1,1] #> 14     bmi   <NA>        <NA> RinvD_bmi_ID[2,2] lme3a <- lme_imp(bmi ~ age + EDUC, random = ~age | ID, data = simLong, n.adapt = 0,                  monitor_params = c(analysis_main = TRUE, RinvD_main = TRUE))  parameters(lme3a) #>    outcome outcat     varname              coef #> 1      bmi   <NA> (Intercept)           beta[1] #> 2      bmi   <NA>     EDUCmid           beta[2] #> 3      bmi   <NA>     EDUClow           beta[3] #> 4      bmi   <NA>         age           beta[4] #> 5      bmi   <NA>        <NA>         sigma_bmi #> 6      bmi   <NA>        <NA>     D_bmi_ID[1,1] #> 7      bmi   <NA>        <NA>     D_bmi_ID[1,2] #> 8      bmi   <NA>        <NA>     D_bmi_ID[2,2] #> 9      bmi   <NA>        <NA> RinvD_bmi_ID[1,1] #> 10     bmi   <NA>        <NA> RinvD_bmi_ID[2,2] lme3b <- lme_imp(bmi ~ age + EDUC, random = ~age | ID, data = simLong, n.adapt = 0,                 monitor_params = c(analysis_main = TRUE,                                    analysis_random = TRUE,                                    RinvD_main = FALSE,                                    ranef_main = FALSE)) #> Warning:  #> It is currently not possible to use \"contr.poly\" for #> incomplete categorical covariates. I will use #> \"contr.treatment\" instead.  You can specify (globally) which #> types of contrasts are used by changing #> \"options('contrasts')\".  parameters(lme3b) #>    outcome outcat     varname             coef #> 1      bmi   <NA> (Intercept)          beta[1] #> 2      bmi   <NA>     EDUCmid          beta[2] #> 3      bmi   <NA>     EDUClow          beta[3] #> 4      bmi   <NA>         age          beta[4] #> 5      bmi   <NA>        <NA>        sigma_bmi #> 6      bmi   <NA>        <NA> invD_bmi_ID[1,1] #> 7      bmi   <NA>        <NA> invD_bmi_ID[1,2] #> 8      bmi   <NA>        <NA> invD_bmi_ID[2,2] #> 9      bmi   <NA>        <NA>    D_bmi_ID[1,1] #> 10     bmi   <NA>        <NA>    D_bmi_ID[1,2] #> 11     bmi   <NA>        <NA>    D_bmi_ID[2,2]"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"other-parameters","dir":"Articles","previous_headings":"Monitoring parameters","what":"Other parameters","title":"Parameter Selection","text":"element monitor_params allows specify one multiple additional parameters monitored. used one element, monitor_params list. , monitor probability alc>=1 group subjects 1 3 expected value distribution creat first subject. (may make lot sense able monitor node JAGS model can quite useful investigating convergence issues.)","code":"lm4 <- lm_imp(SBP ~ gender + WC + alc + creat, data = NHANES,               monitor_params = list(analysis_main = FALSE,                                     other = c('p_alc[1:3]', \"mu_creat[1]\")))  parameters(lm4) #>   outcat varname        coef outcome #> 1     NA      NA  p_alc[1:3]     alc #> 2     NA      NA mu_creat[1]   creat"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"subsets-of-parameters-for-plots-summaries","dir":"Articles","previous_headings":"","what":"Subsets of Parameters for Plots, Summaries, …","title":"Parameter Selection","text":"functions summary(), traceplot(), densplot(), GR_crit() MC_error() argument subset. argument allows us select subset parameters shown output. Especially parameters main analysis model followed, also, example, imputed values, looking subset may desirable. details functions, see also vignette Fitting. subset follows logic monitor_params described . default, parameters main analysis model displayed monitored:   analysis_main switched default behaviour parameters displayed:","code":"# Run a model monitoring analysis parameters and imputation parameters lm5 <- lm_imp(SBP ~ gender + WC + alc + creat, data = NHANES, n.iter = 100,               progress.bar = 'none', monitor_params = c(other_models = TRUE))  # model summary summary(lm5) #>  #> Bayesian linear model fitted with JointAI #>  #> Call: #> lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES,  #>     n.iter = 100, monitor_params = c(other_models = TRUE), progress.bar = \"none\") #>  #>  #> Posterior summary: #>                 Mean     SD   2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)  81.7399 9.6925 63.439 100.547      0.000    1.04 0.0577 #> genderfemale  0.0802 2.6383 -4.441   5.527      0.933    1.00 0.0577 #> WC            0.3074 0.0767  0.168   0.451      0.000    1.01 0.0577 #> alc>=1        6.3855 2.5770  1.542  11.284      0.020    1.01 0.0670 #> creat         6.8877 7.4473 -5.536  21.447      0.387    1.13 0.0586 #>  #> Posterior summary of residual std. deviation: #>           Mean    SD 2.5% 97.5% GR-crit MCE/SD #> sigma_SBP 14.4 0.704 13.1  15.9       1 0.0577 #>  #>  #> MCMC settings: #> Iterations = 101:200 #> Sample size per chain = 100  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 186  # traceplot of the MCMC sample traceplot(lm5) # density plot of the MCMC sample densplot(lm5) # Gelman-Rubin criterion GR_crit(lm5) #> Potential scale reduction factors: #>  #>              Point est. Upper C.I. #> (Intercept)       1.009       1.04 #> genderfemale      0.999       1.00 #> WC                1.003       1.01 #> alc>=1            1.003       1.01 #> creat             1.035       1.13 #> sigma_SBP         0.997       1.00 #>  #> Multivariate psrf #>  #> 1.04  # Monte Carlo Error of the MCMC sample MC_error(lm5) #>                est   MCSE    SD MCSE/SD #> (Intercept)  81.74 0.5596 9.692   0.058 #> genderfemale  0.08 0.1523 2.638   0.058 #> WC            0.31 0.0044 0.077   0.058 #> alc>=1        6.39 0.1727 2.577   0.067 #> creat         6.89 0.4361 7.447   0.059 #> sigma_SBP    14.38 0.0407 0.704   0.058 # Re-run the model from above, now creating MCMC samples lm4 <- lm_imp(SBP ~ gender + WC + alc + creat,               data = NHANES, n.iter = 100, progress.bar = 'none',               monitor_params = list(analysis_main = FALSE,                                     other = c('mu_alc[1:3]', \"mu_creat[1]\")))  traceplot(lm4, ncol = 4)"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"select-a-subset-of-the-variables-to-display","dir":"Articles","previous_headings":"Subsets of Parameters for Plots, Summaries, …","what":"Select a subset of the variables to display","title":"Parameter Selection","text":"display parts MCMC sample, subset needs specified: select parameters, can specified directly name via element subset: Note model summary contain separate parts per sub-model regression coefficients different models monitored. also works subset imputed values displayed:","code":"# we use lm5 from above GR_crit(lm5, subset = c(analysis_main = FALSE, other_models = TRUE)) #> Potential scale reduction factors: #>  #>                     Point est. Upper C.I. #> alc: (Intercept)         0.997      1.001 #> alc: genderfemale        1.005      1.025 #> alc: WC                  1.030      1.086 #> alc: creat               1.007      1.034 #> creat: (Intercept)       0.996      0.997 #> creat: genderfemale      0.999      1.000 #> creat: WC                0.995      0.996 #> WC: (Intercept)          1.011      1.039 #> WC: genderfemale         1.003      1.024 #> sigma_creat              1.010      1.040 #> sigma_WC                 1.007      1.032 #>  #> Multivariate psrf #>  #> 1.05 summary(lm5, subset = list(other = c('creat', 'alc>=1'))) #>  #> Bayesian linear model fitted with JointAI #>  #> Call: #> lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES,  #>     n.iter = 100, monitor_params = c(other_models = TRUE), progress.bar = \"none\") #>  #>  #> Posterior summary: #>                 Mean     SD   2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)  81.7399 9.6925 63.439 100.547      0.000    1.04 0.0577 #> genderfemale  0.0802 2.6383 -4.441   5.527      0.933    1.00 0.0577 #> WC            0.3074 0.0767  0.168   0.451      0.000    1.01 0.0577 #> alc>=1        6.3855 2.5770  1.542  11.284      0.020    1.01 0.0670 #> creat         6.8877 7.4473 -5.536  21.447      0.387    1.13 0.0586 #>  #> Posterior summary of residual std. deviation: #>           Mean    SD 2.5% 97.5% GR-crit MCE/SD #> sigma_SBP 14.4 0.704 13.1  15.9       1 0.0577 #>  #>  #> MCMC settings: #> Iterations = 101:200 #> Sample size per chain = 100  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 186 # Re-run the model from above, now creating MCMC samples lm2 <- lm_imp(SBP ~ age + WC + alc + smoke + occup,               data = NHANES, n.iter = 100, progress.bar = 'none',               monitor_params = c(imps = TRUE, analysis_main = FALSE) )  # select only imputed values for 'WC' (4th column of Wc) sub3 <- grep('M_lvlone\\\\[[[:digit:]]+,5\\\\]', parameters(lm2)$coef, value = TRUE) sub3 #> [1] \"M_lvlone[33,5]\"  \"M_lvlone[150,5]\"  traceplot(lm2, subset = list(other = sub3), ncol = 2)"},{"path":"https://nerler.github.io/JointAI/articles/SelectingParameters.html","id":"random-subset-of-subject-specific-values","dir":"Articles","previous_headings":"Subsets of Parameters for Plots, Summaries, …","what":"Random subset of subject-specific values","title":"Parameter Selection","text":"number imputed values larger, order check convergence random effects, may feasible plot trace plots. case, random subset , instance, random effects can selected:","code":"lme4 <- lme_imp(bmi ~ age + EDUC, random = ~age | ID,                 data = simLong, n.iter = 100, progress.bar = 'none',                 monitor_params = c(analysis_main = FALSE, ranef_main = TRUE))  # exract random intercepts ri <- grep('^b_bmi_ID\\\\[[[:digit:]]+,1\\\\]$', colnames(lme4$MCMC[[1]]), value = T)  # extract random slopes rs <- grep('^b_bmi_ID\\\\[[[:digit:]]+,2\\\\]$', colnames(lme4$MCMC[[1]]), value = T)  # plot the chains of 8 randomly selected random intercepts traceplot(lme4, subset = list(other = sample(ri, size = 8)), ncol = 4) # plot the chains of 8 randomly selected random slopes traceplot(lme4, subset = list(other = sample(rs, size = 8)), ncol = 4)"},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"sec:AnalysisModel","dir":"Articles","previous_headings":"","what":"Analysis model","title":"Theoretical Background","text":"analysis model interest described probability density function \\(p(\\mathbf y \\mid \\mathbf X, \\boldsymbol\\theta_{y\\mid x})\\). R package JointAI can currently handle analysis models generalized linear regression models (GLM), generalized linear mixed models (GLMM), cumulative logit (mixed) models, multinomial (mixed) models, beta (mixed) models, log-normal (mixed) models, parametric (Weibull) survival models, proportional hazards models. Moreover, possible fit joint models longitudinal survival data, survival model proportional hazards model longitudinal variables modelled using generalized, ordinal, beta log-normal mixed models.","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"generalized-linear-mixed-models","dir":"Articles","previous_headings":"Analysis model","what":"Generalized linear (mixed) models","title":"Theoretical Background","text":"GLM probability density function chosen exponential family linear predictor \\[g\\{E(y_i\\mid \\mathbf X, \\boldsymbol\\theta_{y\\mid x})\\} = \\mathbf x_i^\\top\\boldsymbol\\beta,\\] \\(g(\\cdot)\\) link function, \\(y_i\\) value outcome variable subject \\(\\), \\(\\mathbf x_i\\) column vector containing row \\(\\mathbf X\\) contains covariate information \\(\\). GLMM linear predictor form \\[g\\{E(y_{ij}\\mid \\mathbf X, \\mathbf b_i, \\boldsymbol\\theta_{y\\mid x})\\} = \\mathbf x_{ij}^\\top\\boldsymbol\\beta + \\mathbf z_{ij}^\\top\\mathbf b_i,\\] \\(y_{ij}\\) \\(j\\)-th outcome subject \\(\\), \\(\\mathbf x_{ij}\\) corresponding vector covariate values, \\(\\mathbf b_i\\) vector random effects pertaining subject \\(\\), \\(\\mathbf z_{ij}\\) column vector containing row design matrix random effects, \\(\\mathbf Z\\), corresponds \\(j\\)-th measurement subject \\(\\). \\(\\mathbf Z\\) typically contains subset variables \\(\\mathbf X\\), \\(\\mathbf b_i\\) follows normal distribution mean zero covariance matrix \\(\\mathbf D\\). cases parameter vector \\(\\boldsymbol\\theta_{y\\mid x}\\) contains regression coefficients \\(\\boldsymbol\\beta\\), potentially additional variance parameters (e.g., linear (mixed) models), prior distributions specified section prior distributions. JointAI standard link functions available (details see documentation glm_imp()). One exception square-root link, available since implemented link JAGS.","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"cumulative-logit-mixed-models","dir":"Articles","previous_headings":"Analysis model","what":"Cumulative logit (mixed) models","title":"Theoretical Background","text":"Cumulative logit mixed models form \\[\\begin{align*} y_{ij} &\\sim \\text{Mult}(\\pi_{ij,1}, \\ldots, \\pi_{ij,K}),\\\\[2ex] \\pi_{ij,1} &= P(y_{ij} \\leq 1),\\\\ \\pi_{ij,k} &= P(y_{ij} \\leq k) - P(y_{ij} \\leq k-1), \\quad k \\2, \\ldots, K-1,\\\\ \\pi_{ij,K} &= 1 - \\sum_{k = 1}^{K-1}\\pi_{ij,k},\\\\[2ex] \\text{logit}(P(y_{ij} \\leq k)) &= \\gamma_k + \\eta_{ij}, \\quad k \\1,\\ldots,K,\\\\ \\eta_{ij} &= \\mathbf x_{ij}^\\top\\boldsymbol\\beta + \\mathbf z_{ij}^\\top\\mathbf b_i,\\\\[2ex] \\gamma_1,\\delta_1,\\ldots,\\delta_{K-1} &\\overset{iid}{\\sim} N(\\mu_\\gamma, \\sigma_\\gamma^2),\\\\ \\gamma_k &\\sim \\gamma_{k-1} + \\exp(\\delta_{k-1}),\\quad k = 2,\\ldots,K, \\end{align*}\\] \\(\\pi_{ij,k} = P(y_{ij} = k)\\) \\(\\text{logit}(x) = \\log\\left(\\frac{x}{1-x}\\right)\\). cumulative logit regression model univariate outcome \\(y_i\\) can obtained dropping index \\(j\\) omitting \\(\\mathbf z_{ij}^\\top\\mathbf b_i\\). cumulative logit (mixed) models, design matrix \\(\\mathbf X\\) contain intercept, since outcome category specific intercepts \\(\\gamma_1,\\ldots, \\gamma_K\\) specified. , parameter vector \\(\\boldsymbol \\theta_{y\\mid x}\\) includes regression coefficients \\(\\boldsymbol\\beta\\), first intercept \\(\\gamma_1\\) increments \\(\\delta_1, \\ldots, \\delta_{K-1}\\).","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"survival-models","dir":"Articles","previous_headings":"Analysis model","what":"Survival models","title":"Theoretical Background","text":"Survival data typically characterized observed event censoring times, \\(T_i\\), event indicator, \\(D_i\\), one event observed zero otherwise. JointAI provides two types models analyse right censored survival data, parametric model assumes Weibull distribution true (partially unobserved) survival times \\(T^*\\), semi-parametric Cox proportional hazards model. parametric survival model implemented \\[\\begin{align*} T_i^* &\\sim \\text{Weibull}(1, r_i, s),\\\\ D_i &\\sim \\text{𝟙}(T_i^* \\geq C_i),\\\\ \\log(r_j) &= - \\mathbf x_i^\\top\\boldsymbol\\beta,\\\\ s &\\sim \\text{Exp}(0.01), \\end{align*}\\] 𝟙 indicator function one \\(T_i^*\\geq C_i\\), zero otherwise. Cox proportional hazards model can written \\[h_i(t) = h_0(t)\\exp(\\mathbf X_i \\boldsymbol\\beta),\\] \\(h_0(t)\\) baseline hazard function, , JointAI, model using B-spline approach, .e., \\(h_0(t) = \\sum_{q = 1}^{d} \\gamma_{Bq} B_q(t),\\) \\(B_q\\) denotes \\(q\\)-th basis function. survival function Cox model \\[S(t\\mid \\boldsymbol\\theta) = \\exp\\left\\{-\\int_0^th_0(s)\\exp\\left(\\mathbf X_i\\boldsymbol\\beta\\right)ds\\right\\} = \\exp\\left\\{-\\exp\\left(\\mathbf X_i\\boldsymbol\\beta\\right)\\int_0^th_0(s)ds\\right\\},\\] \\(\\boldsymbol\\theta\\) includes regression coefficients \\(\\boldsymbol\\beta\\) (contain intercept) coefficients \\(\\boldsymbol \\gamma_{B}\\) used specification baseline hazard. Since integral baseline hazard closed-form solution, JointAI approximated using Gauss-Kronrod quadrature 15 evaluation points.","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"imputation-covariate-part","dir":"Articles","previous_headings":"","what":"Imputation / covariate part","title":"Theoretical Background","text":"convenient way specify joint distribution incomplete covariates \\(\\mathbf X_{mis} = (\\mathbf x_{mis_1}, \\ldots, \\mathbf x_{mis_q})\\) use sequence conditional univariate distributions (Ibrahim, Chen, Lipsitz 2002; Erler et al. 2016)  \\[\\begin{align} p(\\mathbf x_{mis_1}, \\ldots, \\mathbf x_{mis_q} \\mid \\mathbf X_{obs}, \\boldsymbol\\theta_{x}) & =  p(\\mathbf x_{mis_1} \\mid \\mathbf X_{obs}, \\boldsymbol\\theta_{x_1})\\nonumber\\\\ & \\phantom{=}    \\prod_{\\ell=2}^q p(\\mathbf x_{mis_{\\ell}} \\mid \\mathbf X_{obs}, \\mathbf x_{mis_1}, \\ldots, \\mathbf x_{mis_{\\ell-1}}, \\boldsymbol\\theta_{x_\\ell}),\\tag{1} \\end{align}\\] \\(\\boldsymbol\\theta_{x} = (\\boldsymbol\\theta_{x_1}^\\top, \\ldots, \\boldsymbol\\theta_{x_q}^\\top)^\\top\\). conditional distributions member exponential family, extended distributions ordinal categorical variables, chosen according type respective variable. linear predictor \\[ g_\\ell\\left\\{E\\left(x_{,mis_\\ell} \\mid \\mathbf x_{,obs}, \\mathbf x_{, mis_{<\\ell}}, \\boldsymbol\\theta_{x_\\ell}\\right) \\right\\} = (\\mathbf x_{, obs}^\\top, x_{, mis_1}, \\ldots, x_{, mis_{\\ell-1}}) \\boldsymbol\\alpha_{\\ell}, \\quad \\ell=1,\\ldots,q, \\] \\(\\mathbf x_{,mis_{<\\ell}} = (x_{,mis_1}, \\ldots, x_{,mis_{\\ell-1}})^\\top\\) \\(\\mathbf x_{,obs}\\) vector values subject \\(\\) covariates observed subjects. Factorization joint distribution covariates sequence yields straightforward specification joint distribution, even covariates mixed type. Missing values covariates sampled full-conditional distribution can derived full joint distribution outcome covariates. , instance, analysis model GLM, full conditional distribution incomplete covariate \\(x_{, mis_{\\ell}}\\) can written \\[\\begin{align} \\nonumber p(x_{, mis_{\\ell}} \\mid \\mathbf y_i, \\mathbf x_{,obs}, \\mathbf x_{,mis_{-\\ell}}, \\boldsymbol\\theta) \\propto& p \\left(y_i \\mid \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{y\\mid x} \\right) p(\\mathbf x_{, mis}\\mid \\mathbf x_{, obs}, \\boldsymbol\\theta_{x})\\, p(\\boldsymbol\\theta_{y\\mid x})\\, p(\\boldsymbol\\theta_{x})\\\\\\nonumber \\propto& p \\left(y_i \\mid \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{y\\mid x} \\right)\\\\\\nonumber         & p(x_{, mis_\\ell} \\mid \\mathbf x_{, obs}, \\mathbf x_{, mis_{<\\ell}}, \\boldsymbol\\theta_{x_\\ell})\\\\\\nonumber         & \\left\\{ \\prod_{k=\\ell+1}^q p(x_{,mis_k}\\mid \\mathbf x_{, obs}, \\mathbf x_{, mis_{<k}}, \\boldsymbol\\theta_{x_k}) \\right\\}\\\\         & p(\\boldsymbol\\theta_{y\\mid x}) p(\\boldsymbol\\theta_{x_\\ell}) \\prod_{k=\\ell+1}^p p(\\boldsymbol\\theta_{x_k}), \\tag{2} \\end{align}\\] \\(\\boldsymbol\\theta_{x_{\\ell}}\\) vector parameters describing model \\(\\ell\\)-th covariate, contains vector regression coefficients \\(\\boldsymbol\\alpha_\\ell\\) potentially additional (variance) parameters. product distributions enclosed curly brackets represents distributions covariates \\(x_{mis_\\ell}\\) predictive variable specification sequence (1). Note (2) describes actual imputation model, .e., distribution imputed values \\(x_{, mis_{\\ell}}\\) sampled , sequence covariates models (1) used describe joint distribution. (2) derived joint distribution.","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"sec:impLong","dir":"Articles","previous_headings":"Imputation / covariate part","what":"Imputation in settings with longitudinal outcomes","title":"Theoretical Background","text":"Factorizing joint distribution analysis model imputation part also facilitates extensions settings complex outcomes, repeatedly measured outcomes. case analysis model GLMM ordinal mixed model, conditional distribution outcome (2), \\(p\\left(y_i \\mid \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{y\\mid x} \\right),\\) replaced \\[\\begin{equation} \\left\\{\\prod_{j=1}^{n_i} p \\left(y_{ij} \\mid \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\mathbf b_i, \\boldsymbol\\theta_{y\\mid x}\\right) \\right\\}. \\tag{3} \\end{equation}\\] Since \\(\\mathbf y\\) appear terms (2), (3) can chosen model appropriate outcome hand, thereby specified full conditional distribution \\(x_{, mis_\\ell}\\) allows us draw valid imputations use available information outcome. important difference multiple imputation using fully conditional specification (FCS, .k.. MICE), full conditional distributions used impute missing values specified directly, usually regression models, require outcome explicitly included linear predictor imputation model. settings complex outcomes clear done simplifications may lead biased results (Erler et al. 2016). joint model specification utilized JointAI overcomes difficulty. covariates time-varying, convenient specify models variables beginning sequence covariate models, models longitudinal variables longitudinal baseline covariates linear predictor, longitudinal covariates enter predictors baseline covariates. Note , whenever incomplete baseline covariates necessary specify models longitudinal variables, even completely observed ones, models completely observed baseline covariates can omitted. becomes clear extend factorized joint distribution completely incompletely observed longitudinal (level-1) covariates \\(\\mathbf s_{obs}\\) \\(\\mathbf s_{mis}\\): \\[ p \\left(y_{ij} \\mid \\mathbf s_{ij, obs}, \\mathbf s_{ij, mis}, \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{y\\mid x} \\right)\\\\\\\\ p(\\mathbf s_{ij, mis}\\mid \\mathbf s_{ij, obs}, \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{s_{mis}})\\, p(\\mathbf s_{ij, obs}\\mid \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{s_{obs}})\\\\ p(\\mathbf x_{, mis}\\mid \\mathbf x_{, obs}, \\boldsymbol\\theta_{x_{mis}})\\, p(\\mathbf x_{, obs} \\mid \\boldsymbol\\theta_{x_{obs}})\\, p(\\boldsymbol\\theta_{y\\mid x})\\, p(\\boldsymbol\\theta_{s_{mis}}) \\, p(\\boldsymbol\\theta_{s_{obs}})\\, p(\\boldsymbol\\theta_{x_{mis}}) \\, p(\\boldsymbol\\theta_{x_{obs}}) \\] Given parameter vectors \\(\\theta_{x_{obs}}\\), \\(\\theta_{x_{mis}}\\), \\(\\theta_{s_{obs}}\\) \\(\\theta_{s_{mis}}\\) priori independent, \\(p(\\mathbf x_{, obs} \\mid \\boldsymbol\\theta_{x_{obs}})\\) independent \\(x_{mis}\\) \\(s_{mis}\\), can omitted. Since \\(p(\\mathbf s_{ij, obs}\\mid \\mathbf x_{, obs}, \\mathbf x_{, mis}, \\boldsymbol\\theta_{s_{obs}})\\), however, \\(\\mathbf x_{, mis}\\) linear predictor , hence, part full conditional distribution \\(\\mathbf x_{, mis}\\), omitted model.","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"non-linear-associations-and-interactions","dir":"Articles","previous_headings":"Imputation / covariate part","what":"Non-linear associations and interactions","title":"Theoretical Background","text":"settings fully Bayesian approach employed JointAI advantage standard FCS settings interaction terms involve incomplete covariates association outcome incomplete covariate non-linear. standard FCS settings lead incompatible imputation models (White, Royston, Wood 2011; Bartlett et al. 2015). becomes clear considering following simple example analysis model interest linear regression \\(y_i = \\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2 + \\varepsilon_i\\) \\(x_i\\) imputed using \\(x_i = \\alpha_0 + \\alpha_1 y_i + \\tilde\\varepsilon_i\\). analysis model assumes quadratic relationship, imputation model assumes linear association \\(\\mathbf x\\) \\(\\mathbf y\\) joint distribution imputation analysis model full conditional distributions. , JointAI, analysis model factor full conditional distribution used impute \\(x_i\\), non-linear association taken account. Furthermore, since joint distribution specified, full conditional derived , joint distribution ensured exist.","code":""},{"path":"https://nerler.github.io/JointAI/articles/TheoreticalBackground.html","id":"sec:priors","dir":"Articles","previous_headings":"","what":"Prior distributions","title":"Theoretical Background","text":"Prior distributions specified (hyper)parameters. common prior choice regression coefficients normal distribution mean zero large variance. JointAI variance parameters models normally distributed variables specified , default vague, inverse-gamma distributions. covariance matrix random effects mixed model, \\(\\mathbf D\\), assumed follow inverse Wishart distribution degrees freedom usually chosen equal dimension random effects, scale matrix diagonal. Since magnitude diagonal elements relates variance random effects, choice suitable values depends scale variable random effect associated . Therefore, JointAI uses independent gamma hyper-priors diagonal elements. details default hyper-parameters change given section hyper-parameters vignette Model Specification.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"visualize-the-distribution-of-each-variable","dir":"Articles","previous_headings":"","what":"Visualize the distribution of each variable","title":"Visualizing Incomplete Data","text":"Using plot_all(), array histograms (continuous variables dates) bar plots (categorical variables) can obtained.  Note: , looking marginal distribution variable. Since missing values (usually) imputed conditionally variables, marginal plots can used indication type imputation model (e.g., normal vs non-normal) appropriate.","code":"op <- par(mar = c(2.5, 3, 2.5, 1), mgp = c(2, 0.8, 0)) plot_all(NHANES) par(op)"},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"plot-titles-proportion-of-missing-values","dir":"Articles","previous_headings":"Visualize the distribution of each variable","what":"Plot titles: proportion of missing values","title":"Visualizing Incomplete Data","text":"argument allNA allows select whether proportion missing values given incomplete variables , setting allNA = TRUE, variables.","code":""},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"changing-colors","dir":"Articles","previous_headings":"Visualize the distribution of each variable","what":"Changing colors","title":"Visualizing Incomplete Data","text":"colour bars border can controlled arguments fill border.","code":""},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"layout","dir":"Articles","previous_headings":"Visualize the distribution of each variable","what":"Layout","title":"Visualizing Incomplete Data","text":"number rows columns plot layout determined automatically depending number variables data can overwritten using nrow /ncol.","code":""},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"additional-arguments","dir":"Articles","previous_headings":"Visualize the distribution of each variable","what":"Additional arguments","title":"Visualizing Incomplete Data","text":"also possible provide arguments hist() barplot(). example:","code":"par(mar = c(2.5, 3, 2.5, 1), mgp = c(2, 0.8, 0)) plot_all(NHANES, allNA = TRUE, fill = '#e30f41', border = '#34111b', ncol = 3, breaks = 30)"},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"multi-level-data","dir":"Articles","previous_headings":"Visualize the distribution of each variable","what":"Multi-level data","title":"Visualizing Incomplete Data","text":"data multi-level structure, e.g., subjects nested within hospitals, subjects measured repeatedly simLong data, level variable can taken account specifying names grouping variables (“id” variables) via argument idvars. information level variable belongs added title plot (“lvlone” refers first level, grouping variable). Variables belonging higher levels (e.g., center-specific variables multi-center setting, patient-specific variables setting repeated measurements patient) summarized respective level, .e., counts ETHN, instance, sum number subjects simLong data.","code":"par(mar = c(2.5, 3, 2.5, 1), mgp = c(2, 0.8, 0)) plot_all(simLong, allNA = TRUE, fill = '#e30f41', border = '#34111b',          ncol = 3, breaks = 30, idvars = \"ID\")"},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"missing-data-pattern","dir":"Articles","previous_headings":"","what":"Missing Data Pattern","title":"Visualizing Incomplete Data","text":"pattern missing data can visualized function md_pattern():  resulting plot, variables given columns row corresponds one pattern missingness across variables. numbers right margin give number cases per pattern. Underneath plot, number missing values per variable given. Columns automatically sorted number missing values, rows number cases per pattern. plot generated help ggplot(), , hence, package ggplot2 needs installed. setting plot = FALSE, plot generated (ggplot2 required).","code":"md_pattern(NHANES)"},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"missing-data-pattern-as-a-matrix","dir":"Articles","previous_headings":"Missing Data Pattern","what":"Missing data pattern as a matrix","title":"Visualizing Incomplete Data","text":"argument pattern = TRUE set, missing data pattern returned matrix, observed values represented 1 missing values 0:","code":"md_pattern(NHANES, pattern = T, plot = F) #>      SBP gender age race educ WC smoke creat albu uricacid bili occup alc Npat #> 1      1      1   1    1    1  1     1     1    1        1    1     1   1  116 #> 2      1      1   1    1    1  1     1     1    1        1    1     1   0   29 #> 3      1      1   1    1    1  1     1     1    1        1    1     0   1   24 #> 4      1      1   1    1    1  1     0     1    1        1    1     1   1    5 #> 5      1      1   1    1    1  1     1     0    0        0    0     1   1    4 #> 6      1      1   1    1    1  1     1     0    0        0    0     0   0    2 #> 7      1      1   1    1    1  1     0     1    1        1    1     0   1    1 #> 8      1      1   1    1    1  0     1     1    1        1    1     1   0    1 #> 9      1      1   1    1    1  1     1     1    1        1    1     0   0    1 #> 10     1      1   1    1    1  1     1     0    0        0    0     1   0    1 #> 11     1      1   1    1    1  0     1     1    1        1    1     1   1    1 #> 12     1      1   1    1    1  1     0     0    0        0    0     1   1    1 #> Nmis   0      0   0    0    0  2     7     8    8        8    8    28  34  103"},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"changing-colors-1","dir":"Articles","previous_headings":"Missing Data Pattern","what":"Changing colors","title":"Visualizing Incomplete Data","text":"arguments color border can used change colour used observed missing values (order, .e., color vector length two), border separating rectangles, respectively.","code":""},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"legend-position","dir":"Articles","previous_headings":"Missing Data Pattern","what":"Legend position","title":"Visualizing Incomplete Data","text":"position legend can controlled argument legend.position, can one \"left\", \"right\", \"bottom\" \"top\". legend.position = 'none', legend printed.","code":""},{"path":"https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html","id":"changing-the-axes","dir":"Articles","previous_headings":"Missing Data Pattern","what":"Changing the axes","title":"Visualizing Incomplete Data","text":"hide x-axis, argument print_xaxis can set FALSE. corresponding argument print_yaxis = FALSE y-axis can omitted. change title y-axis, can change argument ylab. Setting ylab = '' hide axis title, keep number observations per missing data pattern.   simLong data, missing data pattern :","code":"md_pattern(NHANES, color = c('#34111b', '#e30f41'), border = 'white',            legend.position = 'none', print_xaxis = FALSE,            ylab = 'Alternative axis title') md_pattern(simLong, color = c('#34111b', '#e30f41'))"},{"path":"https://nerler.github.io/JointAI/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Nicole S. Erler. Author, maintainer.","code":""},{"path":"https://nerler.github.io/JointAI/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Erler NS, Rizopoulos D, Lesaffre EMEH (2021). “JointAI: Joint Analysis Imputation Incomplete Data R.” Journal Statistical Software, 100(20), 1–56. doi:10.18637/jss.v100.i20.","code":"@Article{,   title = {{JointAI}: Joint Analysis and Imputation of Incomplete Data in {R}},   author = {Nicole S. Erler and Dimitris Rizopoulos and Emmanuel M. E. H. Lesaffre},   journal = {Journal of Statistical Software},   year = {2021},   volume = {100},   number = {20},   pages = {1--56},   doi = {10.18637/jss.v100.i20}, }"},{"path":"https://nerler.github.io/JointAI/index.html","id":"jointai-joint-analysis-and-imputation-of-incomplete-data-","dir":"","previous_headings":"","what":"Joint Analysis and Imputation of Incomplete Data","title":"Joint Analysis and Imputation of Incomplete Data","text":"package JointAI provides functionality perform joint analysis imputation range model types Bayesian framework. Implemented (generalized) linear regression models extensions thereof, models (un-/ordered) categorical data, well multi-level (mixed) versions model types. Moreover, survival models joint models longitudinal survival data available. also possible fit multiple models mixed types simultaneously. Missing values (present) imputed automatically. JointAI performs preprocessing data creates JAGS model, automatically passed JAGS help R package rjags. Besides main modelling functions, JointAI also provides number functions summarize visualize results incomplete data.","code":""},{"path":"https://nerler.github.io/JointAI/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Joint Analysis and Imputation of Incomplete Data","text":"JointAI can installed CRAN: Alternatively, can install JointAI GitHub:","code":"install.packages('JointAI') # install.packages(\"remotes\") remotes::install_github(\"NErler/JointAI\")"},{"path":"https://nerler.github.io/JointAI/index.html","id":"main-functions","dir":"","previous_headings":"","what":"Main functions","title":"Joint Analysis and Imputation of Incomplete Data","text":"JointAI provides following main functions: functions use specification similar well known standard functions like lm() glm() base R, nlme::lme() (package nlme) , lme4::lmer() lme4::glmer() (package lme4) survival::survreg() survival::coxph() (package survival). Functions summary(), coef(), traceplot() densplot() provide summary posterior distribution visualization. GR_crit() MC_error() implement Gelman-Rubin diagnostic convergence Monte Carlo error MCMC sample, respectively. JointAI also provides functions exploration distribution data missing values, export imputed values prediction.","code":"lm_imp()                 # linear regression glm_imp()                # generalized linear regression clm_imp()                # cumulative logit model mlogit_imp()             # multinomial logit model lognorm_imp()            # log-normal regression betareg_imp()            # beta regression lme_imp() / lmer_imp()   # linear mixed model glme_imp() / glmer_imp() # generalized linear mixed model clmm_imp()               # cumulative logit mixed model mlogitmm_imp()           # multinomial logit model lognormmm_imp()          # log-normal regression betamm_imp()             # beta regression survreg_imp()            # parametric (Weibull) survival model coxph_imp()              # proportional hazards survival model JM_imp()                 # joint model for longitudinal and survival data"},{"path":[]},{"path":"https://nerler.github.io/JointAI/index.html","id":"visualize-the-observed-data-and-missing-data-pattern","dir":"","previous_headings":"Minimal Example","what":"Visualize the observed data and missing data pattern","title":"Joint Analysis and Imputation of Incomplete Data","text":"","code":"library(JointAI)  plot_all(   NHANES[c(1, 5:6, 8:12)],   fill = '#D10E3B',   border = '#460E1B',   ncol = 4,   breaks = 30 ) md_pattern(NHANES, color = c('#460E1B', '#D10E3B'))"},{"path":"https://nerler.github.io/JointAI/index.html","id":"fit-a-linear-regression-model-with-incomplete-covariates","dir":"","previous_headings":"Minimal Example","what":"Fit a linear regression model with incomplete covariates","title":"Joint Analysis and Imputation of Incomplete Data","text":"","code":"lm1 <- lm_imp(   SBP ~ gender + age + WC + alc + educ + bili,   data = NHANES,   n.iter = 500,   progress.bar = 'none',   seed = 2020 )"},{"path":"https://nerler.github.io/JointAI/index.html","id":"visualize-the-mcmc-sample","dir":"","previous_headings":"Minimal Example","what":"Visualize the MCMC sample","title":"Joint Analysis and Imputation of Incomplete Data","text":"","code":"traceplot(lm1, col = c('#d4af37', '#460E1B', '#D10E3B'), ncol = 4) densplot(lm1, col = c('#d4af37', '#460E1B', '#D10E3B'), ncol = 4, lwd = 2)"},{"path":"https://nerler.github.io/JointAI/index.html","id":"summarize-the-result","dir":"","previous_headings":"Minimal Example","what":"Summarize the Result","title":"Joint Analysis and Imputation of Incomplete Data","text":"","code":"summary(lm1) #>  #> Bayesian linear model fitted with JointAI #>  #> Call: #> lm_imp(formula = SBP ~ gender + age + WC + alc + educ + bili,  #>     data = NHANES, n.iter = 500, seed = 2020, progress.bar = \"none\") #>  #>  #> Posterior summary: #>                Mean     SD     2.5%   97.5% tail-prob. GR-crit MCE/SD #> (Intercept)  87.662 8.6088  70.3830 104.899    0.00000    1.00 0.0271 #> genderfemale -3.487 2.2407  -7.9563   0.818    0.10533    1.01 0.0258 #> age           0.334 0.0683   0.1986   0.468    0.00000    1.01 0.0258 #> WC            0.230 0.0721   0.0876   0.376    0.00133    1.00 0.0258 #> alc>=1        6.419 2.3862   1.6656  11.112    0.00667    1.03 0.0358 #> educhigh     -2.805 2.0681  -6.9371   1.339    0.17067    1.00 0.0258 #> bili         -5.277 4.7332 -14.7727   3.596    0.25333    1.01 0.0275 #>  #> Posterior summary of residual std. deviation: #>           Mean    SD 2.5% 97.5% GR-crit MCE/SD #> sigma_SBP 13.5 0.725 12.2    15    1.01 0.0258 #>  #>  #> MCMC settings: #> Iterations = 101:600 #> Sample size per chain = 500  #> Thinning interval = 1  #> Number of chains = 3  #>  #> Number of observations: 186 coef(lm1) #> $SBP #>  (Intercept) genderfemale          age           WC       alc>=1     educhigh  #>   87.6622381   -3.4873104    0.3335133    0.2302755    6.4194926   -2.8054874  #>         bili    sigma_SBP  #>   -5.2768560   13.5278177  confint(lm1) #> $SBP #>                      2.5%       97.5% #> (Intercept)   70.38301720 104.8986161 #> genderfemale  -7.95631510   0.8182921 #> age            0.19857014   0.4678630 #> WC             0.08761699   0.3756334 #> alc>=1         1.66562640  11.1121370 #> educhigh      -6.93714769   1.3389344 #> bili         -14.77269911   3.5955383 #> sigma_SBP     12.16165429  15.0367180"},{"path":"https://nerler.github.io/JointAI/reference/GR_crit.html","id":null,"dir":"Reference","previous_headings":"","what":"Gelman-Rubin criterion for convergence — GR_crit","title":"Gelman-Rubin criterion for convergence — GR_crit","text":"Calculates Gelman-Rubin criterion convergence (uses gelman.diag package coda).","code":""},{"path":"https://nerler.github.io/JointAI/reference/GR_crit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gelman-Rubin criterion for convergence — GR_crit","text":"","code":"GR_crit(object, confidence = 0.95, transform = FALSE, autoburnin = TRUE,   multivariate = TRUE, subset = NULL, exclude_chains = NULL,   start = NULL, end = NULL, thin = NULL, warn = TRUE, mess = TRUE,   ...)"},{"path":"https://nerler.github.io/JointAI/reference/GR_crit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gelman-Rubin criterion for convergence — GR_crit","text":"object object inheriting class 'JointAI' confidence coverage probability confidence interval potential scale reduction factor transform logical flag indicating whether variables x transformed improve normality distribution. set TRUE, log transform logit transform, appropriate, applied. autoburnin logical flag indicating whether second half   series used computation.  set TRUE   (default) start(x) less end(x)/2 start   series adjusted second half series used. multivariate logical flag indicating whether multivariate potential scale reduction factor calculated multivariate chains subset subset parameters/variables/nodes (columns MCMC sample). Follows principle argument monitor_params *_imp. exclude_chains optional vector index numbers chains excluded start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE. ... currently used","code":""},{"path":"https://nerler.github.io/JointAI/reference/GR_crit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gelman-Rubin criterion for convergence — GR_crit","text":"Gelman, Rubin, DB (1992) Inference iterative simulation using multiple sequences, Statistical Science, 7, 457-511. Brooks, SP. Gelman, . (1998) General methods monitoring convergence iterative simulations. Journal Computational Graphical Statistics, 7, 434-455.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/GR_crit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gelman-Rubin criterion for convergence — GR_crit","text":"","code":"mod1 <- lm_imp(y ~ C1 + C2 + M2, data = wideDF, n.iter = 100) GR_crit(mod1) #> Potential scale reduction factors: #>  #>             Point est. Upper C.I. #> (Intercept)      1.001      1.006 #> C1               1.002      1.006 #> C2               1.009      1.027 #> M22              1.002      1.018 #> M23              0.998      0.999 #> M24              1.002      1.015 #> sigma_y          1.013      1.055 #>  #> Multivariate psrf #>  #> 1.02"},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":null,"dir":"Reference","previous_headings":"","what":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"JointAI package performs simultaneous imputation inference incomplete complete data Bayesian framework. Models incomplete covariates, conditional covariates, specified automatically modelled jointly analysis model. MCMC sampling performed 'JAGS' via R package rjags.","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":"main-functions","dir":"Reference","previous_headings":"","what":"Main functions","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"JointAI provides following main functions facilitate analysis different models: lm_imp linear regression glm_imp generalized linear regression betareg_imp regression using beta distribution lognorm_imp regression using log-normal distribution clm_imp (ordinal) cumulative logit models mlogit_imp multinomial models lme_imp lmer_imp linear mixed models glme_imp glmer_imp generalized linear mixed models betamm_imp mixed models using beta distribution lognormmm_imp mixed models using log-normal distribution clmm_imp (ordinal) cumulative logit mixed models survreg_imp parametric (Weibull) survival models coxph_imp (Cox) proportional hazard models JM_imp joint models longitudinal survival data far possible, specification functions analogous specification widely used functions analysis complete data, lm, glm, lme (package nlme), survreg (package survival) coxph (package survival). Computations can performed parallel reduce computational time, using package future, argument shrinkage allows user impose penalty regression coefficients models involved, hyper-parameters can changed via argument hyperpars. obtain summaries results, functions summary(), coef() confint() available, results can visualized help traceplot() densplot(). function predict() allows prediction (including credible intervals) JointAI models.","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":"evaluation-and-export","dir":"Reference","previous_headings":"","what":"Evaluation and export","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"Two criteria evaluation convergence precision posterior estimate available: GR_crit implements Gelman-Rubin criterion ('potential scale reduction factor') convergence MC_error calculates Monte Carlo error evaluate precision MCMC sample Imputed data can extracted (exported SPSS) using get_MIdat(). function plot_imp_distr() allows visual comparison distribution observed imputed values.","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":"other-useful-functions","dir":"Reference","previous_headings":"","what":"Other useful functions","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"parameters list_models gain insight specified model plot_all md_pattern visualize distribution data missing data pattern","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":"vignettes","dir":"Reference","previous_headings":"","what":"Vignettes","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"following vignettes available Minimal Example: minimal example demonstrating use lm_imp, summary.JointAI, traceplot densplot. Visualizing Incomplete Data: Demonstrations options plot_all (plotting histograms bar plots variables data)  md_pattern (plotting printing missing data pattern). Model Specification: Explanation demonstration parameters required optional specify model structure lm_imp, glm_imp lme_imp. Among others, functions parameters, list_models set_refcat used. Parameter Selection: Examples select parameters/variables/nodes follow using argument monitor_params parameters/variables/nodes displayed summary, traceplot, densplot using GR_crit MC_error. MCMC Settings: Examples demonstrating set arguments controlling settings MCMC sampling, .e., n.adapt, n.iter, n.chains, thin, inits. Fitting: Examples use functions applied model fitted, including traceplot, densplot, summary, GR_crit, MC_error, predict, predDF get_MIdat. Theoretical Background: Explanation statistical method implemented JointAI.","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"Erler NS, Rizopoulos D, Lesaffre EMEH (2021). \"JointAI: Joint Analysis Imputation Incomplete Data R.\" Journal Statistical Software, 100(20), 1-56. doi:10.18637/jss.v100.i20 . Erler, N.S., Rizopoulos, D., Rosmalen, J., Jaddoe, V.W.V., Franco, O. H., & Lesaffre, E.M.E.H. (2016). Dealing missing covariates epidemiologic studies: comparison multiple imputation full Bayesian approach. Statistics Medicine, 35(17), 2955-2974. doi:10.1002/sim.6944 Erler, N.S., Rizopoulos D., Jaddoe, V.W.V., Franco, O.H. & Lesaffre, E.M.E.H. (2019). Bayesian imputation time-varying covariates linear mixed models. Statistical Methods Medical Research, 28(2), 555–568. doi:10.1177/0962280217730851","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/JointAI.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"JointAI: Joint Analysis and Imputation of Incomplete Data — JointAI","text":"Maintainer: Nicole S. Erler n.s.erler@umcutrecht.nl (ORCID)","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAIObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitted object of class 'JointAI' — JointAIObject","title":"Fitted object of class 'JointAI' — JointAIObject","text":"object returned one main functions *_imp.","code":""},{"path":"https://nerler.github.io/JointAI/reference/JointAIObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitted object of class 'JointAI' — JointAIObject","text":"analysis_type lm, glm, clm, lme, glme, clmm, survreg coxph (attributes family link GLM-type models formula formula used (analysis) model. data original (incomplete, pre-processed) data models named vector specifying types sub-models fixed list fixed effects formulas sub-model(s) use specified formula random list random effects formulas sub-model(s) use specified formula Mlist list (internal use) containing data information extracted data model formulas, split named vector identifying levels (hierarchy) variables (Mlvls) vector id variables extracted random effects formulas (idvar) list grouping information grouping level data (groups) named vector identifying hierarchy grouping levels (group_lvls) named vector giving number observations level hierarchy (N) name time variable (survival models time-varying covariates) (timevar) formula auxiliary variables (auxvars) list specifying reference categories dummy variables factors involved models (refs) list linear predictor information (column numbers per design matrix) sub-models (lp_cols) list identifying information interaction terms found model formulas (interactions) data.frame containing information transformations incomplete variables (trafos) data.frame containing information transformations variables (fcts_all) logical indicator parameter posterior predictive checks monitored (ppc; yet used) vector specifying shrinkage regression coefficients performed, models type shrinkage (shrinkage) number degrees freedom used spline specification baseline hazard proportional hazards survival models (df_basehaz) list matrices, one per level data, specifying centring scaling parameters data (scale_pars) list containing information outcomes (mostly relevant survival outcomes; outcomes) list terms objects, needed able build correct design matrices Gauss-Kronrod quadrature , example, splines used model time joint model (terms_list) par_index_main list matrices specifying indices regression coefficients main models per design matrix par_index_other list matrices specifying indices regression coefficients covariate model per design matrix jagsmodel JAGS model character string. mcmc_settings list containing MCMC sampling related information elements modelfile: path name JAGS model file n.chains: number MCMC chains n.adapt: number iterations adaptive phase n.iter: number iterations MCMC sample variable.names: monitored nodes thin: thinning interval MCMC sample inits: list containing initial values passed rjags monitor_params named list parameter groups monitored data_list list data passed rjags hyperpars list containing values hyper-parameters used info_list list information used write imputation model syntax coef_list list relating regression coefficient vectors used JAGS model names corresponding covariates model JAGS model (object class 'jags', created rjags) sample MCMC sample sampling scale (included keep_scaled_sample = TRUE) MCMC MCMC sample, scaled back scale data comp_info list information computational setting (start_time: date time calculation started, duration: computational time model adaptive sampling phase, JointAI_version: package version, R_version: R.version.string, parallel: whether parallel computation used, workers: parallel computation used, number workers) fitted.values fitted/predicted values (available) residuals residuals (available) call original call","code":""},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate and plot the Monte Carlo error — MC_error","title":"Calculate and plot the Monte Carlo error — MC_error","text":"Calculate, print plot Monte Carlo error samples 'JointAI' model, combining samples MCMC chains.","code":""},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate and plot the Monte Carlo error — MC_error","text":"","code":"MC_error(x, subset = NULL, exclude_chains = NULL, start = NULL,   end = NULL, thin = NULL, digits = 2, warn = TRUE, mess = TRUE, ...)  # S3 method for class 'MCElist' plot(x, data_scale = TRUE, plotpars = NULL,   ablinepars = list(v = 0.05), minlength = 20, ...)"},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate and plot the Monte Carlo error — MC_error","text":"x object inheriting class 'JointAI' subset subset parameters/variables/nodes (columns MCMC sample). Follows principle argument monitor_params *_imp. exclude_chains optional vector index numbers chains excluded start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. digits number digits printed output warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE. ... Arguments passed mcmcse::mcse.mat size represents batch size “bm” truncation point “bartlett” “tukey”. Default NULL implies optimal batch size calculated using   batchSize function. Can take character values “sqroot” “cuberoot” numeric   value 1 n/2. “sqroot” means size \\(\\lfloor n^{1/2} \\rfloor\\) “cuberoot” means size   \\(\\lfloor n^{1/3} \\rfloor\\). g function \\(E(g(x))\\) quantity interest. default NULL, causes identity function used. method “bm”,“obm”,“bartlett”, “tukey”. “bm” represents batch means estimator, “obm” represents overlapping batch means estimator , “bartlett” “tukey” represents modified-Bartlett window Tukey-Hanning windows spectral variance estimators. r lugsail parameters (r) converts lag window lugsail equivalent. Larger values r typically imply less underestimation “cov”, higher variability estimator. Default r = 3 r = 1,2 also good choices although may lead underestimates variance. r > 5 recommended. data_scale logical; show Monte Carlo error sample transformed back scale data (TRUE) sampling scale (requires argument keep_scaled_mcmc = TRUE set fitting model) plotpars optional; list parameters passed plot() ablinepars optional; list parameters passed abline() minlength number characters variable names abbreviated ","code":""},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate and plot the Monte Carlo error — MC_error","text":"object class MCElist elements unscaled, scaled digits. first two matrices columns est (posterior mean), MCSE (Monte Carlo error), SD (posterior standard deviation) MCSE/SD (Monte Carlo error divided post. standard deviation.)","code":""},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Calculate and plot the Monte Carlo error — MC_error","text":"plot(MCElist): plot Monte Carlo error","code":""},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Calculate and plot the Monte Carlo error — MC_error","text":"Lesaffre & Lawson (2012; p. 195) suggest Monte Carlo error parameter 5% posterior standard deviation parameter (.e., \\(MCSE/SD \\le 0.05\\)). Long variable names: default plot margins may wide enough variable names longer characters. plot margin can adjusted (globally) using argument \"mar\" par.","code":""},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate and plot the Monte Carlo error — MC_error","text":"Lesaffre, E., & Lawson, . B. (2012). Bayesian Biostatistics. John Wiley & Sons.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/MC_error.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate and plot the Monte Carlo error — MC_error","text":"","code":"if (FALSE) { # \\dontrun{  mod <- lm_imp(y ~ C1 + C2 + M2, data = wideDF, n.iter = 100)  MC_error(mod)  plot(MC_error(mod), ablinepars = list(lty = 2),      plotpars = list(pch = 19, col = 'blue')) } # }"},{"path":"https://nerler.github.io/JointAI/reference/NHANES.html","id":null,"dir":"Reference","previous_headings":"","what":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","title":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","text":"data small subset data collected within 2011-2012 wave NHANES study, study designed assess health nutritional status adults children United States, conduced National Center Health Statistics.","code":""},{"path":"https://nerler.github.io/JointAI/reference/NHANES.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","text":"","code":"data(NHANES)"},{"path":"https://nerler.github.io/JointAI/reference/NHANES.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","text":"data frame 186 rows 13 variables: SBP systolic blood pressure gender male female age years race race / Hispanic origin (5 categories) WC waist circumference cm alc alcohol consumption (binary: <1 drink per week vs. >= 1 drink per week) educ educational level (binary: low vs. high) creat creatinine concentration mg/dL albu albumin concentration g/dL uricacid uric acid concentration mg/dL bili bilirubin concentration mg/dL occup occupational status (3 categories) smoke smoking status (3 ordered categories)","code":""},{"path":"https://nerler.github.io/JointAI/reference/NHANES.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","text":"National Center Health Statistics (NCHS) (2011 - 2012). National Health Nutrition Examination Survey Data. URL https://www.cdc.gov/nchs/nhanes/.","code":""},{"path":"https://nerler.github.io/JointAI/reference/NHANES.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","text":"subset provided selected re-coded facilitate demonstration functionality JointAI package, clinical conclusions derived .","code":""},{"path":"https://nerler.github.io/JointAI/reference/NHANES.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"National Health and Nutrition Examination Survey (NHANES) Data — NHANES","text":"","code":"summary(NHANES) #>       SBP           gender         age                        race    #>  Min.   : 86.0   male  :100   Min.   :20.00   Mexican American  :28   #>  1st Qu.:109.3   female: 86   1st Qu.:32.00   Other Hispanic    :10   #>  Median :116.7                Median :42.00   Non-Hispanic White:73   #>  Mean   :119.3                Mean   :43.51   Non-Hispanic Black:32   #>  3rd Qu.:127.2                3rd Qu.:55.75   other             :43   #>  Max.   :177.3                Max.   :78.00                           #>                                                                       #>        WC           alc       educ         creat             albu       #>  Min.   : 64.80   <1  :94   low : 70   Min.   :0.4700   Min.   :3.500   #>  1st Qu.: 82.92   >=1 :58   high:116   1st Qu.:0.7200   1st Qu.:4.100   #>  Median : 93.85   NA's:34              Median :0.8300   Median :4.350   #>  Mean   : 95.00                        Mean   :0.8438   Mean   :4.346   #>  3rd Qu.:104.20                        3rd Qu.:0.9575   3rd Qu.:4.500   #>  Max.   :135.80                        Max.   :1.3800   Max.   :5.200   #>  NA's   :2                             NA's   :8        NA's   :8       #>     uricacid          bili                     occup        smoke     #>  Min.   :2.500   Min.   :0.3000   working         :98   never  :107   #>  1st Qu.:4.500   1st Qu.:0.6000   looking for work: 5   former : 36   #>  Median :5.400   Median :0.7000   not working     :55   current: 36   #>  Mean   :5.353   Mean   :0.7208   NA's            :28   NA's   :  7   #>  3rd Qu.:6.100   3rd Qu.:0.8000                                       #>  Max.   :8.800   Max.   :1.4000                                       #>  NA's   :8       NA's   :8"},{"path":"https://nerler.github.io/JointAI/reference/PBC.html","id":null,"dir":"Reference","previous_headings":"","what":"PBC data — PBC","title":"PBC data — PBC","text":"Data Mayo Clinic trial primary biliary cirrhosis (PBC) liver. dataset obtained survival package: variables copper trig survival::pbc merged survival::pbcseq several categorical variables re-coded.","code":""},{"path":"https://nerler.github.io/JointAI/reference/PBC.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"PBC data — PBC","text":"PBC: data frame 312 individuals long format 1945 rows 21 variables.","code":""},{"path":"https://nerler.github.io/JointAI/reference/PBC.html","id":"survival-outcome-and-id","dir":"Reference","previous_headings":"","what":"Survival outcome and id","title":"PBC data — PBC","text":"id case number futime number days registration earlier death, transplantation, end follow-status status endpoint (\"censored\", \"transplant\" \"dead\")","code":""},{"path":"https://nerler.github.io/JointAI/reference/PBC.html","id":"baseline-covariates","dir":"Reference","previous_headings":"","what":"Baseline covariates","title":"PBC data — PBC","text":"trt D-pen (D-penicillamine) vs  placebo age years sex male female copper urine copper (\\(\\mu\\)g/day) trig triglycerides (mg/dl)","code":""},{"path":"https://nerler.github.io/JointAI/reference/PBC.html","id":"time-varying-covariates","dir":"Reference","previous_headings":"","what":"Time-varying covariates","title":"PBC data — PBC","text":"day number days enrolment visit date; measurements refer date albumin serum albumin (mg/dl) alk.phos alkaline phosphatase (U/liter) ascites presence ascites ast aspartate aminotransferase (U/ml) bili serum bilirubin (mg/dl) chol serum cholesterol (mg/dl) edema \"\": oedema, \"(un)treated\": untreated successfully treated 1 oedema, \"edema\": oedema despite diuretic therapy hepato presence hepatomegaly (enlarged liver) platelet platelet count protime standardised blood clotting time spiders blood vessel malformations skin stage histologic stage disease (4 levels)","code":""},{"path":"https://nerler.github.io/JointAI/reference/PBC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PBC data — PBC","text":"","code":"summary(PBC) #>        id            futime            status          trt           age        #>  Min.   :  1.0   Min.   :  41   censored  :1073   D-pen  :967   Min.   :26.28   #>  1st Qu.: 61.0   1st Qu.:2055   transplant: 147   placebo:978   1st Qu.:41.79   #>  Median :126.0   Median :2963   dead      : 725                 Median :48.87   #>  Mean   :135.4   Mean   :2941                                   Mean   :49.26   #>  3rd Qu.:203.0   3rd Qu.:3819                                   3rd Qu.:56.15   #>  Max.   :312.0   Max.   :5225                                   Max.   :78.44   #>                                                                                 #>      sex            day       ascites      hepato    spiders     #>  male  : 237   Min.   :   0   no  :1716   no  :952   no  :1311   #>  female:1708   1st Qu.: 192   yes : 169   yes :932   yes : 576   #>                Median : 750   NA's:  60   NA's: 61   NA's:  58   #>                Mean   :1145                                      #>                3rd Qu.:1838                                      #>                Max.   :5152                                      #>                                                                  #>          edema           bili             chol           albumin     #>  no         :1401   Min.   : 0.100   Min.   :  55.0   Min.   :1.17   #>  (un)treated: 379   1st Qu.: 0.800   1st Qu.: 235.0   1st Qu.:3.11   #>  edema      : 165   Median : 1.400   Median : 281.0   Median :3.44   #>                     Mean   : 3.672   Mean   : 320.5   Mean   :3.39   #>                     3rd Qu.: 3.900   3rd Qu.: 349.2   3rd Qu.:3.70   #>                     Max.   :41.000   Max.   :1775.0   Max.   :8.01   #>                                      NA's   :821                     #>     alk.phos          ast            platelet        protime     stage   #>  Min.   :   73   Min.   :   6.2   Min.   : 40.0   Min.   : 9.0   1: 95   #>  1st Qu.:  737   1st Qu.:  72.0   1st Qu.:165.0   1st Qu.:10.1   2:266   #>  Median : 1072   Median : 107.0   Median :228.0   Median :10.8   3:612   #>  Mean   : 1382   Mean   : 122.7   Mean   :233.7   Mean   :11.0   4:972   #>  3rd Qu.: 1636   3rd Qu.: 155.0   3rd Qu.:290.2   3rd Qu.:11.5           #>  Max.   :13862   Max.   :1205.0   Max.   :991.0   Max.   :36.0           #>  NA's   :60                       NA's   :73                             #>      copper            trig     #>  Min.   :  4.00   Min.   : 33   #>  1st Qu.: 38.00   1st Qu.: 83   #>  Median : 65.00   Median :105   #>  Mean   : 84.54   Mean   :122   #>  3rd Qu.:105.00   3rd Qu.:151   #>  Max.   :588.00   Max.   :598   #>  NA's   :8        NA's   :206"},{"path":"https://nerler.github.io/JointAI/reference/Surv.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Survival Object — Surv","title":"Create a Survival Object — Surv","text":"function just calls Surv() survival package.","code":""},{"path":"https://nerler.github.io/JointAI/reference/Surv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Survival Object — Surv","text":"","code":"Surv(time, time2, event, type = c(\"right\", \"left\", \"interval\", \"counting\",   \"interval2\"), origin = 0)"},{"path":"https://nerler.github.io/JointAI/reference/Surv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Survival Object — Surv","text":"time right censored data, follow time.  interval     data, first argument starting time interval. time2 ending time interval interval censored  counting     process data .  Intervals assumed open left     closed right, (start, end].  counting process     data, event indicates whether transtion another state     occurred end interval. event status indicator, normally 0=alive, 1=dead.  choices     TRUE/FALSE (TRUE = death), 1/2 (2=death),     factor variable.     interval censored data, status indicator 0=right censoed,     1=event time, 2=left censored, 3=interval censored.     multiple endpoint data event variable always factor,     whose first level treated censoring, formally     \"transtition time point\".     constraint labels factor.     Although unusual, event indicator can omitted, case     subjects assumed event. type character string specifying type censoring. Possible values     \"right\", \"left\", \"counting\",     \"interval\", \"interval2\".  default multi-state     event factor, counting process time2     present, right censored, order. origin counting process data, hazard function origin.  option     intended used conjunction model containing     time dependent     strata order align subjects properly cross     one strata another, rarely proven useful     depricated.","code":""},{"path":"https://nerler.github.io/JointAI/reference/add_linebreaks.html","id":null,"dir":"Reference","previous_headings":"","what":"Add line breaks to a linear predictor string — add_linebreaks","title":"Add line breaks to a linear predictor string — add_linebreaks","text":"Adds line breaks string, breaking \"+\" sign exceed given width characters taking account indentation.","code":""},{"path":"https://nerler.github.io/JointAI/reference/add_linebreaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add line breaks to a linear predictor string — add_linebreaks","text":"","code":"add_linebreaks(string, indent, width = 90L)"},{"path":"https://nerler.github.io/JointAI/reference/add_linebreaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add line breaks to a linear predictor string — add_linebreaks","text":"string character string (linear predictor) indent integer; number characters new line indented width integer; maximum number characters per line","code":""},{"path":"https://nerler.github.io/JointAI/reference/add_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Continue sampling from an object of class JointAI — add_samples","title":"Continue sampling from an object of class JointAI — add_samples","text":"function continues sampling MCMC chains existing object class 'JointAI'.","code":""},{"path":"https://nerler.github.io/JointAI/reference/add_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continue sampling from an object of class JointAI — add_samples","text":"","code":"add_samples(object, n.iter, add = TRUE, thin = NULL,   monitor_params = NULL, progress.bar = \"text\", mess = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/add_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continue sampling from an object of class JointAI — add_samples","text":"object object inheriting class 'JointAI' n.iter number additional iterations MCMC chain add logical; new MCMC samples added existing samples (TRUE; default) replace ? samples added arguments monitor_params thin ignored. thin thinning interval (see window.mcmc); ignored add = TRUE. monitor_params named list vector specifying parameters monitored. details, see *_imp vignette Parameter Selection. Ignored add = TRUE. progress.bar character string specifying type progress bar. Possible values \"text\" (default), \"gui\", \"none\" (see update). Note: sampling performed parallel possible display progress bar. mess logical; messages given? Default TRUE.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/add_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Continue sampling from an object of class JointAI — add_samples","text":"","code":"# Example 1: # Run an initial JointAI model: mod <- lm_imp(y ~ C1 + C2, data = wideDF, n.iter = 100)  # Continue sampling: mod_add <- add_samples(mod, n.iter = 200, add = TRUE)   # Example 2: # Continue sampling, but additionally sample imputed values. # Note: Setting different parameters to monitor than in the original model # requires add = FALSE. imps <- add_samples(mod, n.iter = 200, monitor_params = c(\"imps\" = TRUE),                     add = FALSE)"},{"path":"https://nerler.github.io/JointAI/reference/all_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract names of variables from several objects — all_vars","title":"Extract names of variables from several objects — all_vars","text":"Version .vars() can handle formulas, lists formulas character strings.","code":""},{"path":"https://nerler.github.io/JointAI/reference/all_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract names of variables from several objects — all_vars","text":"","code":"all_vars(...)"},{"path":"https://nerler.github.io/JointAI/reference/all_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract names of variables from several objects — all_vars","text":"... formula objects, lists formulas character strings valid variable names (sense make.vars())","code":""},{"path":"https://nerler.github.io/JointAI/reference/auto_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Autocorrelation of MCMC samples — auto_corr","title":"Autocorrelation of MCMC samples — auto_corr","text":"function obtains autocorrelation MCMC samples JointAI object via coda::autocorr.diag(). autocorr_plot() visualizes results using ggplot2.","code":""},{"path":"https://nerler.github.io/JointAI/reference/auto_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autocorrelation of MCMC samples — auto_corr","text":"","code":"auto_corr(object, lags = 0:30, by_chain = TRUE, outcome = 1L,   start = NULL, end = NULL, thin = NULL)  auto_corr_plot(object, lags = 0:30, by_chain = TRUE, outcome = 1L,   start = NULL, end = NULL, thin = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/auto_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autocorrelation of MCMC samples — auto_corr","text":"object object class JointAI lags numeric vector indicating lags consider by_chain logical; autocorrelation computed chain separately? outcome integer; index outcome model autocorrelation plotted start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration.","code":""},{"path":"https://nerler.github.io/JointAI/reference/auto_corr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autocorrelation of MCMC samples — auto_corr","text":"matrix list matrix objects by_chain = TRUE, ggplot() object autocorr_plot().","code":""},{"path":"https://nerler.github.io/JointAI/reference/auto_corr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autocorrelation of MCMC samples — auto_corr","text":"","code":"fit <- lm_imp(y ~ C1 + C2 + B2, data = wideDF, n.iter = 200) auto_corr(fit) #> [[1]] #>        (Intercept)           C1            C2          B21      sigma_y #> Lag 0   1.00000000  1.000000000  1.000000e+00  1.000000000  1.000000000 #> Lag 1   0.05755243  0.050820294  3.756552e-02  0.226834297 -0.006804047 #> Lag 2  -0.02025947 -0.031472084 -7.897606e-02 -0.037219861  0.028898605 #> Lag 3   0.04804338  0.045738380  5.589996e-02 -0.063739573  0.072417278 #> Lag 4   0.13391859  0.137270186 -7.255127e-03  0.005919024  0.013201160 #> Lag 5   0.04303189  0.044911218 -4.206872e-02  0.043508105  0.006212061 #> Lag 6  -0.03546460 -0.033305227 -7.217218e-02 -0.064403392 -0.003317680 #> Lag 7  -0.11019494 -0.106028952 -2.926658e-02 -0.044129385 -0.049512304 #> Lag 8  -0.05202430 -0.048203968 -3.277551e-02 -0.070206398  0.038439710 #> Lag 9  -0.08466595 -0.083732236 -3.269115e-02 -0.033338521 -0.010223730 #> Lag 10  0.03873113  0.041721698  9.698288e-02  0.081953314  0.024691163 #> Lag 11  0.06043596  0.060387399 -6.540813e-02 -0.059040466  0.071502994 #> Lag 12 -0.12034562 -0.113780861 -4.304709e-02 -0.062217045 -0.094471533 #> Lag 13 -0.03713618 -0.036543367 -3.863756e-02 -0.049006428  0.113580588 #> Lag 14 -0.08402861 -0.081613148  5.066313e-04 -0.001572557  0.045040696 #> Lag 15  0.00150724  0.004426657 -5.308215e-02 -0.030047407 -0.032101961 #> Lag 16 -0.08603353 -0.077321989 -1.021146e-01 -0.039753223  0.067147183 #> Lag 17 -0.09004598 -0.088340813  3.930568e-02 -0.030005032  0.060990848 #> Lag 18 -0.12480277 -0.122612278 -5.915694e-03  0.002793837 -0.067920521 #> Lag 19 -0.06109688 -0.057573708 -4.060788e-02  0.060642620 -0.026355059 #> Lag 20 -0.01387767 -0.014552167 -4.792409e-02 -0.024249734 -0.092519525 #> Lag 21  0.03206049  0.026913994 -9.671087e-02  0.045969622  0.041059490 #> Lag 22 -0.07788495 -0.075653586  3.488143e-03  0.044988649 -0.027453810 #> Lag 23 -0.01594933 -0.017807495 -2.679172e-02 -0.013149375  0.002295111 #> Lag 24  0.01337430  0.007584237 -7.128519e-02  0.031047628  0.043560720 #> Lag 25 -0.03027483 -0.034607201  7.031406e-02 -0.055863602 -0.003201316 #> Lag 26  0.07212163  0.069201551 -4.945389e-02 -0.013574070 -0.021524005 #> Lag 27 -0.02946073 -0.030928610 -6.635837e-03 -0.008811811 -0.016754856 #> Lag 28  0.01559392  0.012577269  5.552863e-02  0.061498865  0.034515667 #> Lag 29 -0.04962813 -0.043441962  7.674072e-05  0.081582188 -0.090326106 #> Lag 30 -0.03730159 -0.037237996  8.036176e-02 -0.037304549  0.012539161 #>  #> [[2]] #>         (Intercept)           C1           C2          B21       sigma_y #> Lag 0   1.000000000  1.000000000  1.000000000  1.000000000  1.0000000000 #> Lag 1  -0.019740098 -0.012427058  0.029908697  0.194658863 -0.0227375791 #> Lag 2   0.120446675  0.120355409  0.005894786  0.068727911  0.1080124856 #> Lag 3   0.015484332  0.011077442  0.067756372  0.104583718  0.0391141910 #> Lag 4   0.050779941  0.049558679  0.025635370  0.004425067  0.0757994246 #> Lag 5   0.046971797  0.040778515  0.088464925  0.072673538  0.0461585973 #> Lag 6   0.033889110  0.033782123 -0.001118678 -0.015644120  0.0992883665 #> Lag 7   0.069657496  0.063456016  0.004163519 -0.007789816 -0.0066858580 #> Lag 8   0.023871684  0.023503264 -0.015363696  0.011346772  0.0412523420 #> Lag 9   0.077937604  0.081467060 -0.093501091  0.069663200  0.0502151890 #> Lag 10  0.096610141  0.098926853 -0.018128884  0.035308599  0.0270826554 #> Lag 11 -0.049438086 -0.043739604 -0.030781362  0.043501614 -0.0756562609 #> Lag 12  0.013543088  0.012666030 -0.184421584  0.134024058 -0.0388223542 #> Lag 13  0.070734468  0.076302128 -0.152341651  0.150256079  0.0085753022 #> Lag 14  0.030438410  0.036946811 -0.070972586  0.011843349 -0.0609383839 #> Lag 15 -0.061066182 -0.061536944 -0.092904907 -0.010738658  0.0094905168 #> Lag 16  0.038952291  0.040858942 -0.037258645 -0.021922086  0.0142656290 #> Lag 17 -0.013278761 -0.012817618 -0.099805235 -0.002264757  0.0189245330 #> Lag 18 -0.057440248 -0.059607911  0.058275130 -0.072827651  0.0087218004 #> Lag 19 -0.050456749 -0.049307247  0.081596420 -0.007550529  0.1010834464 #> Lag 20 -0.058525036 -0.062518588  0.044965910 -0.023699934  0.0005149525 #> Lag 21  0.020002549  0.014163732  0.016601316  0.001172543  0.1031723032 #> Lag 22 -0.043579256 -0.044749998  0.083146226  0.090169425  0.0704046269 #> Lag 23  0.006611782  0.005196749  0.076302815  0.058834623  0.0434546826 #> Lag 24  0.054127201  0.054424835  0.029765680  0.025267514 -0.1127090513 #> Lag 25  0.001586515  0.006796942 -0.049072204  0.040707816  0.0105356222 #> Lag 26  0.119628250  0.126573460  0.180196010  0.023770904 -0.0036814032 #> Lag 27 -0.091906843 -0.089342152  0.091027469  0.063048842  0.0714664899 #> Lag 28 -0.078619534 -0.080418165 -0.097399072  0.001558722 -0.0044720652 #> Lag 29 -0.089930859 -0.093515980  0.156171076 -0.017805517  0.0375294418 #> Lag 30  0.024191015  0.019995536 -0.004348521  0.020504248  0.0849211096 #>  #> [[3]] #>         (Intercept)           C1           C2          B21      sigma_y #> Lag 0   1.000000000  1.000000000  1.000000000  1.000000000  1.000000000 #> Lag 1   0.061254841  0.057837132 -0.018666598  0.116164650 -0.049627035 #> Lag 2  -0.056231842 -0.056056556 -0.073815566  0.047997554 -0.006715518 #> Lag 3  -0.015855310 -0.015386718  0.009664979 -0.053985023 -0.159093759 #> Lag 4   0.109451383  0.110139430  0.035799412 -0.026400646 -0.067344787 #> Lag 5  -0.123681285 -0.125211501  0.087787224  0.027382750  0.034552446 #> Lag 6  -0.112610097 -0.114205618  0.029256412 -0.065741126 -0.027669903 #> Lag 7  -0.102518915 -0.096553543  0.046353978 -0.056190421 -0.067884265 #> Lag 8  -0.062662799 -0.061499989 -0.047664559 -0.015162182 -0.003526558 #> Lag 9  -0.131154688 -0.133424942 -0.098793837 -0.048103016 -0.077515914 #> Lag 10 -0.052926385 -0.053095842  0.012814802  0.126554315  0.102645130 #> Lag 11 -0.045841883 -0.045668775 -0.047254390 -0.004212952  0.045371072 #> Lag 12 -0.065826085 -0.058330927  0.022240060 -0.123937624 -0.086051074 #> Lag 13 -0.033080676 -0.033347252 -0.073948896 -0.120303064 -0.003293376 #> Lag 14 -0.004043234 -0.002561476 -0.083568924 -0.003101728 -0.018221753 #> Lag 15  0.027369115  0.024958992  0.056629828  0.025934254  0.017255194 #> Lag 16 -0.077137280 -0.083738157  0.017104458 -0.129389406 -0.027770439 #> Lag 17  0.072785850  0.075355725  0.076242904 -0.067630426  0.040417704 #> Lag 18 -0.014157127 -0.009230301  0.130929099 -0.037571371 -0.011498258 #> Lag 19  0.022338407  0.020788950 -0.056713903  0.076101027  0.008801872 #> Lag 20  0.073026369  0.073534647 -0.008546205  0.040737288 -0.091368130 #> Lag 21  0.195815029  0.195318151 -0.061553732 -0.041475736  0.112088186 #> Lag 22  0.043752046  0.041745514  0.089733633 -0.074527315  0.046467398 #> Lag 23 -0.008627478 -0.009897513  0.090674849 -0.139901114 -0.001404039 #> Lag 24  0.056270440  0.051996140 -0.131969575 -0.006068668  0.080450720 #> Lag 25  0.052522688  0.056646989  0.018875623  0.013062035  0.076051545 #> Lag 26 -0.186726469 -0.190552343  0.007247816 -0.137628238 -0.047863208 #> Lag 27 -0.092789381 -0.093945907 -0.012607898  0.066118231  0.031869286 #> Lag 28 -0.006418210 -0.006833088 -0.003506696 -0.019798683 -0.100755111 #> Lag 29  0.013879174  0.015987949  0.018394497  0.102542372  0.022093499 #> Lag 30 -0.084100267 -0.085696728  0.070975061  0.079915840  0.002033005 #>  auto_corr_plot(fit)"},{"path":"https://nerler.github.io/JointAI/reference/bs.html","id":null,"dir":"Reference","previous_headings":"","what":"B-Spline Basis for Polynomial Splines — bs","title":"B-Spline Basis for Polynomial Splines — bs","text":"function just calls bs() splines package.","code":""},{"path":"https://nerler.github.io/JointAI/reference/bs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"B-Spline Basis for Polynomial Splines — bs","text":"","code":"bs(x, df = NULL, knots = NULL, degree = 3, intercept = FALSE,   Boundary.knots = range(x), warn.outside = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/bs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"B-Spline Basis for Polynomial Splines — bs","text":"x predictor variable.  Missing values allowed. df degrees freedom; one can specify df rather     knots; bs() chooses df-degree (minus one     intercept) knots suitable quantiles x     (ignore missing values).  default, NULL,     takes number inner knots length(knots).      zero per default, corresponds df = degree - intercept. knots internal breakpoints define     spline.  default NULL, results basis     ordinary polynomial regression.  Typical values mean     median one knot, quantiles knots.  See also     Boundary.knots. degree degree piecewise polynomial—default 3     cubic splines. intercept TRUE, intercept included     basis; default FALSE. Boundary.knots boundary points anchor B-spline     basis (default range non-NA data).      knots Boundary.knots supplied, basis     parameters depend x.  Data can extend beyond     Boundary.knots. warn.outside logical indicating     warning signalled case x values     outside boundary knots.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_classes.html","id":null,"dir":"Reference","previous_headings":"","what":"Check classes of all variables used in the model — check_classes","title":"Check classes of all variables used in the model — check_classes","text":"Runs check variables used model known class (numeric, ordered, factor, logical, integer) type-appropriate models can specified. Note: function check type grouping variables, may character strings.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_classes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check classes of all variables used in the model — check_classes","text":"","code":"check_classes(data, fixed = NULL, random = NULL, auxvars = NULL,   timevar = NULL, mess = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/check_classes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check classes of all variables used in the model — check_classes","text":"data data.frame fixed formula random formula auxvars one-sided formula timevar character string (name time variable, used joint models) mess logical, TRUE messages printed","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_classes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check classes of all variables used in the model — check_classes","text":"nothing, throws error variable unknown class","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_classes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check classes of all variables used in the model — check_classes","text":"used model_imp (2020-06-09)","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Run all data related checks — check_data","title":"Run all data related checks — check_data","text":"Wrapper function check used variables present data classes variables type default model types defined checks empty variable levels converts binary continuous variables logical variables factors","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run all data related checks — check_data","text":"","code":"check_data(data, fixed, random, auxvars, timevar, mess, warn)"},{"path":"https://nerler.github.io/JointAI/reference/check_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run all data related checks — check_data","text":"data data.frame fixed formula (list formulas) random one-sided formula (list one-sided formulas) auxvars one-sided formula timevar character string (name time variable, used joint models) mess logical, TRUE messages printed warn logical, TRUE warnings printed","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run all data related checks — check_data","text":"cleaned data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run all data related checks — check_data","text":"used model_imp() (2025-09-04)","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_duplicate_groupings.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for duplicate grouping levels — check_duplicate_groupings","title":"Check for duplicate grouping levels — check_duplicate_groupings","text":"Used within get_groups().","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_duplicate_groupings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for duplicate grouping levels — check_duplicate_groupings","text":"","code":"check_duplicate_groupings(groups)"},{"path":"https://nerler.github.io/JointAI/reference/check_duplicate_groupings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for duplicate grouping levels — check_duplicate_groupings","text":"groups list integer \"id\" variables","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_duplicate_groupings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for duplicate grouping levels — check_duplicate_groupings","text":"NULL; throws error duplicate grouping levels found","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_fixed_random.html","id":null,"dir":"Reference","previous_headings":"","what":"Check whether fixed or formula contains a random effects specification — check_fixed_random","title":"Check whether fixed or formula contains a random effects specification — check_fixed_random","text":"Checks objects provided formula fixed arguments contain random effects specification. function used random effects models. case combined fixed random effects formula part fixed element, moved formula element.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_fixed_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check whether fixed or formula contains a random effects specification — check_fixed_random","text":"","code":"check_fixed_random(arglist)"},{"path":"https://nerler.github.io/JointAI/reference/check_fixed_random.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check whether fixed or formula contains a random effects specification — check_fixed_random","text":"arglist list containing 'fixed', 'random', 'formula' elements.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_fixed_random.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check whether fixed or formula contains a random effects specification — check_fixed_random","text":"updated arglist.arglist","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_formula_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure object is a (list of) formula(s) — check_formula_list","title":"Ensure object is a (list of) formula(s) — check_formula_list","text":"Check object NULL, formula, list formulas (optionally) convert list formulas. input unknown type list entries neither formula NULL, error thrown.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_formula_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure object is a (list of) formula(s) — check_formula_list","text":"","code":"check_formula_list(formula, convert = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/check_formula_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ensure object is a (list of) formula(s) — check_formula_list","text":"formula object expected either formula, list formulas, NULL. convert Logical; TRUE, single formula wrapped list.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_formula_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ensure object is a (list of) formula(s) — check_formula_list","text":"named list formula (/NULL) objects, NULL. convert FALSE, single formula returned -.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_formula_list.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ensure object is a (list of) formula(s) — check_formula_list","text":"Internal function; used many help functions, get_refs, *_imp, predict (2022-02-05)","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_full_blockdiag.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace a full with a block-diagonal variance covariance matrix — check_full_blockdiag","title":"Replace a full with a block-diagonal variance covariance matrix — check_full_blockdiag","text":"Check full random effects variance covariance matrix specified single variable. case, identical block-diagonal matrix. Change rd_vcov specification blockdiag clarity (variable name used name b, D, invD, ...)","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_full_blockdiag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace a full with a block-diagonal variance covariance matrix — check_full_blockdiag","text":"","code":"check_full_blockdiag(rd_vcov)"},{"path":"https://nerler.github.io/JointAI/reference/check_full_blockdiag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace a full with a block-diagonal variance covariance matrix — check_full_blockdiag","text":"rd_vcov valid random effects variance-covariance structure specification (.e., checked using expand_rd_vcov_full())","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_full_blockdiag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace a full with a block-diagonal variance covariance matrix — check_full_blockdiag","text":"valid random effects variance-covariance structure specification","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_groups_vary_within_lvl.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if a grouping variable varies within another grouping variable — check_groups_vary_within_lvl","title":"Check if a grouping variable varies within another grouping variable — check_groups_vary_within_lvl","text":"Check grouping variable varies within another grouping variable","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_groups_vary_within_lvl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if a grouping variable varies within another grouping variable — check_groups_vary_within_lvl","text":"","code":"check_groups_vary_within_lvl(lvl, grouping_df)"},{"path":"https://nerler.github.io/JointAI/reference/check_groups_vary_within_lvl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if a grouping variable varies within another grouping variable — check_groups_vary_within_lvl","text":"lvl vector defining grouping level grouping_df data.frame column contains grouping indices hierarchical level (obtained get_groups(...))","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_groups_vary_within_lvl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if a grouping variable varies within another grouping variable — check_groups_vary_within_lvl","text":"named logical vector indicating grouping variable (column grouping_df) whether varies within grouping defined lvl","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_na_groupings.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for missing values in grouping variables — check_na_groupings","title":"Check for missing values in grouping variables — check_na_groupings","text":"Checks grouping variable contains missing values (NA NaN) throws error . Used within get_groups().","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_na_groupings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for missing values in grouping variables — check_na_groupings","text":"","code":"check_na_groupings(groups)"},{"path":"https://nerler.github.io/JointAI/reference/check_na_groupings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for missing values in grouping variables — check_na_groupings","text":"groups list integer \"id\" variables","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_na_groupings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for missing values in grouping variables — check_na_groupings","text":"NULL; throws error missing values found grouping variable","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Check / create the random effects variance-covariance matrix specification — check_rd_vcov","title":"Check / create the random effects variance-covariance matrix specification — check_rd_vcov","text":"Check / create random effects variance-covariance matrix specification","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check / create the random effects variance-covariance matrix specification — check_rd_vcov","text":"","code":"check_rd_vcov(rd_vcov, nranef)"},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check / create the random effects variance-covariance matrix specification — check_rd_vcov","text":"rd_vcov variance covariance specification provided user nranef list level named vectors number random effects per variable (obtained get_nranef())","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov_list.html","id":null,"dir":"Reference","previous_headings":"","what":"First validation for rd_vcov — check_rd_vcov_list","title":"First validation for rd_vcov — check_rd_vcov_list","text":"Checks rd_vcov list elements grouping levels specify grouping level. valid, function also make sure rd_vcov list per grouping level duplicating contents necessary.","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"First validation for rd_vcov — check_rd_vcov_list","text":"","code":"check_rd_vcov_list(rd_vcov, idvar)"},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"First validation for rd_vcov — check_rd_vcov_list","text":"rd_vcov character string list describing random effects variance covariance structure (provided user) idvar vector names grouping variables (except \"lvlone\")","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_rd_vcov_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"First validation for rd_vcov — check_rd_vcov_list","text":"named list per grouping level elements contains information random effects variance-covariance matrices level structured. Per level can either character string (e.g. \"full\") list specifying structures per (groups) variable(s) (e.g. list(full = c(\"\", \"b\"), indep = \"c\"))","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_redundant_lvls.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for unnecessary grouping levels — check_redundant_lvls","title":"Check for unnecessary grouping levels — check_redundant_lvls","text":"Used within get_groups().","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_redundant_lvls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for unnecessary grouping levels — check_redundant_lvls","text":"","code":"check_redundant_lvls(groups, nrow_data)"},{"path":"https://nerler.github.io/JointAI/reference/check_redundant_lvls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for unnecessary grouping levels — check_redundant_lvls","text":"groups list integer \"id\" variables","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_redundant_lvls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for unnecessary grouping levels — check_redundant_lvls","text":"NULL; throws error unnecessary grouping levels found","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_vars_in_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that all variables in formulas are in the data — check_vars_in_data","title":"Check that all variables in formulas are in the data — check_vars_in_data","text":"Check variables formulas data","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_vars_in_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that all variables in formulas are in the data — check_vars_in_data","text":"","code":"check_vars_in_data(datanames, fixed = NULL, random = NULL,   auxvars = NULL, timevar = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/check_vars_in_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that all variables in formulas are in the data — check_vars_in_data","text":"datanames character vector (variable names data) fixed fixed effects formula (list formulas) random random effects formula (list formulas) auxvars one-sided formula auxiliary variables timevar character string (name time variable, used joint models)","code":""},{"path":"https://nerler.github.io/JointAI/reference/check_vars_in_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that all variables in formulas are in the data — check_vars_in_data","text":"nothing, throws error variable missing","code":""},{"path":"https://nerler.github.io/JointAI/reference/choose_default_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Choose default analysis model based on outcome and data level — choose_default_model","title":"Choose default analysis model based on outcome and data level — choose_default_model","text":"Choose default analysis model based outcome data level","code":""},{"path":"https://nerler.github.io/JointAI/reference/choose_default_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Choose default analysis model based on outcome and data level — choose_default_model","text":"","code":"choose_default_model(outcome, lvl, max_lvl)"},{"path":"https://nerler.github.io/JointAI/reference/choose_default_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Choose default analysis model based on outcome and data level — choose_default_model","text":"outcome outcome variable lvl hierarchical level outcome variable max_lvl maximum hierarchical level data","code":""},{"path":"https://nerler.github.io/JointAI/reference/choose_default_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Choose default analysis model based on outcome and data level — choose_default_model","text":"character string giving default model type","code":""},{"path":"https://nerler.github.io/JointAI/reference/clean_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace ","title":"Replace ","text":"Cleans factor levels (strings) replacing \":\" \"_\" avoid issues current implementation identifying interactions (looks \":\" model terms).","code":""},{"path":"https://nerler.github.io/JointAI/reference/clean_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace ","text":"","code":"clean_names(string)"},{"path":"https://nerler.github.io/JointAI/reference/clean_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace ","text":"string character string","code":""},{"path":"https://nerler.github.io/JointAI/reference/clean_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace ","text":"cleaned character string","code":""},{"path":"https://nerler.github.io/JointAI/reference/clean_names.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Replace ","text":"used file (convert_variables()) (2020-06-09)","code":""},{"path":"https://nerler.github.io/JointAI/reference/clean_survname.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a survival outcome to a model name — clean_survname","title":"Convert a survival outcome to a model name — clean_survname","text":"helper function converts \"name survival model\" (\"Surv(time, status)\" specification) valid variable name can used JAGS model syntax.","code":""},{"path":"https://nerler.github.io/JointAI/reference/clean_survname.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a survival outcome to a model name — clean_survname","text":"","code":"clean_survname(x)"},{"path":"https://nerler.github.io/JointAI/reference/clean_survname.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a survival outcome to a model name — clean_survname","text":"x character string vector character strings","code":""},{"path":"https://nerler.github.io/JointAI/reference/combine_formula_lists.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine fixed and random effects formulas — combine_formula_lists","title":"Combine fixed and random effects formulas — combine_formula_lists","text":"function combine nlme-style fixed random effects formulas lme4 style formulas.","code":""},{"path":"https://nerler.github.io/JointAI/reference/combine_formula_lists.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine fixed and random effects formulas — combine_formula_lists","text":"","code":"combine_formula_lists(fixed, random, warn = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/combine_formula_lists.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine fixed and random effects formulas — combine_formula_lists","text":"fixed fixed effects formula list formulas random random effects formula (RHS) list formulas warn logical; warning(s) printed","code":""},{"path":"https://nerler.github.io/JointAI/reference/combine_formula_lists.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combine fixed and random effects formulas — combine_formula_lists","text":"Internal function. Lists formulas can named unnamed. Uses combine_formulas().","code":""},{"path":"https://nerler.github.io/JointAI/reference/combine_formulas.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine a fixed and random effects formula — combine_formulas","title":"Combine a fixed and random effects formula — combine_formulas","text":"Combine single fixed random effects formula pasting together.","code":""},{"path":"https://nerler.github.io/JointAI/reference/combine_formulas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine a fixed and random effects formula — combine_formulas","text":"","code":"combine_formulas(fixed, random)"},{"path":"https://nerler.github.io/JointAI/reference/combine_formulas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine a fixed and random effects formula — combine_formulas","text":"fixed fixed effects formula (two-sided formula object) random random effects formula (one-sided formula object)","code":""},{"path":"https://nerler.github.io/JointAI/reference/combine_formulas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combine a fixed and random effects formula — combine_formulas","text":"Internal function, used combine_formula_lists().","code":""},{"path":"https://nerler.github.io/JointAI/reference/compare_data_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare the structure of two data.frames — compare_data_structure","title":"Compare the structure of two data.frames — compare_data_structure","text":"Compare structure two data.frames","code":""},{"path":"https://nerler.github.io/JointAI/reference/compare_data_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare the structure of two data.frames — compare_data_structure","text":"","code":"compare_data_structure(data1, data2)"},{"path":"https://nerler.github.io/JointAI/reference/compare_data_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare the structure of two data.frames — compare_data_structure","text":"data1 data.frame data2 data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/compare_data_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare the structure of two data.frames — compare_data_structure","text":"nothing, prints messages class variable changed levels factor variable changed","code":""},{"path":"https://nerler.github.io/JointAI/reference/convert_variables.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert variables — convert_variables","title":"Convert variables — convert_variables","text":"Cleans data changing NaN NA converting continuous variables just two values factor converting logical variables factor cleaning factor labels (using make.names())","code":""},{"path":"https://nerler.github.io/JointAI/reference/convert_variables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert variables — convert_variables","text":"","code":"convert_variables(data, allvars, mess = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/convert_variables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert variables — convert_variables","text":"data data.frame allvars character vector relevant variables data mess logical, TRUE messages printed","code":""},{"path":"https://nerler.github.io/JointAI/reference/convert_variables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert variables — convert_variables","text":"cleaned data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/convert_variables.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert variables — convert_variables","text":"used model_imp (2025-09-07)","code":""},{"path":"https://nerler.github.io/JointAI/reference/cross_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-correlation of MCMC samples — cross_corr","title":"Cross-correlation of MCMC samples — cross_corr","text":"functions compute cross-correlations MCMC samples JointAI object via coda::crosscorr() plot using either corrplot package coda::crosscorr.plot().","code":""},{"path":"https://nerler.github.io/JointAI/reference/cross_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-correlation of MCMC samples — cross_corr","text":"","code":"cross_corr(object, outcome = 1L, start = NULL, end = NULL, thin = NULL)  cross_corr_plot(object, outcome = 1L, start = NULL, end = NULL,   thin = NULL, type = \"corrplot\")"},{"path":"https://nerler.github.io/JointAI/reference/cross_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-correlation of MCMC samples — cross_corr","text":"object object class JointAI outcome integer; index outcome model correlations plotted start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. type character; type plot produced. Either \"corrplot\" (default) \"coda\".","code":""},{"path":"https://nerler.github.io/JointAI/reference/cross_corr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-correlation of MCMC samples — cross_corr","text":"matrix (plot)","code":""},{"path":"https://nerler.github.io/JointAI/reference/cross_corr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-correlation of MCMC samples — cross_corr","text":"","code":"fit <- lm_imp(y ~ C1 + C2 + B2, data = wideDF, n.iter = 200) cross_corr(fit) #>             (Intercept)          C1          C2         B21     sigma_y #> (Intercept)  1.00000000 -0.99932344  0.01671787  0.11588899 -0.04553272 #> C1          -0.99932344  1.00000000 -0.02108018 -0.15109733  0.04676991 #> C2           0.01671787 -0.02108018  1.00000000  0.17958905  0.03570433 #> B21          0.11588899 -0.15109733  0.17958905  1.00000000 -0.03596415 #> sigma_y     -0.04553272  0.04676991  0.03570433 -0.03596415  1.00000000 cross_corr_plot(fit, type = \"coda\")"},{"path":"https://nerler.github.io/JointAI/reference/default_hyperpars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the default values for hyper-parameters — default_hyperpars","title":"Get the default values for hyper-parameters — default_hyperpars","text":"function returns list default values hyper-parameters.","code":""},{"path":"https://nerler.github.io/JointAI/reference/default_hyperpars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the default values for hyper-parameters — default_hyperpars","text":"","code":"default_hyperpars()"},{"path":"https://nerler.github.io/JointAI/reference/default_hyperpars.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get the default values for hyper-parameters — default_hyperpars","text":"norm: hyper-parameters normal log-normal models gamma: hyper-parameters Gamma models beta: hyper-parameters beta models binom: hyper-parameters binomial models poisson: hyper-parameters poisson models multinomial: hyper-parameters multinomial models ordinal: hyper-parameters ordinal models ranef: hyper-parameters random effects variance-covariance matrices (one random effect Gamma distribution used instead Wishart distribution) surv: parameters survival models (survreg, coxph JM)","code":""},{"path":"https://nerler.github.io/JointAI/reference/default_hyperpars.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Get the default values for hyper-parameters — default_hyperpars","text":"JAGS user manual specification Wishart distribution: KinvD larger dimension variance-covariance matrix prior correlation random effects concentrated around 0, larger values KinvD indicate stronger prior belief elements multivariate normal distribution independent. KinvD equal number random effects Wishart prior puts weight extreme values (correlation 1 -1).","code":""},{"path":"https://nerler.github.io/JointAI/reference/default_hyperpars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the default values for hyper-parameters — default_hyperpars","text":"","code":"default_hyperpars() #> $norm #>    mu_reg_norm   tau_reg_norm shape_tau_norm  rate_tau_norm  #>          0e+00          1e-04          1e-02          1e-02  #>  #> $gamma #>    mu_reg_gamma   tau_reg_gamma shape_tau_gamma  rate_tau_gamma  #>           0e+00           1e-04           1e-02           1e-02  #>  #> $beta #>    mu_reg_beta   tau_reg_beta shape_tau_beta  rate_tau_beta  #>          0e+00          1e-04          1e-02          1e-02  #>  #> $binom #>  mu_reg_binom tau_reg_binom  #>         0e+00         1e-04  #>  #> $poisson #>  mu_reg_poisson tau_reg_poisson  #>           0e+00           1e-04  #>  #> $multinomial #>  mu_reg_multinomial tau_reg_multinomial  #>               0e+00               1e-04  #>  #> $ordinal #>    mu_reg_ordinal   tau_reg_ordinal  mu_delta_ordinal tau_delta_ordinal  #>             0e+00             1e-04             0e+00             1e-04  #>  #> $ranef #> shape_diag_RinvD  rate_diag_RinvD       KinvD_expr  #>           \"0.01\"          \"0.001\"   \"nranef + 1.0\"  #>  #> $surv #>  mu_reg_surv tau_reg_surv  #>        0.000        0.001  #>   # To change the hyper-parameters: hyp <- default_hyperpars() hyp$norm['rate_tau_norm'] <- 1e-3 mod <- lm_imp(y ~ C1 + C2 + B1, data = wideDF, hyperpars = hyp, mess = FALSE) #> Error in lm_imp(y ~ C1 + C2 + B1, data = wideDF, hyperpars = hyp, mess = FALSE): object 'hyp' not found"},{"path":"https://nerler.github.io/JointAI/reference/densplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior density from object of class JointAI — densplot","title":"Plot the posterior density from object of class JointAI — densplot","text":"function plots set densities (per chain coefficient) MCMC sample object class \"JointAI\".","code":""},{"path":"https://nerler.github.io/JointAI/reference/densplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior density from object of class JointAI — densplot","text":"","code":"densplot(object, ...)  # S3 method for class 'JointAI' densplot(object, start = NULL, end = NULL, thin = NULL,   subset = c(analysis_main = TRUE), outcome = NULL,   exclude_chains = NULL, vlines = NULL, nrow = NULL, ncol = NULL,   joined = FALSE, use_ggplot = FALSE, warn = TRUE, mess = TRUE, ...)"},{"path":"https://nerler.github.io/JointAI/reference/densplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior density from object of class JointAI — densplot","text":"object object inheriting class 'JointAI' ... additional parameters passed plot() start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. subset subset parameters/variables/nodes (columns MCMC sample). Follows principle argument monitor_params *_imp. outcome optional; vector identifying subset sub-models included output, either specifying indices (using order used list model formulas), names (LHS respective model formula character string) exclude_chains optional vector index numbers chains excluded vlines list, element named list parameters can passed graphics::abline() create vertical lines. list elements needs contain least v = <x location> <x location> vector length number plots (see examples). nrow optional; number rows plot layout; automatically chosen unspecified ncol optional; number columns plot layout; automatically chosen unspecified joined logical; chains combined plotting? use_ggplot logical; ggplot used instead base graphics? warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/densplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the posterior density from object of class JointAI — densplot","text":"","code":"if (FALSE) { # \\dontrun{ # fit a JointAI object: mod <- lm_imp(y ~ C1 + C2 + M1, data = wideDF, n.iter = 100)  # Example 1: basic densityplot densplot(mod) densplot(mod, exclude_chains = 2)   # Example 2: use vlines to mark zero densplot(mod, col = c(\"darkred\", \"darkblue\", \"darkgreen\"),          vlines = list(list(v = rep(0, nrow(summary(mod)$res$y$regcoef)),                             col = grey(0.8))))   # Example 3: use vlines to visualize posterior mean and 2.5%/97.5% quantiles res <- rbind(summary(mod)$res$y$regcoef[, c('Mean', '2.5%', '97.5%')],              summary(mod)$res$y$sigma[, c('Mean', '2.5%', '97.5%'),              drop = FALSE]              ) densplot(mod, vlines = list(list(v = res[, \"Mean\"], lty = 1, lwd = 2),                             list(v = res[, \"2.5%\"], lty = 2),                             list(v = res[, \"97.5%\"], lty = 2)))   # Example 4: ggplot version densplot(mod, use_ggplot = TRUE)   # Example 5: change how the ggplot version looks library(ggplot2)  densplot(mod, use_ggplot = TRUE) +   xlab(\"value\") +   theme(legend.position = 'bottom') +   scale_color_brewer(palette = 'Dark2', name = 'chain') } # }"},{"path":"https://nerler.github.io/JointAI/reference/difftime_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Converts a difftime object to a data.frame — difftime_df","title":"Converts a difftime object to a data.frame — difftime_df","text":"Converts difftime object data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/difftime_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converts a difftime object to a data.frame — difftime_df","text":"","code":"difftime_df(dt)"},{"path":"https://nerler.github.io/JointAI/reference/difftime_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Converts a difftime object to a data.frame — difftime_df","text":"dt difftime object (vector difftime objects)","code":""},{"path":"https://nerler.github.io/JointAI/reference/drop_levels.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for empty factor levels — drop_levels","title":"Check for empty factor levels — drop_levels","text":"CHECKS empty factor levels variables used model.","code":""},{"path":"https://nerler.github.io/JointAI/reference/drop_levels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for empty factor levels — drop_levels","text":"","code":"drop_levels(data, allvars, warn = TRUE, mess = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/drop_levels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for empty factor levels — drop_levels","text":"data data.frame allvars character vector (variable names used model) warn logical, TRUE warnings printed","code":""},{"path":"https://nerler.github.io/JointAI/reference/drop_levels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for empty factor levels — drop_levels","text":"data.frame (unchanged)","code":""},{"path":"https://nerler.github.io/JointAI/reference/drop_levels.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Check for empty factor levels — drop_levels","text":"Originally, function also dropped levels. , (accidentally?) commented line check performed. Now, create warning empty levels, drop . used model_imp (2020-06-09)","code":""},{"path":"https://nerler.github.io/JointAI/reference/duration_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a duration object — duration_obj","title":"Create a duration object — duration_obj","text":"Add row names object","code":""},{"path":"https://nerler.github.io/JointAI/reference/duration_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a duration object — duration_obj","text":"","code":"duration_obj(dur)"},{"path":"https://nerler.github.io/JointAI/reference/duration_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a duration object — duration_obj","text":"dur list difftime objects","code":""},{"path":"https://nerler.github.io/JointAI/reference/expand_rd_vcov_full.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand rd_vcov using variable names in case ","title":"Expand rd_vcov using variable names in case ","text":"Expand rd_vcov using variable names case \"full\" used","code":""},{"path":"https://nerler.github.io/JointAI/reference/expand_rd_vcov_full.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand rd_vcov using variable names in case ","text":"","code":"expand_rd_vcov_full(rd_vcov, rd_outnam)"},{"path":"https://nerler.github.io/JointAI/reference/expand_rd_vcov_full.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand rd_vcov using variable names in case ","text":"rd_vcov random effects variance covariance structure provided user (check_rd_vcov_list() called internally) rd_outnam list grouping level names outcome variables random effects level","code":""},{"path":"https://nerler.github.io/JointAI/reference/expand_rd_vcov_full.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand rd_vcov using variable names in case ","text":"named list per grouping level elements contains information random effects variance-covariance matrices level structured. Per level list grouping structures containing names variables structure (e.g. list(full = c(\"\", \"b\"), indep = \"c\"))","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_fixef_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract fixed effects formula from lme4-type formula — extract_fixef_formula","title":"Extract fixed effects formula from lme4-type formula — extract_fixef_formula","text":"Extract fixed effects formula lme4-type formula","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_fixef_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract fixed effects formula from lme4-type formula — extract_fixef_formula","text":"","code":"extract_fixef_formula(formula)"},{"path":"https://nerler.github.io/JointAI/reference/extract_fixef_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract fixed effects formula from lme4-type formula — extract_fixef_formula","text":"formula formula object (typically lme4-style)","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_fixef_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract fixed effects formula from lme4-type formula — extract_fixef_formula","text":"formula object","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_grouping.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract grouping variables from a (list of) formula(s) — extract_grouping","title":"Extract grouping variables from a (list of) formula(s) — extract_grouping","text":"Extracts grouping variables (.e., variables |) model formula list formulas","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_grouping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract grouping variables from a (list of) formula(s) — extract_grouping","text":"","code":"extract_grouping(formula, warn = FALSE)"},{"path":"https://nerler.github.io/JointAI/reference/extract_grouping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract grouping variables from a (list of) formula(s) — extract_grouping","text":"formula formula object list formula objects warn nothing","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_grouping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract grouping variables from a (list of) formula(s) — extract_grouping","text":"vector character strings containing unique grouping variable names found input formulas, NULL grouping found","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_string.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the left hand side of a formula — extract_lhs_string","title":"Extract the left hand side of a formula — extract_lhs_string","text":"Extracts left hand side formula object returns character string.","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_string.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the left hand side of a formula — extract_lhs_string","text":"","code":"extract_lhs_string(formula)"},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_string.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the left hand side of a formula — extract_lhs_string","text":"formula formula object (list formulas)","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_string.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract the left hand side of a formula — extract_lhs_string","text":"character string.","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_string.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract the left hand side of a formula — extract_lhs_string","text":"Internal; used various help functions (2022-02-05)","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_varnames.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract variable names from the left-hand side of a formula — extract_lhs_varnames","title":"Extract variable names from the left-hand side of a formula — extract_lhs_varnames","text":"internal helper function extracts variable names left-hand side (LHS) formula list formulas. supports standard formulas, survival objects, transformations (e.g., log(x)), multivariate outcomes (e.g., cbind(, b, c)).","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_varnames.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract variable names from the left-hand side of a formula — extract_lhs_varnames","text":"","code":"extract_lhs_varnames(formula)"},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_varnames.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract variable names from the left-hand side of a formula — extract_lhs_varnames","text":"formula formula object, list formulas, NULL.","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_lhs_varnames.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract variable names from the left-hand side of a formula — extract_lhs_varnames","text":"character vector variable names LHS formula, list vectors list formulas provided. Returns NULL input NULL.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/extract_ranef_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract random effects formula from lme4-type formula — extract_ranef_formula","title":"Extract random effects formula from lme4-type formula — extract_ranef_formula","text":"Extract random effects formula lme4-type formula","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_ranef_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract random effects formula from lme4-type formula — extract_ranef_formula","text":"","code":"extract_ranef_formula(formula)"},{"path":"https://nerler.github.io/JointAI/reference/extract_ranef_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract random effects formula from lme4-type formula — extract_ranef_formula","text":"formula formula object (typically lme4-style)","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_ranef_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract random effects formula from lme4-type formula — extract_ranef_formula","text":"one-sided formula object (NULL random effects)","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Return the current state of a 'JointAI' model — extract_state","title":"Return the current state of a 'JointAI' model — extract_state","text":"Return current state 'JointAI' model","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return the current state of a 'JointAI' model — extract_state","text":"","code":"extract_state(object, pattern = paste0(\"^\", c(\"RinvD\", \"invD\", \"tau\", \"b\"),   \"_\"))"},{"path":"https://nerler.github.io/JointAI/reference/extract_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return the current state of a 'JointAI' model — extract_state","text":"object object class 'JointAI' pattern vector patterns matched names nodes","code":""},{"path":"https://nerler.github.io/JointAI/reference/extract_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return the current state of a 'JointAI' model — extract_state","text":"list one element per chain MCMC sampler, containing Returns current state MCMC sampler (values last iteration) subset nodes identified based pattern user specified.","code":""},{"path":"https://nerler.github.io/JointAI/reference/factor_to_integer.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a factor to an integer representation — factor_to_integer","title":"Convert a factor to an integer representation — factor_to_integer","text":"Convert factor integer representation","code":""},{"path":"https://nerler.github.io/JointAI/reference/factor_to_integer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a factor to an integer representation — factor_to_integer","text":"","code":"factor_to_integer(x)"},{"path":"https://nerler.github.io/JointAI/reference/factor_to_integer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a factor to an integer representation — factor_to_integer","text":"x vector. x factor converted integers described ; otherwise x returned unchanged.","code":""},{"path":"https://nerler.github.io/JointAI/reference/factor_to_integer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a factor to an integer representation — factor_to_integer","text":"integer vector x factor, otherwise original x.","code":""},{"path":"https://nerler.github.io/JointAI/reference/factor_to_integer.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Convert a factor to an integer representation — factor_to_integer","text":"Used extract_outcome_data().","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_MIdat.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","title":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","text":"function returns dataset containing multiple imputed datasets stacked onto (.e., long format; optionally including original, incomplete data). data can automatically exported SPSS (.txt file containing data .sps file containing syntax generate .sav file). export function foreign package needs installed.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_MIdat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","text":"","code":"get_MIdat(object, m = 10, include = TRUE, start = NULL, minspace = 50,   seed = NULL, export_to_SPSS = FALSE, resdir = NULL, filename = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/get_MIdat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","text":"object object inheriting class 'JointAI' m number imputed datasets include original, incomplete data included? Default TRUE. start first iteration interest (see window.mcmc) minspace minimum number iterations iterations chosen imputed values (prevent strong correlation imputed datasets case high autocorrelation MCMC chains). seed optional seed value export_to_SPSS logical; completed data exported SPSS? resdir optional; directory results. unspecified export_to_SPSS = TRUE current working directory used. filename optional; file name (without ending). unspecified export_to_SPSS = TRUE name generated automatically.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_MIdat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","text":"data.frame original data (include = TRUE) imputed datasets stacked onto . variable Imputation_ indexes imputation, .rownr links rows rows original data. cross-sectional datasets variable .id added subject identifier.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_MIdat.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","text":"order able extract (multiple) imputed datasets imputed values must monitored, .e., imps = TRUE specified argument monitor_params *_imp.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/get_MIdat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract multiple imputed datasets from an object of class JointAI — get_MIdat","text":"","code":"if (FALSE) { # \\dontrun{ # fit a model and monitor the imputed values with # monitor_params = c(imps = TRUE)  mod <- lm_imp(y ~ C1 + C2 + M2, data = wideDF,               monitor_params = c(imps = TRUE), n.iter = 100)  # Example 1: without export to SPSS MIs <- get_MIdat(mod, m = 3, seed = 123)    # Example 2: with export for SPSS # (here: to the temporary directory \"temp_dir\")  temp_dir <- tempdir() MIs <- get_MIdat(mod, m = 3, seed = 123, resdir = temp_dir,                  filename = \"example_imputation\",                  export_to_SPSS = TRUE)  } # }"},{"path":"https://nerler.github.io/JointAI/reference/get_Mlist.html","id":null,"dir":"Reference","previous_headings":"","what":"Re-create the full Mlist from a ","title":"Re-create the full Mlist from a ","text":"Re-create full Mlist \"JointAI\" object","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_Mlist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Re-create the full Mlist from a ","text":"","code":"get_Mlist(object)"},{"path":"https://nerler.github.io/JointAI/reference/get_Mlist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Re-create the full Mlist from a ","text":"object object class \"JointAI\"","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_datlvls.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine grouping level of data — get_datlvls","title":"Determine grouping level of data — get_datlvls","text":"column data.frame-like object, identify hierarchical level highest grouping level groups_df column identical members every group.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_datlvls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine grouping level of data — get_datlvls","text":"","code":"get_datlvls(data, groups_df)"},{"path":"https://nerler.github.io/JointAI/reference/get_datlvls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine grouping level of data — get_datlvls","text":"data data.frame groups_df data.frame (integer) grouping vectors length nrow(data).","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_datlvls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine grouping level of data — get_datlvls","text":"named character vector length ncol(data). element name grouping level corresponding data column constant.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/get_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify the family from the covariate model type — get_family","title":"Identify the family from the covariate model type — get_family","text":"Identify family covariate model type","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify the family from the covariate model type — get_family","text":"","code":"get_family(model)"},{"path":"https://nerler.github.io/JointAI/reference/get_family.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify the family from the covariate model type — get_family","text":"model character string; covariate model type","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_grouping_levels.html","id":null,"dir":"Reference","previous_headings":"","what":"Get grouping levels — get_grouping_levels","title":"Get grouping levels — get_grouping_levels","text":"helper function identifies hierarchy grouping variables. checks grouping level many grouping levels varies within returns ranked order grouping levels.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_grouping_levels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get grouping levels — get_grouping_levels","text":"","code":"get_grouping_levels(grouping_df)"},{"path":"https://nerler.github.io/JointAI/reference/get_grouping_levels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get grouping levels — get_grouping_levels","text":"grouping_df data.frame grouping (\"id\") variables, obtained get_groups()","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_grouping_levels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get grouping levels — get_grouping_levels","text":"named integer vector identifying grouping hierarchy, \"1\" level individual observations largest number highest grouping level. Crossed levels number.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_groups.html","id":null,"dir":"Reference","previous_headings":"","what":"Get grouping information — get_groups","title":"Get grouping information — get_groups","text":"helper function generates grouping information data.frame character vector names grouping variables. cases, level \"lvlone\" added indicate lowest level data (.e., observation group).","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_groups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get grouping information — get_groups","text":"","code":"get_groups(idvars, data)"},{"path":"https://nerler.github.io/JointAI/reference/get_groups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get grouping information — get_groups","text":"idvars character vector names grouping variables data data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_groups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get grouping information — get_groups","text":"list grouping information grouping level: element vector length nrow(data) group membership indices observation corresponding grouping level.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_listelement.html","id":null,"dir":"Reference","previous_headings":"","what":"Get an element of a list, return a default value if it does not exist — get_listelement","title":"Get an element of a list, return a default value if it does not exist — get_listelement","text":"small helper function extract element list return default value element exist (.e., NULL).","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_listelement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get an element of a list, return a default value if it does not exist — get_listelement","text":"","code":"get_listelement(object, element, null_value = 0)"},{"path":"https://nerler.github.io/JointAI/reference/get_listelement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get an element of a list, return a default value if it does not exist — get_listelement","text":"object list element name element extract (character string) null_value value return element exist","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_listelement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get an element of a list, return a default value if it does not exist — get_listelement","text":"value object[[element]] null_value object[[element]] NULL","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_missinfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain a summary of the missing values involved in an object of class JointAI — get_missinfo","title":"Obtain a summary of the missing values involved in an object of class JointAI — get_missinfo","text":"function returns data.frame list data.frames per grouping level. data.frames columns variable, #NA (number missing values) %NA (proportion missing values percent).","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_missinfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain a summary of the missing values involved in an object of class JointAI — get_missinfo","text":"","code":"get_missinfo(object)"},{"path":"https://nerler.github.io/JointAI/reference/get_missinfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain a summary of the missing values involved in an object of class JointAI — get_missinfo","text":"object object inheriting class JointAI","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_missinfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain a summary of the missing values involved in an object of class JointAI — get_missinfo","text":"","code":"mod <-  lm_imp(y ~ C1 + B2 + C2, data = wideDF, n.iter = 100) get_missinfo(mod) #> $complete_cases #>         #  % #> lvlone 77 77 #>  #> $miss_list #> $miss_list$lvlone #>    # NA % NA #> y     0    0 #> C1    0    0 #> C2    4    4 #> B2   20   20 #>  #>"},{"path":"https://nerler.github.io/JointAI/reference/get_modeltype.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify the general model type from the covariate model type — get_modeltype","title":"Identify the general model type from the covariate model type — get_modeltype","text":"Identify general model type covariate model type","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_modeltype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify the general model type from the covariate model type — get_modeltype","text":"","code":"get_modeltype(model)"},{"path":"https://nerler.github.io/JointAI/reference/get_modeltype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify the general model type from the covariate model type — get_modeltype","text":"model character string; covariate model type","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_nranef.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the number of random effects — get_nranef","title":"Extract the number of random effects — get_nranef","text":"function extracts number random effects per variable grouping level provided random effects formulas.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_nranef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the number of random effects — get_nranef","text":"","code":"get_nranef(random, data)"},{"path":"https://nerler.github.io/JointAI/reference/get_nranef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the number of random effects — get_nranef","text":"random random effect formula list random effects formulas data data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_nranef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract the number of random effects — get_nranef","text":"list named vectors numbers random effects per variable, list element refers (hierarchical) grouping level.","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_resp_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify the data matrix containing a given response variable — get_resp_mat","title":"Identify the data matrix containing a given response variable — get_resp_mat","text":"Identify data matrix containing given response variable","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_resp_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify the data matrix containing a given response variable — get_resp_mat","text":"","code":"get_resp_mat(resp, Mlvls, outnames)"},{"path":"https://nerler.github.io/JointAI/reference/get_resp_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify the data matrix containing a given response variable — get_resp_mat","text":"resp character string; name response variable Mlvls named vector names column names data matrices, values names corresponding data matrices outnames character vector; names columns data matrices contain response variable (multiple columns case survival outcome)","code":""},{"path":"https://nerler.github.io/JointAI/reference/get_resp_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify the data matrix containing a given response variable — get_resp_mat","text":"character string; name(s) data matrix/matrices response variable(s)","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Get info on main effects in a rd slope structure for a level and sub-model — hc_rdslope_info","title":"Get info on main effects in a rd slope structure for a level and sub-model — hc_rdslope_info","text":"Get info main effects rd slope structure level sub-model","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get info on main effects in a rd slope structure for a level and sub-model — hc_rdslope_info","text":"","code":"hc_rdslope_info(hc_cols, parelmts)"},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get info on main effects in a rd slope structure for a level and sub-model — hc_rdslope_info","text":"hc_cols list lists (one per random effect), containing list elements \"main\" \"interact\" contain information column number name design matrix random effects variables variables interacting parelmts list (per design matrix) indices regression coefficients used sub-model (named corresponding column name design matrix)","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get info on main effects in a rd slope structure for a level and sub-model — hc_rdslope_info","text":"data.frame columns rd_effect: name main random effect, term: name random effect, matrix: name design matrix, cols: column index design matrix, parelmts (index corresponding regression coefficient one row per (main) random effect","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_info.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get info on main effects in a rd slope structure for a level and sub-model — hc_rdslope_info","text":"Argument hc_cols structure:   Argument parelmts list lists instead list vectors case multinomial model cumulative logit model non-proportional effects.","code":"list(   \"(Intercept)\" = list(main = c(M_id = 1),                        interact = NULL),   time = list(main = c(M_lvlone = 4),               interact = list(\"C1:time\" = list(interterm = c(M_lvlone = 6),                                                elmts = c(M_id = 2,                                                          M_lvlone = 4)),                               \"b21:time\" = list(interterm = c(M_lvlone = 7),                                                 elmts = c(M_lvlone = 3,                                                           M_lvlone = 4))               )   ),   \"I(time^2)\" = list(main = c(M_lvlone = 5),                      interact = NULL) )"},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_interact.html","id":null,"dir":"Reference","previous_headings":"","what":"Get info on the interactions with random slopes for a given level and sub-model — hc_rdslope_interact","title":"Get info on the interactions with random slopes for a given level and sub-model — hc_rdslope_interact","text":"Get info interactions random slopes given level sub-model","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_interact.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get info on the interactions with random slopes for a given level and sub-model — hc_rdslope_interact","text":"","code":"hc_rdslope_interact(hc_cols, parelmts, lvls)"},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_interact.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get info on the interactions with random slopes for a given level and sub-model — hc_rdslope_interact","text":"hc_cols list lists (one per random effect), containing list elements \"main\" \"interact\" contain information column number name design matrix random effects variables variables interacting parelmts list (per design matrix) indices regression coefficients used sub-model (named corresponding column name design matrix)","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_interact.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get info on the interactions with random slopes for a given level and sub-model — hc_rdslope_interact","text":"data.frame columns rd_effect: name main random effect, term: name random effect, matrix: name design matrix, cols: column index design matrix, parelmts (index corresponding regression coefficient one row per (main) random effect","code":""},{"path":"https://nerler.github.io/JointAI/reference/hc_rdslope_interact.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get info on the interactions with random slopes for a given level and sub-model — hc_rdslope_interact","text":"Argument hc_cols structure:   Argument parelmts list lists instead list vectors case multinomial model cumulative logit model non-proportional effects.","code":"list(   \"(Intercept)\" = list(main = c(M_id = 1),                        interact = NULL),   time = list(main = c(M_lvlone = 4),               interact = list(\"C1:time\" = list(interterm = c(M_lvlone = 6),                                                elmts = c(M_id = 2,                                                          M_lvlone = 4)),                               \"b21:time\" = list(interterm = c(M_lvlone = 7),                                                 elmts = c(M_lvlone = 3,                                                           M_lvlone = 4))               )   ),   \"I(time^2)\" = list(main = c(M_lvlone = 5),                      interact = NULL) )"},{"path":"https://nerler.github.io/JointAI/reference/internal_clean_survname.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a survival outcome to a model name — internal_clean_survname","title":"Convert a survival outcome to a model name — internal_clean_survname","text":"helper function converts \"name survival model\" (\"Surv(time, status)\" specification) valid variable name can used JAGS model syntax.","code":""},{"path":"https://nerler.github.io/JointAI/reference/internal_clean_survname.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a survival outcome to a model name — internal_clean_survname","text":"","code":"internal_clean_survname(x)"},{"path":"https://nerler.github.io/JointAI/reference/internal_clean_survname.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a survival outcome to a model name — internal_clean_survname","text":"x character string vector character strings","code":""},{"path":"https://nerler.github.io/JointAI/reference/list_models.html","id":null,"dir":"Reference","previous_headings":"","what":"List model details — list_models","title":"List model details — list_models","text":"function prints information models, explicitly specified user specified automatically JointAI (incomplete) covariates JointAI object.","code":""},{"path":"https://nerler.github.io/JointAI/reference/list_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List model details — list_models","text":"","code":"list_models(object, predvars = TRUE, regcoef = TRUE, otherpars = TRUE,   priors = TRUE, refcat = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/list_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List model details — list_models","text":"object object inheriting class 'JointAI' predvars logical; information predictor variables printed? (default TRUE) regcoef logical; information regression coefficients printed? (default TRUE) otherpars logical; information parameters printed? (default TRUE) priors logical; information priors (hyper-parameters) printed? (default TRUE) refcat logical; information reference category printed? (default TRUE)","code":""},{"path":"https://nerler.github.io/JointAI/reference/list_models.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"List model details — list_models","text":"models listed function actual imputation models, conditional models part specification joint distribution. Briefly, joint distribution specified sequence conditional models MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}}; \\[p(y | x_1, x_2, x_3, ..., \\theta) p(x_1|x_2, x_3, ..., \\theta) p(x_2|x_3, ..., \\theta) ...\\] actual imputation models full conditional distributions \\(p(x_1 | \\cdot)\\) derived joint distribution. Even though conditional distributions contain outcome covariates linear predictor, outcome covariates taken account implicitly, since imputations sampled full conditional distributions. details, see Erler et al. (2016) Erler et al. (2019). function list_models prints information conditional distributions covariates (since specified; full-conditionals automatically derived within JAGS). outcome , thus, part printed linear predictor, still included imputation.","code":""},{"path":"https://nerler.github.io/JointAI/reference/list_models.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"List model details — list_models","text":"Erler, N.S., Rizopoulos, D., Rosmalen, J.V., Jaddoe, V.W., Franco, O.H., & Lesaffre, E.M.E.H. (2016). Dealing missing covariates epidemiologic studies: comparison multiple imputation full Bayesian approach. Statistics Medicine, 35(17), 2955-2974. Erler NS, Rizopoulos D, Lesaffre EMEH (2021). \"JointAI: Joint Analysis Imputation Incomplete Data R.\" Journal Statistical Software, 100(20), 1-56. doi:10.18637/jss.v100.i20 .","code":""},{"path":"https://nerler.github.io/JointAI/reference/list_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List model details — list_models","text":"","code":"# (set n.adapt = 0 and n.iter = 0 to prevent MCMC sampling to save time) mod1 <- lm_imp(y ~ C1 + C2 + M2 + O2 + B2, data = wideDF, n.adapt = 0,                n.iter = 0, mess = FALSE) #> Warning:  #> It is currently not possible to use “contr.poly” for incomplete #> categorical covariates. I will use “contr.treatment” instead.  You can #> specify (globally) which types of contrasts are used by changing #> “options('contrasts')”.  list_models(mod1) #> Linear model for “y”  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), C1, C2, M22, M23, M24, O22, O23, O24, B21  #> * Regression coefficients: #>   beta[1:10] (normal prior(s) with mean 0 and precision 1e-04)  #> * Precision of  “y” : #>   tau_y (Gamma prior with shape parameter 0.01 and rate parameter 0.01) #>  #>  #> Binomial model for “B2”  #>    family: binomial  #>    link: logit  #> * Reference category: “0” #> * Predictor variables: #>   (Intercept), C1, C2, M22, M23, M24, O22, O23, O24  #> * Regression coefficients: #>   alpha[1:9] (normal prior(s) with mean 0 and precision 1e-04)  #>  #>  #> Linear model for “C2”  #>    family: gaussian  #>    link: identity  #> * Predictor variables: #>   (Intercept), C1, M22, M23, M24, O22, O23, O24  #> * Regression coefficients: #>   alpha[10:17] (normal prior(s) with mean 0 and precision 1e-04)  #> * Precision of  “C2” : #>   tau_C2 (Gamma prior with shape parameter 0.01 and rate parameter 0.01) #>  #>  #> Multinomial logit model for “M2”  #> * Reference category: “1” #> * Predictor variables: #>   (Intercept), C1, O22, O23, O24  #> * Regression coefficients: #>   M22: alpha[18:22] #>   M23: alpha[23:27] #>   M24: alpha[28:32] (normal prior(s) with mean 0 and precision 1e-04)  #>  #>  #> Cumulative logit model for “O2”  #> * Reference category: “1” #> * Predictor variables: #>   C1  #> * Regression coefficients: #>   alpha[33] (normal prior(s) with mean 0 and precision 1e-04)  #> * Intercepts: #>   - 1: gamma_O2[1] (normal prior with mean 0 and precision 1e-04) #>   - 2: gamma_O2[2] = gamma_O2[1] + exp(delta_O2[1]) #>   - 3: gamma_O2[3] = gamma_O2[2] + exp(delta_O2[2]) #> * Increments: #>   delta_O2[1:2] (normal prior(s) with mean 0 and precision 1e-04) #>  #>"},{"path":"https://nerler.github.io/JointAI/reference/longDF.html","id":null,"dir":"Reference","previous_headings":"","what":"Longitudinal example dataset — longDF","title":"Longitudinal example dataset — longDF","text":"simulated longitudinal dataset.","code":""},{"path":"https://nerler.github.io/JointAI/reference/longDF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Longitudinal example dataset — longDF","text":"","code":"data(longDF)"},{"path":"https://nerler.github.io/JointAI/reference/longDF.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Longitudinal example dataset — longDF","text":"simulated data frame 329 rows 21 variables data 100 subjects: C1 continuous, complete baseline variable C2 continuous, incomplete baseline variable B1 binary, complete baseline variable B2 binary, incomplete baseline variable M1 unordered factor; complete baseline variable M2 unordered factor; incomplete baseline variable O1 ordered factor; complete baseline variable O2 ordered factor; incomplete baseline variable P1 count variable; complete baseline variable P2 count variable; incomplete baseline variable c1 continuous, complete longitudinal variable c2 continuous incomplete longitudinal variable b1 binary, complete longitudinal variable b2 binary incomplete longitudinal variable o1 ordered factor; complete longitudinal variable o2 ordered factor; incomplete longitudinal variable p1 count variable; complete longitudinal variable p2 count variable; incomplete longitudinal variable id id (grouping) variable time continuous complete longitudinal variable y continuous, longitudinal (outcome) variable","code":""},{"path":"https://nerler.github.io/JointAI/reference/md_pattern.html","id":null,"dir":"Reference","previous_headings":"","what":"Missing data pattern — md_pattern","title":"Missing data pattern — md_pattern","text":"Obtain plot pattern missing data /return pattern matrix.","code":""},{"path":"https://nerler.github.io/JointAI/reference/md_pattern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Missing data pattern — md_pattern","text":"","code":"md_pattern(data, color = c(grDevices::grey(0.1), grDevices::grey(0.7)),   border = grDevices::grey(0.5), plot = TRUE, pattern = FALSE,   print_xaxis = TRUE, ylab = \"Number of observations per pattern\",   print_yaxis = TRUE, legend.position = \"bottom\", sort_columns = TRUE,   ...)"},{"path":"https://nerler.github.io/JointAI/reference/md_pattern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Missing data pattern — md_pattern","text":"data data frame color vector length two, specifies colour used indicate observed missing values (order) border colour grid plot logical; missing data pattern plotted? (default TRUE) pattern logical; missing data pattern returned matrix? (default FALSE) print_xaxis, print_yaxis logical; x-axis (plot) y-axis (right) printed? ylab y-axis label legend.position default position legends (\"none\", \"left\", \"right\", \"bottom\", \"top\", \"inside\") sort_columns logical; columns sorted number missing values? (default TRUE) ... optional additional parameters, currently used","code":""},{"path":"https://nerler.github.io/JointAI/reference/md_pattern.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Missing data pattern — md_pattern","text":"function requires ggplot2 package installed.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/md_pattern.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Missing data pattern — md_pattern","text":"","code":"op <- par(mar = c(3, 1, 1.5, 1.5), mgp = c(2, 0.6, 0)) md_pattern(wideDF)  par(op)"},{"path":"https://nerler.github.io/JointAI/reference/merge_call_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge call arguments with default formals — merge_call_args","title":"Merge call arguments with default formals — merge_call_args","text":"Merge call arguments default formals","code":""},{"path":"https://nerler.github.io/JointAI/reference/merge_call_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge call arguments with default formals — merge_call_args","text":"","code":"merge_call_args(formals, call, sframe)"},{"path":"https://nerler.github.io/JointAI/reference/merge_call_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge call arguments with default formals — merge_call_args","text":"formals List formal arguments *_imp(). call matched call *_imp() returned match.call(). sframe environment within *_imp() (obtained sys.frame(sys.nframe()))","code":""},{"path":"https://nerler.github.io/JointAI/reference/merge_call_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge call arguments with default formals — merge_call_args","text":"list arguments combining defaults user-specified values.","code":""},{"path":"https://nerler.github.io/JointAI/reference/merge_call_args.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Merge call arguments with default formals — merge_call_args","text":"Helper function prep_arglist.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":null,"dir":"Reference","previous_headings":"","what":"Joint Analysis and Imputation of incomplete data — model_imp","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"Main analysis functions estimate different types models using MCMC sampling, imputing missing values.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"","code":"lm_imp(formula, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, models = NULL, no_model = NULL, shrinkage = FALSE,   ppc = TRUE, seed = NULL, inits = NULL, warn = TRUE, mess = TRUE,   ...)  glm_imp(formula, family, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, models = NULL, no_model = NULL, shrinkage = FALSE,   ppc = TRUE, seed = NULL, inits = NULL, warn = TRUE, mess = TRUE,   ...)  clm_imp(formula, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, nonprop = NULL, rev = NULL, models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  lognorm_imp(formula, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, models = NULL, no_model = NULL, shrinkage = FALSE,   ppc = TRUE, seed = NULL, inits = NULL, warn = TRUE, mess = TRUE,   ...)  betareg_imp(formula, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, models = NULL, no_model = NULL, shrinkage = FALSE,   ppc = TRUE, seed = NULL, inits = NULL, warn = TRUE, mess = TRUE,   ...)  mlogit_imp(formula, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, models = NULL, no_model = NULL, shrinkage = FALSE,   ppc = TRUE, seed = NULL, inits = NULL, warn = TRUE, mess = TRUE,   ...)  lme_imp(fixed, data, random, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  lmer_imp(fixed, data, random, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  glme_imp(fixed, data, random, family, n.chains = 3, n.adapt = 100,   n.iter = 0, thin = 1, monitor_params = c(analysis_main = TRUE),   auxvars = NULL, refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  glmer_imp(fixed, data, random, family, n.chains = 3, n.adapt = 100,   n.iter = 0, thin = 1, monitor_params = c(analysis_main = TRUE),   auxvars = NULL, refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  betamm_imp(fixed, random, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  lognormmm_imp(fixed, random, data, n.chains = 3, n.adapt = 100,   n.iter = 0, thin = 1, monitor_params = c(analysis_main = TRUE),   auxvars = NULL, refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  clmm_imp(fixed, data, random, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, nonprop = NULL, rev = NULL, rd_vcov = \"blockdiag\",   models = NULL, no_model = NULL, shrinkage = FALSE, ppc = TRUE,   seed = NULL, inits = NULL, warn = TRUE, mess = TRUE, ...)  mlogitmm_imp(fixed, data, random, n.chains = 3, n.adapt = 100,   n.iter = 0, thin = 1, monitor_params = c(analysis_main = TRUE),   auxvars = NULL, refcats = NULL, rd_vcov = \"blockdiag\", models = NULL,   no_model = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)  survreg_imp(formula, data, n.chains = 3, n.adapt = 100, n.iter = 0,   thin = 1, monitor_params = c(analysis_main = TRUE), auxvars = NULL,   refcats = NULL, models = NULL, no_model = NULL, shrinkage = FALSE,   ppc = TRUE, seed = NULL, inits = NULL, warn = TRUE, mess = TRUE,   ...)  coxph_imp(formula, data, df_basehaz = 6, n.chains = 3, n.adapt = 100,   n.iter = 0, thin = 1, monitor_params = c(analysis_main = TRUE),   auxvars = NULL, refcats = NULL, models = NULL, no_model = NULL,   shrinkage = FALSE, ppc = TRUE, seed = NULL, inits = NULL,   warn = TRUE, mess = TRUE, ...)  JM_imp(formula, data, df_basehaz = 6, n.chains = 3, n.adapt = 100,   n.iter = 0, thin = 1, monitor_params = c(analysis_main = TRUE),   auxvars = NULL, timevar = NULL, refcats = NULL,   rd_vcov = \"blockdiag\", models = NULL, no_model = NULL,   assoc_type = NULL, shrinkage = FALSE, ppc = TRUE, seed = NULL,   inits = NULL, warn = TRUE, mess = TRUE, ...)"},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"formula two sided model formula (see formula) list formulas; (details ). data data.frame containing original data (details ) n.chains number MCMC chains n.adapt number iterations adaptation MCMC samplers (see adapt) n.iter number iterations MCMC chain (adaptation; see coda.samples) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. monitor_params named list vector specifying parameters monitored (details ) auxvars optional; one-sided formula variables used predictors imputation procedure (imputed necessary) part analysis model(s). details regards behaviour non-linear effects see vignette Model Specification refcats optional; either one \"first\", \"last\", \"largest\" (sets category categorical variables) named list specifying category used reference category per categorical variable. Options category label, category number, one \"first\" (first category), \"last\" (last category) \"largest\" (chooses category observations). Default \"first\". reference categories specified subset categorical variables default used remaining variables. (See also set_refcat) models optional; named vector specifying types models (incomplete) covariates. arguments replaces argument meth used earlier versions. NULL (default) models determined automatically based class respective columns data. no_model optional; vector names variables model specified. Note possible completely observed variables implies assumptions independence excluded variable incomplete variables. shrinkage optional; either character string naming shrinkage method used regression coefficients models named vector specifying type shrinkage used models given names. ppc logical: monitors posterior predictive checks set? (yet used) seed optional; seed value (reproducibility) inits optional; specification initial values form list function (see jags.model). omitted, starting values random number generator created JointAI, initial values generated JAGS. error supply initial value observed node. warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE. ... additional, optional arguments trunc named list specifying limits truncation distribution named incomplete variables (see vignette ModelSpecification) hyperpars list hyper-parameters, obtained default_hyperpars() scale_vars named vector (continuous) variables centred scaled (mean = 0 sd = 1) enter linear predictor improve convergence MCMC sampling. Default numeric variables integer variables >20 different values scaled. set FALSE scaling done. custom named list JAGS model chunks (character strings) replace model given variable. append_data_list list appended list containing data passed rjags (data_list). may necessary additional data / variables needed custom (covariate) models. Note: since version 1.0.7 elements append_data_list overwrite existing elements data_list name. progress.bar character string specifying type progress bar. Possible values \"text\" (default), \"gui\", \"none\" (see update). Note: sampling performed parallel possible display progress bar. quiet logical; TRUE messages generated rjags compilation well progress bar adaptive phase suppressed, (see jags.model) keep_scaled_mcmc \"original\" MCMC sample (.e., scaled version returned coda.samples()) kept? (MCMC sample re-scaled scale data always kept.) modelname character string specifying name model file (including ending, either .R .txt). unspecified random name generated. modeldir directory containing model file directory model file written. unspecified temporary directory created. overwrite logical; whether existing model file specified <modeldir>/<modelname> overwritten. set FALSE model already exists, model used. unspecified (NULL) file exists, user asked input proceed. keep_model logical; whether created JAGS model file saved removed (FALSE; default) sampling finished. family glm_imp glmm_imp/glmer_imp: description distribution link function used model. can character string naming family function, family function result call family function. (details see family.) nonprop optional named list one-sided formulas specifying covariates non-proportional effects cumulative logit models. covariates also part regular model formula, names list names ordinal response variables. rev optional character vector; vector ordinal outcome variable names odds reversed, .e., \\(logit(y\\le k)\\) instead \\(logit(y > k)\\). fixed two sided formula describing fixed-effects part model (see formula) random multi-level models: one-sided formula form ~x1 + ... + xn | g, x1 + ... + xn specifies model random effects g grouping variable rd_vcov character string list specifying structure random effects variance covariance matrix, see details . df_basehaz degrees freedom B-spline used model baseline hazard proportional hazards models (coxph_imp JM_imp) timevar name variable indicating time measurement time-varying covariate proportional hazards survival model (also joint model). variable specified \"timevar\" automatically added \"no_model\". assoc_type named vector specifying type association used time-varying covariate linear predictor survival model using \"JM\" model. Implemented options \"underl.value\" (linear predictor; default covariates modelled using Gaussian, Gamma, beta log-normal distribution) covariates) \"obs.value\" (observed/imputed value; default covariates modelled using distributions).","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"object class JointAI.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"random-effects","dir":"Reference","previous_headings":"","what":"Random effects","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"possible specify multi-level models done package nlme, using fixed random, done package lme4, using formula specifying random effects brackets:   equivalent ","code":"formula = y ~ x1 + x2 + x3 + (1 | id) fixed = y ~ x1 + x2 + x3, random = ~ 1|id"},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"multiple-levels-of-grouping","dir":"Reference","previous_headings":"","what":"Multiple levels of grouping","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"multiple levels grouping specification using formula used. distinction nested crossed random effects, .e., ... + (1 | id) + (1 | center) treated ... + (1 | center/id).","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"nested-vs-crossed-random-effects","dir":"Reference","previous_headings":"","what":"Nested vs crossed random effects","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"distinction nested crossed random effects come levels grouping variables, .e., id nested center, observations id different values center.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"modelling-multiple-models-simultaneously-amp-joint-models","dir":"Reference","previous_headings":"","what":"Modelling multiple models simultaneously & joint models","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"fit multiple main models time, list formula objects can passed argument formula. Outcomes one model may contained covariates another model possible combine models variables different levels, example:   principle also used specification joint model longitudinal survival data. Note possible specify multiple models outcome variable.","code":"formula = list(y ~ x1 + x2 + x3 + x4 + time + (time | id),                      x2 ~ x3 + x4 + x5)"},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"random-effects-variance-covariance-structure","dir":"Reference","previous_headings":"","what":"Random effects variance-covariance structure","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"(Note: feature new fully tested yet.) default, block-diagonal structure assumed variance-covariance matrices random effects models random effects. means per outcome level random effects assumed correlated, random effects different outcomes modelled independent. argument rd_vcov allows user specify different assumptions variance-covariance matrices. Implemented structures full, blockdiag indep (-diagonal elements zero). rd_vcov set one options, structure assumed random effects variance-covariance matrices. Alternatively, possible specify named list vectors, names structures vectors contain names response variables included structure. example, multivariate mixed model five outcomes y1, ..., y5, specification :   entail random effects y3 y4 assumed correlated (within across outcomes), random effects y1 y2 assumed correlated within outcome, random effects y5 assumed independent. possible multiple sets response variables separate full variance-covariance matrices used, example:   models multiple levels nesting, separate structures can specified per level:","code":"rd_vcov = list(blockdiag = c(\"y1\", \"y2\"),                full = c(\"y3\", \"y4\"),                indep = \"y5\") rd_vcov = list(full = c(\"y1\", \"y2\", \"y5\"),                full = c(\"y3\", \"y4\")) rd_vcov = list(id = list(blockdiag = c(\"y1\", \"y2\"),                          full = c(\"y3\", \"y4\"),                          indep = \"y5\"),               center = \"indep\")"},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"survival-models-with-frailties-or-time-varying-covariates","dir":"Reference","previous_headings":"","what":"Survival models with frailties or time-varying covariates","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"Random effects specified brackets can also used indicate multi-level structure survival models, , instance needed multi-centre setting, patients multiple hospitals. also allows model time-dependent covariates proportional hazards survival model (using coxph_imp), also combination additional grouping levels. time-dependent proportional hazards models, last-observation-carried-forward used fill missing values time-varying covariates, determine value covariate event time. Preferably, time-varying covariates measured baseline (timevar = 0). value time-varying covariate needs filled previous observation, next observation carried backward.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"differences-to-basic-regression-models","dir":"Reference","previous_headings":"","what":"Differences to basic regression models","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"possible specify transformations outcome variables, .e., possible use model formula like   specific case transformation natural logarithm, log-normal model can used instead normal model. Moreover, possible use . indicate variables data.frame outcome variable used covariates. .e., formula y ~ . valid JointAI.","code":"log(y) ~ x1 + x2 + ..."},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"data-structure","dir":"Reference","previous_headings":"","what":"Data structure","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"multi-level settings, data must long format, repeated measurements recorded separate rows. survival data time-varying covariates (coxph_imp JM_imp) data also long format. survival/censoring times event indicator variables must stored separate variables data constant across rows referring subject. pre-processing data survival/censoring times automatically merged observation times  time-varying covariates (must supplied via argument timevar). possible multiple time-varying covariates, measured time points, can one timevar.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"imputation-methods-model-types","dir":"Reference","previous_headings":"","what":"Imputation methods / model types","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"Implemented model types can chosen argument models baseline covariates (repeatedly measured) : repeatedly measured variables following model types available: models specified subset variables model needed, default model choices (indicated tables) used unspecified variables.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"parameters-to-follow-monitor-params-","dir":"Reference","previous_headings":"","what":"Parameters to follow (monitor_params)","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"See also vignette: Parameter Selection Named vector specifying parameters monitored. can done either directly specifying name parameter indirectly one key words selecting set parameters. Except , parameter names specified directly, parameter (groups) just set TRUE FALSE. Models divided two groups, main models, models user explicitly specified formula (via formula fixed), models, models specified automatically. left unspecified, monitor_params = c(\"analysis_main\" = TRUE) used. example:monitor_params = c(analysis_main = TRUE, tau_main = TRUE, sigma_main = FALSE) monitor regression parameters betas residual precision tau_main instead residual standard deviation sigma_main. linear model, monitor_params = c(imps = TRUE) monitor betas, sigma_main (analysis_main = TRUE default) well imputed values. MathJax = {output: {font: \"mathjax-newcm\", fontPath: \"../../mathjaxr/doc/mathjax/font\",}};","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"cumulative-logit-mixed-models","dir":"Reference","previous_headings":"","what":"Cumulative logit (mixed) models","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"default setting cumulative logit models, .e, rev = NULL, odds variable \\(y\\) \\(K\\) ordered categories defined \\[\\log\\left(\\frac{P(y_i > k)}{P(y_i \\leq k)}\\right) = \\gamma_k + \\eta_i, \\quad k = 1, \\ldots, K-1,\\] \\(\\gamma_k\\) category specific intercept \\(\\eta_i\\) subject specific linear predictor. reverse odds \\[\\log\\left(\\frac{P(y_i \\leq k)}{P(y_i > k)}\\right) = \\gamma_k + \\eta_i, \\quad k = 1, \\ldots, K-1,\\] name response variable specified argument rev, e.g., rev = c(\"y\"). default, proportional odds assumed intercepts differ per category ordinal response. allow non-proportional odds, .e., \\[\\log\\left(\\frac{P(y_i > k)}{P(y_i \\leq k)}\\right) = \\gamma_k + \\eta_i + \\eta_{ki}, \\quad k = 1, \\ldots, K-1,\\] argument nonprop can specified. takes one-sided formula list one-sided formulas. single formula supplied, unnamed list just one element, assumed formula corresponds main model. specify non-proportional effects linear predictors models ordinal covariates, list named names ordinal response variables. example, following three specifications equivalent assume non-proportional effect C1 O1, C1 assumed proportional effect incomplete ordinal covariate O2:   specify non-proportional effects O2, named list provided:   variables non-proportional effect assumed also part regular model formula.","code":"clm_imp(O1 ~ C1 + C2 + B2 + O2, data = wideDF, nonprop = ~ C1) clm_imp(O1 ~ C1 + C2 + B2 + O2, data = wideDF, nonprop = list(~ C1)) clm_imp(O1 ~ C1 + C2 + B2 + O2, data = wideDF, nonprop = list(O1 = ~ C1)) clm_imp(O1 ~ C1 + C2 + B2 + O2 + B1, data = wideDF,         nonprop = list(O1 = ~ C1,                        O2 = ~ C1 + B1))"},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"custom-model-parts","dir":"Reference","previous_headings":"","what":"Custom model parts","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"(Note: feature experimental fully tested yet.) Via argument custom possible provide custom sub-models replace sub-models automatically generated JointAI. Using feature , instance, possible use value repeatedly measured variable specific time point covariate another model. example use \"baseline\" cholesterol (chol day = 0) covariate survival model. First, variable chol0 added PBC data. patients value cholesterol baseline observed, . important data row day = 0 patient.   Next, custom piece JAGS model syntax needs specified. loop patients baseline cholesterol missing.   able run model custom imputation \"model\" baseline cholesterol need provide numbers rows data matrices contain missing values baseline cholesterol rows contain imputed cholesterol day = 0:   pass custom sub-model additional data analysis function coxph_imp(). Note explicitly need specify model chol.","code":"PBC <- merge(PBC,              subset(PBC, day == 0, select = c(\"id\", \"chol\")),              by = \"id\", suffixes = c(\"\", \"0\")) calc_chol0 <- \" for (ii in 1:28) {   M_id[row_chol0_id[ii], 3] <- M_lvlone[row_chol0_lvlone[ii], 1]   }\" row_chol0_lvlone <- which(PBC$day == 0 & is.na(PBC$chol0)) row_chol0_id <- match(PBC$id, unique(PBC$id))[row_chol0_lvlone] coxph_imp(list(Surv(futime, status != \"censored\") ~ age + sex + chol0,                chol ~ age + sex + day + (day | id)),           no_model = \"day\", data = PBC,           append_data_list = list(row_chol0_lvlone = row_chol0_lvlone,                                   row_chol0_id = row_chol0_id),           custom = list(chol0 = calc_chol0))"},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"coding-of-variables-","dir":"Reference","previous_headings":"","what":"Coding of variables:","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"default covariate (imputation) models chosen based class variables, distinguishing numeric, factor two levels, unordered factor >2 levels ordered factor >2 levels. continuous variable two different values assumed binary coding default (imputation) model changed accordingly. behaviour can overwritten specifying model type via argument models. Variables type logical automatically converted unordered factors.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"contrasts","dir":"Reference","previous_headings":"","what":"Contrasts","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"JointAI version \\(\\geq\\) 1.0.0 uses globally (via options(\"contrasts\")) specified contrasts. However, incomplete categorical variables, contrasts need re-calculated within JAGS model, currently contr.treatment contr.sum possible. Therefore, complete ordinal covariate used default contrasts (contr.poly()) set used ordered factors, warning message printed dummy coding (contr.treatment()) used variable instead.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"non-linear-effects-and-transformation-of-variables-","dir":"Reference","previous_headings":"","what":"Non-linear effects and transformation of variables:","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"JointAI handles non-linear effects, transformation covariates interactions following way: , instance, model formula contains function log(x) x missing values, x imputed used linear predictor models formula specified, .e., assumed variables linear association x. log() observed imputed values x calculated used linear predictor main analysis model. , instead using log(x) model formula, pre-calculated variable logx used, variable imputed directly used linear predictors models, implying variables logx linear predictors linear association logx x. different transformations incomplete variable used one model strongly discouraged calculate transformations beforehand supply different variables. , example, model formula contains x x2 (x2 = x^2), treated separate variables imputed separate models. Imputed values x2 thus equal square imputed values x. Instead, x (x^2) used model formula. x imputed x^2 calculated imputed values x internally. applies interactions involving incomplete variables.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"sequence-of-models-","dir":"Reference","previous_headings":"","what":"Sequence of models:","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"Models generated automatically (.e., mentioned formula fixed specified sequence based level outcome respective model multi-level hierarchy within level according number missing values. means level-1 variables level-2, level-3, ... variables linear predictor, variables highest level variables level linear predictor. Within level, variable missing values variables linear predictor.","code":""},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"not-yet-possible-","dir":"Reference","previous_headings":"","what":"Not (yet) possible:","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"prediction (using predict) conditional random effects use splines incomplete variables use (equivalents ) pspline, strata survival models left censored interval censored data","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/model_imp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Joint Analysis and Imputation of incomplete data — model_imp","text":"","code":"# Example 1: Linear regression with incomplete covariates mod1 <- lm_imp(y ~ C1 + C2 + M1 + B1, data = wideDF, n.iter = 100)   # Example 2: Logistic regression with incomplete covariates mod2 <- glm_imp(B1 ~ C1 + C2 + M1, data = wideDF,                 family = binomial(link = \"logit\"), n.iter = 100)  if (FALSE) { # \\dontrun{  # Example 3: Linear mixed model with incomplete covariates mod3 <- lme_imp(y ~ C1 + B2 + c1 + time, random = ~ time|id,                 data = longDF, n.iter = 300)   # Example 4: Parametric Weibull survival model mod4 <- survreg_imp(Surv(time, status) ~ age + sex + meal.cal + wt.loss,                     data = survival::lung, n.iter = 100)   # Example 5: Proportional hazards survival model mod5 <- coxph_imp(Surv(time, status) ~ age + sex + meal.cal + wt.loss,                     data = survival::lung, n.iter = 200)  # Example 6: Joint model for longitudinal and survival data mod6 <- JM_imp(list(Surv(futime, status != 'censored') ~ age + sex +                     albumin + copper + trig + (1 | id),                     albumin ~ day + age + sex + (day | id)),                     timevar = 'day', data = PBC, n.iter = 100)  # Example 7: Proportional hazards  model with a time-dependent covariate mod7 <- coxph_imp(Surv(futime, status != 'censored') ~ age + sex + copper +                   trig + stage + (1 | id),                   timevar = 'day', data = PBC, n.iter = 100)    # Example 8: Parallel computation # If no strategy how the \"future\" should be handled is specified, the # MCMC chains are run sequentially. # To run MCMC chains in parallel, a strategy can be specified using the # package \\pkg{future} (see ?future::plan), for example: future::plan(future::multisession, workers = 4) mod8 <- lm_imp(y ~ C1 + C2 + B2, data = wideDF, n.iter = 500, n.chains = 8) mod8$comp_info$future # To re-set the strategy to sequential computation, the sequential strategy # can be specified: future::plan(future::sequential)  } # }"},{"path":"https://nerler.github.io/JointAI/reference/normalize_formula_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize formula arguments in arglist — normalize_formula_args","title":"Normalize formula arguments in arglist — normalize_formula_args","text":"Normalize formula arguments arglist","code":""},{"path":"https://nerler.github.io/JointAI/reference/normalize_formula_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize formula arguments in arglist — normalize_formula_args","text":"","code":"normalize_formula_args(arglist)"},{"path":"https://nerler.github.io/JointAI/reference/normalize_formula_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize formula arguments in arglist — normalize_formula_args","text":"arglist list containing least formula, fixed, random elements.","code":""},{"path":"https://nerler.github.io/JointAI/reference/normalize_formula_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize formula arguments in arglist — normalize_formula_args","text":"updated arglist formulas converted lists.","code":""},{"path":"https://nerler.github.io/JointAI/reference/normalize_formula_args.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Normalize formula arguments in arglist — normalize_formula_args","text":"Helper function used prep_arglist().","code":""},{"path":"https://nerler.github.io/JointAI/reference/ns.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a Basis Matrix for Natural Cubic Splines — ns","title":"Generate a Basis Matrix for Natural Cubic Splines — ns","text":"function just calls ns() splines package.","code":""},{"path":"https://nerler.github.io/JointAI/reference/ns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a Basis Matrix for Natural Cubic Splines — ns","text":"","code":"ns(x, df = NULL, knots = NULL, intercept = FALSE,   Boundary.knots = range(x))"},{"path":"https://nerler.github.io/JointAI/reference/ns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a Basis Matrix for Natural Cubic Splines — ns","text":"x predictor variable.  Missing values allowed. df degrees freedom.  One can supply df rather     knots; ns() chooses df - 1 - intercept knots     suitably chosen quantiles x (ignore missing     values).  default, df = NULL, sets number     inner knots length(knots). knots breakpoints define spline.  default     knots; together natural boundary conditions results     basis linear regression x.  Typical values     mean median one knot, quantiles knots.  See also     Boundary.knots. intercept TRUE, intercept included     basis; default FALSE. Boundary.knots boundary points impose natural     boundary conditions anchor B-spline basis (default range     data).  knots Boundary.knots     supplied, basis parameters depend x. Data can     extend beyond Boundary.knots","code":""},{"path":"https://nerler.github.io/JointAI/reference/parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameter names of an JointAI object — parameters","title":"Parameter names of an JointAI object — parameters","text":"Returns names parameters/nodes object class 'JointAI' monitor set.","code":""},{"path":"https://nerler.github.io/JointAI/reference/parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameter names of an JointAI object — parameters","text":"","code":"parameters(object, expand_ranef = FALSE, mess = TRUE, warn = TRUE, ...)"},{"path":"https://nerler.github.io/JointAI/reference/parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameter names of an JointAI object — parameters","text":"object object inheriting class 'JointAI' expand_ranef logical; elements random effects vectors/matrices shown separately? mess logical; messages given? Default TRUE. warn logical; warnings given? Default TRUE. ... currently used","code":""},{"path":"https://nerler.github.io/JointAI/reference/parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parameter names of an JointAI object — parameters","text":"","code":"# (This function does not need MCMC samples to work, so we will set # n.adapt = 0 and n.iter = 0 to reduce computational time) mod1 <- lm_imp(y ~ C1 + C2 + M2 + O2 + B2, data = wideDF, n.adapt = 0,                n.iter = 0, mess = FALSE) #> Warning:  #> It is currently not possible to use “contr.poly” for incomplete #> categorical covariates. I will use “contr.treatment” instead.  You can #> specify (globally) which types of contrasts are used by changing #> “options('contrasts')”.  parameters(mod1) #>  #> Note: “mod1” does not contain MCMC samples. #>    outcome outcat     varname     coef #> 1        y   <NA> (Intercept)  beta[1] #> 2        y   <NA>          C1  beta[2] #> 3        y   <NA>          C2  beta[3] #> 4        y   <NA>         M22  beta[4] #> 5        y   <NA>         M23  beta[5] #> 6        y   <NA>         M24  beta[6] #> 7        y   <NA>         O22  beta[7] #> 8        y   <NA>         O23  beta[8] #> 9        y   <NA>         O24  beta[9] #> 10       y   <NA>         B21 beta[10] #> 11       y   <NA>        <NA>  sigma_y"},{"path":"https://nerler.github.io/JointAI/reference/paste_analysis_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Paste analysis type with family information — paste_analysis_type","title":"Paste analysis type with family information — paste_analysis_type","text":"Paste analysis type family information","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_analysis_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Paste analysis type with family information — paste_analysis_type","text":"","code":"paste_analysis_type(analysis_type)"},{"path":"https://nerler.github.io/JointAI/reference/paste_analysis_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Paste analysis type with family information — paste_analysis_type","text":"analysis_type character string, created separate `*-imp()“ functions","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_analysis_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Paste analysis type with family information — paste_analysis_type","text":"character string family link information appended","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Write the coefficient part of a linear predictor — paste_coef","title":"Write the coefficient part of a linear predictor — paste_coef","text":"Write coefficient part linear predictor","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write the coefficient part of a linear predictor — paste_coef","text":"","code":"paste_coef(parname, parelmts)"},{"path":"https://nerler.github.io/JointAI/reference/paste_coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write the coefficient part of a linear predictor — paste_coef","text":"parname character string; name coefficient (e.g., \"beta\") parelmts vector integers; index parameter vector","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_coef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write the coefficient part of a linear predictor — paste_coef","text":"vector character strings form beta[3].","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Write the data element of a linear predictor — paste_data","title":"Write the data element of a linear predictor — paste_data","text":"Write data element linear predictor","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write the data element of a linear predictor — paste_data","text":"","code":"paste_data(matnam, index, col, isgk = FALSE)"},{"path":"https://nerler.github.io/JointAI/reference/paste_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write the data element of a linear predictor — paste_data","text":"matnam characters string; name data matrix index character string; index (e.g., \"\", \"ii\") col integer vector; indices columns matnam isgk logical; within Gauss-Kronrod quadrature?","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write the data element of a linear predictor — paste_data","text":"vector character strings form M_id[, 3] M_id[, 3, k].","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_linpred.html","id":null,"dir":"Reference","previous_headings":"","what":"Write a linear predictor — paste_linpred","title":"Write a linear predictor — paste_linpred","text":"Construct linear predictor parameter names indices, name data matrix corresponding columns, apply scaling data necessary.","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_linpred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write a linear predictor — paste_linpred","text":"","code":"paste_linpred(parname, parelmts, matnam, index, cols, scale_pars,   isgk = FALSE)"},{"path":"https://nerler.github.io/JointAI/reference/paste_linpred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write a linear predictor — paste_linpred","text":"parname character string; name fo parameter (e.g., \"beta\") parelmts integer vector; indices parameter vector used; length cols matnam character string; name data matrix index character string; name index (e.g., \"\" \"ii\") cols integer vector; indices columns matname, length parlemts scale_pars matrix row names according column names matname columns \"center\" \"scale\"; NULL isgk logical; linear predictor within Gauss-Kronrod quadrature?","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Create the scaling in a data element of a linear predictor — paste_scale","title":"Create the scaling in a data element of a linear predictor — paste_scale","text":"Create scaling data element linear predictor","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create the scaling in a data element of a linear predictor — paste_scale","text":"","code":"paste_scale(x, row, scalemat)"},{"path":"https://nerler.github.io/JointAI/reference/paste_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create the scaling in a data element of a linear predictor — paste_scale","text":"x character string row integer; indicating row scalemat used scalemat character string; name matrix containing scaling information (e.g., \"spM_lvlone\"). matrix assumed columns \"center\" \"scale\".","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create the scaling in a data element of a linear predictor — paste_scale","text":"character string form (x - center)/scale.","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_scaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrap a data element of a linear predictor in scaling syntax — paste_scaling","title":"Wrap a data element of a linear predictor in scaling syntax — paste_scaling","text":"Identifies data element linear predictor scaled (based whether scaling parameters given) calls paste_scale().","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_scaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrap a data element of a linear predictor in scaling syntax — paste_scaling","text":"","code":"paste_scaling(x, rows, scale_pars, scalemat)"},{"path":"https://nerler.github.io/JointAI/reference/paste_scaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrap a data element of a linear predictor in scaling syntax — paste_scaling","text":"x vector character strings; scaled, typically matrix columns rows integer vector; row numbers matrix containing scaling information scale_pars matrix containing scaling information, columns \"center\" \"scale\" scalemat name scaling matrix JAGS model (e.g. \"spM_id\")","code":""},{"path":"https://nerler.github.io/JointAI/reference/paste_scaling.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wrap a data element of a linear predictor in scaling syntax — paste_scaling","text":"Calls paste_scale() element x.","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot.JointAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an object object inheriting from class 'JointAI' — plot.JointAI","title":"Plot an object object inheriting from class 'JointAI' — plot.JointAI","text":"Plot object object inheriting class 'JointAI'","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot.JointAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an object object inheriting from class 'JointAI' — plot.JointAI","text":"","code":"# S3 method for class 'JointAI' plot(x, ...)"},{"path":"https://nerler.github.io/JointAI/reference/plot.JointAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an object object inheriting from class 'JointAI' — plot.JointAI","text":"x object inheriting class 'JointAI' ... currently used","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot.JointAI.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Plot an object object inheriting from class 'JointAI' — plot.JointAI","text":"Currently, plot() can used (generalized) linear (mixed) models.","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot.JointAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot an object object inheriting from class 'JointAI' — plot.JointAI","text":"","code":"mod <- lm_imp(y ~ C1 + C2 + B1, data = wideDF, n.iter = 100) plot(mod)"},{"path":"https://nerler.github.io/JointAI/reference/plot_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize the distribution of all variables in the dataset — plot_all","title":"Visualize the distribution of all variables in the dataset — plot_all","text":"function plots grid histograms (continuous variables) bar plots (categorical variables) labels proportion missing values variable.","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize the distribution of all variables in the dataset — plot_all","text":"","code":"plot_all(data, nrow = NULL, ncol = NULL, fill = grDevices::grey(0.8),   border = \"black\", allNA = FALSE, idvars = NULL, xlab = \"\",   ylab = \"frequency\", ...)"},{"path":"https://nerler.github.io/JointAI/reference/plot_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize the distribution of all variables in the dataset — plot_all","text":"data data.frame (matrix) nrow optional; number rows plot layout; automatically chosen unspecified ncol optional; number columns plot layout; automatically chosen unspecified fill colour histograms bars filled border colour borders histograms bars allNA logical; FALSE (default) proportion missing values given variables missing values, TRUE given variables idvars name column specifies multi-level grouping structure xlab, ylab labels x- y-axis ... additional parameters passed barplot hist","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/plot_all.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize the distribution of all variables in the dataset — plot_all","text":"","code":"op <- par(mar = c(2,2,3,1), mgp = c(2, 0.6, 0)) plot_all(wideDF)  par(op)"},{"path":"https://nerler.github.io/JointAI/reference/plot_imp_distr.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the distribution of observed and imputed values — plot_imp_distr","title":"Plot the distribution of observed and imputed values — plot_imp_distr","text":"Plots densities bar plots observed imputed values long-format dataset (multiple imputed datasets stacked onto ).","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot_imp_distr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the distribution of observed and imputed values — plot_imp_distr","text":"","code":"plot_imp_distr(data, imp = \"Imputation_\", id = \".id\", rownr = \".rownr\",   ncol = NULL, nrow = NULL, labeller = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/plot_imp_distr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the distribution of observed and imputed values — plot_imp_distr","text":"data data.frame containing multiple imputations original incomplete data stacked onto imp name variable specifying imputation indicator id name variable specifying subject indicator rownr name variable identifying rows correspond observation original (un-imputed) data ncol optional; number columns plot layout; automatically chosen unspecified nrow optional; number rows plot layout; automatically chosen unspecified labeller optional labeller passed ggplot2::facet_wrap() change facet labels","code":""},{"path":"https://nerler.github.io/JointAI/reference/plot_imp_distr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the distribution of observed and imputed values — plot_imp_distr","text":"","code":"if (FALSE) { # \\dontrun{ mod <- lme_imp(y ~ C1 + c2 + B2 + C2, random = ~ 1 | id, data = longDF,                n.iter = 200, monitor_params = c(imps = TRUE), mess = FALSE) impDF <- get_MIdat(mod, m = 5) plot_imp_distr(impDF, id = \"id\", ncol = 3) } # }"},{"path":"https://nerler.github.io/JointAI/reference/predDF.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new data frame for prediction — predDF","title":"Create a new data frame for prediction — predDF","text":"Build data.frame prediction, one variable varies variables set reference value (median continuous variables).","code":""},{"path":"https://nerler.github.io/JointAI/reference/predDF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new data frame for prediction — predDF","text":"","code":"predDF(object, ...)  # S3 method for class 'JointAI' predDF(object, vars, length = 100L, ...)  # S3 method for class 'formula' predDF(object, data, vars, length = 100L, ...)  # S3 method for class 'list' predDF(object, data, vars, length = 100L, idvar = NULL, ...)"},{"path":"https://nerler.github.io/JointAI/reference/predDF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new data frame for prediction — predDF","text":"object object inheriting class 'JointAI' ... optional specification values used () variables given vars vars name variable varying length number values used sequence vars continuous data data.frame containing original data (details ) idvar optional name ID variable","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/predDF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new data frame for prediction — predDF","text":"","code":"# fit a JointAI model mod <- lm_imp(y ~ C1 + C2 + M2, data = wideDF, n.iter = 100)  # generate a data frame with varying \"C2\" and reference values for all other # variables in the model newDF <- predDF(mod, vars = ~ C2)  head(newDF) #>           y       C1         C2 M2 #> 1 -3.183137 1.434298 -0.9226220  1 #> 2 -3.183137 1.434298 -0.9046136  1 #> 3 -3.183137 1.434298 -0.8866052  1 #> 4 -3.183137 1.434298 -0.8685968  1 #> 5 -3.183137 1.434298 -0.8505885  1 #> 6 -3.183137 1.434298 -0.8325801  1   newDF2 <- predDF(mod, vars = ~ C2 + M2,                  C2 = seq(-0.5, 0.5, 0.25),                  M2 = levels(wideDF$M2)[2:3]) newDF2 #>            y       C1    C2 M2 #> 1  -3.183137 1.434298 -0.50  2 #> 2  -3.183137 1.434298 -0.25  2 #> 3  -3.183137 1.434298  0.00  2 #> 4  -3.183137 1.434298  0.25  2 #> 5  -3.183137 1.434298  0.50  2 #> 6  -3.183137 1.434298 -0.50  3 #> 7  -3.183137 1.434298 -0.25  3 #> 8  -3.183137 1.434298  0.00  3 #> 9  -3.183137 1.434298  0.25  3 #> 10 -3.183137 1.434298  0.50  3"},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict values from an object of class JointAI — predict.JointAI","title":"Predict values from an object of class JointAI — predict.JointAI","text":"Obtains predictions corresponding credible intervals object class 'JointAI'.","code":""},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict values from an object of class JointAI — predict.JointAI","text":"","code":"# S3 method for class 'JointAI' predict(object, outcome = 1L, newdata,   quantiles = c(0.025, 0.975), type = \"lp\", start = NULL, end = NULL,   thin = NULL, exclude_chains = NULL, mess = TRUE, warn = TRUE,   return_sample = FALSE, ...)"},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict values from an object of class JointAI — predict.JointAI","text":"object object inheriting class 'JointAI' outcome vector variable names integers identifying outcome(s) prediction performed. newdata optional new dataset prediction. left empty, original data used. quantiles quantiles predicted distribution outcome type type prediction. default scale linear predictor (\"link\" \"lp\"). Additionally, generalized linear (mixed) models (incl. beta log-normal) type = \"response\" transforms predicted values scale response, ordinal multinomial (mixed) models type may \"prob\" (obtain probabilities per class), \"class\" obtain class highest posterior probability, \"lp\". parametric survival models type can \"lp\"  \"response\", proportional hazards survival models options \"lp\", \"risk\" (= exp(lp)), \"survival\" \"expected\" (= -log(survival)). start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. exclude_chains optional vector index numbers chains excluded mess logical; messages given? Default TRUE. warn logical; warnings given? Default TRUE. return_sample logical; full sample summary (mean quantiles) calculated returned?#' ... currently used","code":""},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict values from an object of class JointAI — predict.JointAI","text":"list entries dat, fit quantiles, fit contains predicted values (mean values calculated iterations MCMC sample), quantiles contain specified quantiles (default 2.5% 97.5%), dat newdata, extended fit quantiles (unless prediction ordinal outcome done type = \"prob\", case quantiles array three dimensions therefore included dat).","code":""},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict values from an object of class JointAI — predict.JointAI","text":"model.matrix \\(X\\) created model formula (currently fixed effects ) newdata. \\(X\\beta\\) calculated iteration MCMC sample object, .e., \\(X\\beta\\) n.iter rows nrow(newdata) columns. subset MCMC sample can selected using start, end  thin.","code":""},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Predict values from an object of class JointAI — predict.JointAI","text":"far, predict calculate predicted values cases missing values covariates. Predicted values cases NA. repeated measures models prediction currently uses fixed effects. Functionality extended future.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/predict.JointAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict values from an object of class JointAI — predict.JointAI","text":"","code":"# fit model mod <- lm_imp(y ~ C1 + C2 + I(C2^2), data = wideDF, n.iter = 100)  # calculate the fitted values fit <- predict(mod) #> Warning:  #> Prediction for cases with missing covariates is not yet implemented.  I #>       will report “NA” instead of predicted values for those cases.  # create dataset for prediction newDF <- predDF(mod, vars = ~ C2)  # obtain predicted values pred <- predict(mod, newdata = newDF)  # plot predicted values and 95% confidence band matplot(newDF$C2, pred$fitted, lty = c(1, 2, 2), type = \"l\", col = 1, xlab = 'C2', ylab = 'predicted values')"},{"path":"https://nerler.github.io/JointAI/reference/prep_arglist.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare list of arguments for model_imp() — prep_arglist","title":"Prepare list of arguments for model_imp() — prep_arglist","text":"Prepare list arguments model_imp()","code":""},{"path":"https://nerler.github.io/JointAI/reference/prep_arglist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare list of arguments for model_imp() — prep_arglist","text":"","code":"prep_arglist(analysis_type, family = NULL, formals = formals(),   call = match.call(), sframe = sys.frame(sys.nframe()))"},{"path":"https://nerler.github.io/JointAI/reference/prep_arglist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare list of arguments for model_imp() — prep_arglist","text":"analysis_type Type analysis performed (*_imp()) family family object character string specifying error distribution link function. formals List formal arguments function. call matched call returned match.call(). sframe environment (typically sys.frame(sys.nframe()))","code":""},{"path":"https://nerler.github.io/JointAI/reference/prep_arglist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare list of arguments for model_imp() — prep_arglist","text":"list arguments prepared model_imp(), including analysis type, family, formulas, relevant parameters.","code":""},{"path":"https://nerler.github.io/JointAI/reference/rd_terms_by_grouping.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract terms by grouping variables from a formula — rd_terms_by_grouping","title":"Extract terms by grouping variables from a formula — rd_terms_by_grouping","text":"function takes formula input, extracts terms associated grouping variables, organizes grouping variable.","code":""},{"path":"https://nerler.github.io/JointAI/reference/rd_terms_by_grouping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract terms by grouping variables from a formula — rd_terms_by_grouping","text":"","code":"rd_terms_by_grouping(formula)"},{"path":"https://nerler.github.io/JointAI/reference/rd_terms_by_grouping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract terms by grouping variables from a formula — rd_terms_by_grouping","text":"formula formula object","code":""},{"path":"https://nerler.github.io/JointAI/reference/rd_terms_by_grouping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract terms by grouping variables from a formula — rd_terms_by_grouping","text":"named list one-sided formulas, name corresponds grouping variable formula contains terms associated grouping variable.","code":""},{"path":"https://nerler.github.io/JointAI/reference/rd_vcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the random effects variance covariance matrix — rd_vcov","title":"Extract the random effects variance covariance matrix — rd_vcov","text":"Returns posterior mean variance-covariance matrix/matrices random effects fitted JointAI object.","code":""},{"path":"https://nerler.github.io/JointAI/reference/rd_vcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the random effects variance covariance matrix — rd_vcov","text":"","code":"rd_vcov(object, outcome = NULL, start = NULL, end = NULL, thin = NULL,   exclude_chains = NULL, mess = TRUE, warn = TRUE)"},{"path":"https://nerler.github.io/JointAI/reference/rd_vcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the random effects variance covariance matrix — rd_vcov","text":"object object inheriting class 'JointAI' outcome optional; vector integers giving indices outcomes random effects variance-covariance matrix/matrices returned. start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. exclude_chains optional vector index numbers chains excluded mess logical; messages given? Default TRUE. warn logical; warnings given? Default TRUE.","code":""},{"path":"https://nerler.github.io/JointAI/reference/reformat_difftime.html","id":null,"dir":"Reference","previous_headings":"","what":"Set all elements of a difftime object to the same, largest meaningful unit — reformat_difftime","title":"Set all elements of a difftime object to the same, largest meaningful unit — reformat_difftime","text":"Set elements difftime object , largest meaningful unit","code":""},{"path":"https://nerler.github.io/JointAI/reference/reformat_difftime.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set all elements of a difftime object to the same, largest meaningful unit — reformat_difftime","text":"","code":"reformat_difftime(dt)"},{"path":"https://nerler.github.io/JointAI/reference/reformat_difftime.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set all elements of a difftime object to the same, largest meaningful unit — reformat_difftime","text":"dt difftime object (potentially vector difftimes)","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_formula_grouping.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove grouping part from (random effects) formula — remove_formula_grouping","title":"Remove grouping part from (random effects) formula — remove_formula_grouping","text":"Removes part (including) pipe symbol (|) formula.","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_formula_grouping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove grouping part from (random effects) formula — remove_formula_grouping","text":"","code":"remove_formula_grouping(formula)"},{"path":"https://nerler.github.io/JointAI/reference/remove_formula_grouping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove grouping part from (random effects) formula — remove_formula_grouping","text":"formula formula object (list formulas)","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_formula_grouping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove grouping part from (random effects) formula — remove_formula_grouping","text":"list one-sided formula objects without grouping part, split grouping variable","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/remove_grouping.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove grouping part from (random effects) formulas — remove_grouping","title":"Remove grouping part from (random effects) formulas — remove_grouping","text":"Applies remove_formula_grouping() list formulas.","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_grouping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove grouping part from (random effects) formulas — remove_grouping","text":"","code":"remove_grouping(formulas)"},{"path":"https://nerler.github.io/JointAI/reference/remove_grouping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove grouping part from (random effects) formulas — remove_grouping","text":"formulas list formula objects (NULL)","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_grouping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove grouping part from (random effects) formulas — remove_grouping","text":"list formula objects without grouping part","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/remove_lhs.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove the left hand side of a (list of) formula(s) — remove_lhs","title":"Remove the left hand side of a (list of) formula(s) — remove_lhs","text":"Internal function; used divide_matrices, get_models help functions (2022-02-05)","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_lhs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove the left hand side of a (list of) formula(s) — remove_lhs","text":"","code":"remove_lhs(formula)"},{"path":"https://nerler.github.io/JointAI/reference/remove_lhs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove the left hand side of a (list of) formula(s) — remove_lhs","text":"formula formula object list formula objects","code":""},{"path":"https://nerler.github.io/JointAI/reference/remove_lhs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove the left hand side of a (list of) formula(s) — remove_lhs","text":"formula object list formula objects.","code":""},{"path":"https://nerler.github.io/JointAI/reference/replace_nan_with_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace NaN values with NA — replace_nan_with_na","title":"Replace NaN values with NA — replace_nan_with_na","text":"Replace NaN values NA","code":""},{"path":"https://nerler.github.io/JointAI/reference/replace_nan_with_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace NaN values with NA — replace_nan_with_na","text":"","code":"replace_nan_with_na(x)"},{"path":"https://nerler.github.io/JointAI/reference/replace_nan_with_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace NaN values with NA — replace_nan_with_na","text":"x vector (also works matrices scalars)","code":""},{"path":"https://nerler.github.io/JointAI/reference/replace_nan_with_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace NaN values with NA — replace_nan_with_na","text":"vector (object like input) NaN values replaced NA","code":""},{"path":"https://nerler.github.io/JointAI/reference/residuals.JointAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract residuals from an object of class JointAI — residuals.JointAI","title":"Extract residuals from an object of class JointAI — residuals.JointAI","text":"Extract residuals object class JointAI","code":""},{"path":"https://nerler.github.io/JointAI/reference/residuals.JointAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract residuals from an object of class JointAI — residuals.JointAI","text":"","code":"# S3 method for class 'JointAI' residuals(object, type = c(\"working\", \"pearson\",   \"response\"), warn = TRUE, ...)"},{"path":"https://nerler.github.io/JointAI/reference/residuals.JointAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract residuals from an object of class JointAI — residuals.JointAI","text":"object object inheriting class 'JointAI' type type residuals: \"deviance\", \"response\", \"working\" warn logical; warnings given? Default TRUE. ... currently used","code":""},{"path":"https://nerler.github.io/JointAI/reference/residuals.JointAI.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Extract residuals from an object of class JointAI — residuals.JointAI","text":"mixed models residuals currently calculated using fixed effects . ordinal (mixed) models parametric survival models type = \"response\" available. Cox proportional hazards models residuals yet implemented.","code":""},{"path":"https://nerler.github.io/JointAI/reference/residuals.JointAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract residuals from an object of class JointAI — residuals.JointAI","text":"","code":"mod <- glm_imp(B1 ~ C1 + C2 + O1, data = wideDF, n.iter = 100,                family = binomial(), mess = FALSE) summary(residuals(mod, type = 'response')[[1]]) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>  0.1469  0.1469  0.1469  0.1469  0.1469  0.1469  summary(residuals(mod, type = 'working')[[1]]) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>   1.172   1.172   1.172   1.172   1.172   1.172"},{"path":"https://nerler.github.io/JointAI/reference/resolve_family_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Resolve family object — resolve_family_obj","title":"Resolve family object — resolve_family_obj","text":"Converts family specification (character string, function, family object) family object.","code":""},{"path":"https://nerler.github.io/JointAI/reference/resolve_family_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resolve family object — resolve_family_obj","text":"","code":"resolve_family_obj(family)"},{"path":"https://nerler.github.io/JointAI/reference/resolve_family_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resolve family object — resolve_family_obj","text":"family Family object, character string, function.","code":""},{"path":"https://nerler.github.io/JointAI/reference/resolve_family_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resolve family object — resolve_family_obj","text":"family object NULL.","code":""},{"path":"https://nerler.github.io/JointAI/reference/resolve_family_obj.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Resolve family object — resolve_family_obj","text":"Helper function used prep_arglist().","code":""},{"path":"https://nerler.github.io/JointAI/reference/set_refcat.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify reference categories for all categorical covariates in the model — set_refcat","title":"Specify reference categories for all categorical covariates in the model — set_refcat","text":"function helper function asks questions , depending answers given user, returns input argument refcats main analysis functions *_imp.","code":""},{"path":"https://nerler.github.io/JointAI/reference/set_refcat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify reference categories for all categorical covariates in the model — set_refcat","text":"","code":"set_refcat(data, formula, covars, auxvars = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/set_refcat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify reference categories for all categorical covariates in the model — set_refcat","text":"data data.frame formula optional; model formula list formulas (used select subset relevant columns data) covars optional; vector containing names relevant columns data auxvars optional; formula containing names relevant columns data considered additionally columns occurring formula","code":""},{"path":"https://nerler.github.io/JointAI/reference/set_refcat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify reference categories for all categorical covariates in the model — set_refcat","text":"arguments formula, covars auxvars can used specify subset data considered. non arguments specified, variables data considered.","code":""},{"path":"https://nerler.github.io/JointAI/reference/set_refcat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify reference categories for all categorical covariates in the model — set_refcat","text":"","code":"if (FALSE) { # \\dontrun{ # Example 1: set reference categories for the whole dataset and choose # answer option 3: set_refcat(data = NHANES) 3  # insert the returned string as argument refcats mod1 <- lm_imp(SBP ~ age + race + creat + educ, data = NHANES,                refcats = 'largest')  # Example 2: # specify a model formula fmla <- SBP ~ age + gender + race + bili + smoke + alc  # write the output of set_refcat to an object ref_mod2 <- set_refcat(data = NHANES, formula = fmla) 4 2 5 1 1  # enter the output in the model specification mod2 <- lm_imp(formula = fmla, data = NHANES, refcats = ref_mod2,                n.adapt = 0) } # }"},{"path":"https://nerler.github.io/JointAI/reference/sharedParams.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameters used by several functions in JointAI — sharedParams","title":"Parameters used by several functions in JointAI — sharedParams","text":"Parameters used several functions JointAI","code":""},{"path":"https://nerler.github.io/JointAI/reference/sharedParams.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameters used by several functions in JointAI — sharedParams","text":"object object inheriting class 'JointAI' no_model optional; vector names variables model specified. Note possible completely observed variables implies assumptions independence excluded variable incomplete variables. timevar name variable indicating time measurement time-varying covariate proportional hazards survival model (also joint model). variable specified \"timevar\" automatically added \"no_model\". assoc_type named vector specifying type association used time-varying covariate linear predictor survival model using \"JM\" model. Implemented options \"underl.value\" (linear predictor; default covariates modelled using Gaussian, Gamma, beta log-normal distribution) covariates) \"obs.value\" (observed/imputed value; default covariates modelled using distributions). subset subset parameters/variables/nodes (columns MCMC sample). Follows principle argument monitor_params *_imp. exclude_chains optional vector index numbers chains excluded start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) n.adapt number iterations adaptation MCMC samplers (see adapt) n.iter number iterations MCMC chain (adaptation; see coda.samples) n.chains number MCMC chains quiet logical; TRUE messages generated rjags compilation well progress bar adaptive phase suppressed, (see jags.model) progress.bar character string specifying type progress bar. Possible values \"text\" (default), \"gui\", \"none\" (see update). Note: sampling performed parallel possible display progress bar. thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. nrow optional; number rows plot layout; automatically chosen unspecified ncol optional; number columns plot layout; automatically chosen unspecified use_ggplot logical; ggplot used instead base graphics? warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE. xlab, ylab labels x- y-axis idvars name column specifies multi-level grouping structure seed optional; seed value (reproducibility) ppc logical: monitors posterior predictive checks set? (yet used) rd_vcov optional character string list (lists character strings) specifying structure variance covariance matrix/matrices random effects multivariate mixed models. Options  \"full, \"blockdiag\" (default) \"indep\". Different structures can specified per grouping level (multi-level models two levels) specifying list elements per grouping level. specify different structures different outcomes, list (maybe nested list per grouping level) can specified. list type structure names contain vectors variable names belong respective structure.","code":""},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Longitudinal Data in Long and Wide Format — simLong","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"data simulated mimic data longitudinal cohort study following mothers child birth approximately 4 years age. contains 2400 observations 200 mother-child pairs. Children's BMI head circumference measured repeatedly age months recorded measurement. Furthermore, data contain several baseline variables information mothers' demographics socio-economic status.","code":""},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"","code":"simLong  simWide"},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"simLong: data frame long format 2400 rows 16 variables simWide: data frame wide format 200 rows 81 variables object class data.frame 2400 rows 16 columns. object class data.frame 200 rows 81 columns.","code":""},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":"baseline-covariates","dir":"Reference","previous_headings":"","what":"Baseline covariates","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"(simLong simWide) GESTBIR gestational age birth (weeks) ETHN ethnicity (binary: European vs. ) AGE_M age mother intake HEIGHT_M height mother (cm) PARITY number times mother given birth (binary: 0 vs. >=1) SMOKE smoking status mother pregnancy (3 ordered categories: never smoked pregnancy, smoked pregnancy known, continued smoking pregnancy) EDUC educational level mother (3 ordered categories: low, mid, high) MARITAL marital status (3 categories) ID subject identifier","code":""},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":"long-format-variables","dir":"Reference","previous_headings":"","what":"Long-format variables","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"(simLong) time measurement occasion/visit (design, children measured /around 1, 2, 3, 4, 7, 11, 15, 20, 26, 32, 40 50 months age) age child age measurement time months bmi child BMI hc child head circumference cm hgt child height cm wgt child weight gram sleep sleeping behaviour child (3 ordered categories)","code":""},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":"wide-format-variables","dir":"Reference","previous_headings":"","what":"Wide-format variables","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"(simWide) age1, age2, age3, age4, age7, age11, age15, age20, age26, age32, age40, age50 child age repeated measurements months bmi1, bmi2, bmi3, bmi4, bmi7, bmi11, bmi15, bmi20, bmi26, bmi32, bmi40, bmi50 repeated measurements child BMI hc1, hc2, hc3, hc4, hc7, hc11, hc15, hc20, hc26, hc32, hc40, hc50 repeated measurements child head circumference cm hgt1, hgt2, hgt3, hgt4, hgt7, hgt11, hgt15, hgt20, hgt26, hgt32, hgt40, hgt50 repeated measurements child height cm wgt1, wgt2, wgt3, wgt4, wgt7, wgt11, wgt15, wgt20, wgt26, wgt32, wgt40, wgt50 repeated measurements child weight gram sleep1, sleep2, sleep3, sleep4, sleep7, sleep11, sleep15, sleep20, sleep26, sleep32, sleep40, sleep50 repeated measurements child sleep behaviour (3 ordered categories)","code":""},{"path":"https://nerler.github.io/JointAI/reference/simLong.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Longitudinal Data in Long and Wide Format — simLong","text":"","code":"summary(simLong) #>     GESTBIR            ETHN          AGE_M          HEIGHT_M      PARITY     #>  Min.   :37.21   European:1620   Min.   :16.40   Min.   :151.7   0   :1440   #>  1st Qu.:39.30   other   : 708   1st Qu.:26.91   1st Qu.:163.6   >= 1: 888   #>  Median :40.17   NA's    :  72   Median :30.26   Median :169.1   NA's:  72   #>  Mean   :40.23                   Mean   :30.34   Mean   :168.8               #>  3rd Qu.:41.04                   3rd Qu.:33.90   3rd Qu.:173.9               #>  Max.   :44.49                   Max.   :47.07   Max.   :185.2               #>                                                  NA's   :48                  #>                               SMOKE        EDUC                 MARITAL     #>  never smoked during pregnancy   :1620   high:1104   married        :1212   #>  smoked until pregnancy was known: 132   mid : 876   living together: 768   #>  continued smoking in pregnancy  : 372   low : 228   no partner     : 228   #>  NA's                            : 276   NA's: 192   NA's           : 192   #>                                                                             #>                                                                             #>                                                                             #>       time            age               bmi              hc        #>  Min.   : 1.00   Min.   : 0.5086   Min.   :10.82   Min.   :31.83   #>  1st Qu.: 3.75   1st Qu.: 3.9900   1st Qu.:15.85   1st Qu.:41.63   #>  Median :13.00   Median :12.8095   Median :16.64   Median :45.59   #>  Mean   :17.58   Mean   :16.7850   Mean   :16.55   Mean   :45.33   #>  3rd Qu.:27.50   3rd Qu.:28.4537   3rd Qu.:17.37   3rd Qu.:49.07   #>  Max.   :50.00   Max.   :48.8542   Max.   :19.65   Max.   :56.43   #>                                    NA's   :519     NA's   :567     #>       hgt              wgt               sleep          ID            #>  Min.   : 48.83   Min.   : 2353   no problem:717   Length:2400        #>  1st Qu.: 64.97   1st Qu.: 6701   sometimes :915   Class :character   #>  Median : 78.80   Median : 9902   difficult :176   Mode  :character   #>  Mean   : 78.96   Mean   :10295   NA's      :592                      #>  3rd Qu.: 91.58   3rd Qu.:13460                                       #>  Max.   :116.83   Max.   :23855                                       #>  NA's   :479      NA's   :210                                          summary(simWide) #>     GESTBIR            ETHN         AGE_M          HEIGHT_M      PARITY    #>  Min.   :37.21   European:135   Min.   :16.40   Min.   :151.7   0   :120   #>  1st Qu.:39.30   other   : 59   1st Qu.:26.91   1st Qu.:163.6   >= 1: 74   #>  Median :40.17   NA's    :  6   Median :30.26   Median :169.1   NA's:  6   #>  Mean   :40.23                  Mean   :30.34   Mean   :168.8              #>  3rd Qu.:41.04                  3rd Qu.:33.90   3rd Qu.:173.9              #>  Max.   :44.49                  Max.   :47.07   Max.   :185.2              #>                                                 NA's   :4                  #>                               SMOKE       EDUC               MARITAL    #>  never smoked during pregnancy   :135   high:92   married        :101   #>  smoked until pregnancy was known: 11   mid :73   living together: 64   #>  continued smoking in pregnancy  : 31   low :19   no partner     : 19   #>  NA's                            : 23   NA's:16   NA's           : 16   #>                                                                         #>                                                                         #>                                                                         #>       ID                 age1             bmi1            hc1        #>  Length:200         Min.   :0.5086   Min.   :11.81   Min.   :31.83   #>  Class :character   1st Qu.:0.9767   1st Qu.:14.30   1st Qu.:36.43   #>  Mode  :character   Median :1.1596   Median :15.18   Median :37.28   #>                     Mean   :1.1341   Mean   :15.30   Mean   :37.30   #>                     3rd Qu.:1.2787   3rd Qu.:16.32   3rd Qu.:38.29   #>                     Max.   :1.8476   Max.   :19.22   Max.   :40.87   #>                                                      NA's   :26      #>       hgt1            wgt1             sleep1        age2            bmi2       #>  Min.   :48.83   Min.   :2353   no problem:28   Min.   :2.004   Min.   :12.43   #>  1st Qu.:53.32   1st Qu.:4092   sometimes :89   1st Qu.:2.209   1st Qu.:15.20   #>  Median :55.01   Median :4680   difficult :32   Median :2.363   Median :16.13   #>  Mean   :54.97   Mean   :4680   NA's      :51   Mean   :2.387   Mean   :16.11   #>  3rd Qu.:56.66   3rd Qu.:5263                   3rd Qu.:2.511   3rd Qu.:16.96   #>  Max.   :60.69   Max.   :6432                   Max.   :2.984   Max.   :20.00   #>  NA's   :56      NA's   :12                                                     #>       hc2             hgt2            wgt2             sleep2        age3       #>  Min.   :36.97   Min.   :53.48   Min.   :3738   no problem:45   Min.   :3.002   #>  1st Qu.:39.25   1st Qu.:57.52   1st Qu.:5248   sometimes :89   1st Qu.:3.251   #>  Median :40.28   Median :59.25   Median :5683   difficult :22   Median :3.385   #>  Mean   :40.22   Mean   :59.24   Mean   :5763   NA's      :44   Mean   :3.419   #>  3rd Qu.:41.03   3rd Qu.:60.83   3rd Qu.:6342                   3rd Qu.:3.583   #>  Max.   :43.85   Max.   :65.46   Max.   :7561                   Max.   :3.951   #>  NA's   :43      NA's   :87      NA's   :29                                     #>       bmi3            hc3             hgt3            wgt3             sleep3   #>  Min.   :13.14   Min.   :38.34   Min.   :56.61   Min.   :4338   no problem:42   #>  1st Qu.:15.77   1st Qu.:40.71   1st Qu.:60.48   1st Qu.:5978   sometimes :85   #>  Median :16.79   Median :41.48   Median :61.83   Median :6429   difficult :21   #>  Mean   :16.82   Mean   :41.63   Mean   :62.07   Mean   :6487   NA's      :52   #>  3rd Qu.:17.78   3rd Qu.:42.55   3rd Qu.:63.82   3rd Qu.:6975                   #>  Max.   :20.83   Max.   :45.72   Max.   :68.26   Max.   :8785                   #>                  NA's   :28      NA's   :63      NA's   :17                     #>       age4            bmi4            hc4             hgt4            wgt4      #>  Min.   :4.003   Min.   :13.56   Min.   :39.21   Min.   :58.22   Min.   :4909   #>  1st Qu.:4.251   1st Qu.:16.26   1st Qu.:41.51   1st Qu.:62.38   1st Qu.:6435   #>  Median :4.390   Median :17.10   Median :42.34   Median :64.07   Median :6917   #>  Mean   :4.427   Mean   :17.08   Mean   :42.48   Mean   :64.24   Mean   :6948   #>  3rd Qu.:4.589   3rd Qu.:18.01   3rd Qu.:43.51   3rd Qu.:66.20   3rd Qu.:7520   #>  Max.   :4.993   Max.   :20.88   Max.   :46.25   Max.   :70.75   Max.   :9227   #>                                  NA's   :45      NA's   :87      NA's   :28     #>         sleep4         age7            bmi7            hc7        #>  no problem: 37   Min.   :5.038   Min.   :13.48   Min.   :40.52   #>  sometimes :100   1st Qu.:5.772   1st Qu.:16.32   1st Qu.:42.84   #>  difficult : 28   Median :6.278   Median :17.40   Median :43.93   #>  NA's      : 35   Mean   :6.260   Mean   :17.33   Mean   :43.89   #>                   3rd Qu.:6.724   3rd Qu.:18.20   3rd Qu.:45.03   #>                   Max.   :8.005   Max.   :20.63   Max.   :47.66   #>                                                   NA's   :30      #>       hgt7            wgt7              sleep7       age11       #>  Min.   :61.38   Min.   : 5446   no problem:24   Min.   :10.11   #>  1st Qu.:65.70   1st Qu.: 7165   sometimes :93   1st Qu.:10.74   #>  Median :67.51   Median : 7851   difficult :26   Median :11.17   #>  Mean   :67.58   Mean   : 7831   NA's      :57   Mean   :11.18   #>  3rd Qu.:69.53   3rd Qu.: 8513                   3rd Qu.:11.57   #>  Max.   :74.28   Max.   :10786                   Max.   :12.44   #>  NA's   :36      NA's   :16                                      #>      bmi11            hc11           hgt11           wgt11       #>  Min.   :12.49   Min.   :42.61   Min.   :68.36   Min.   : 7018   #>  1st Qu.:16.47   1st Qu.:44.78   1st Qu.:72.13   1st Qu.: 8760   #>  Median :17.49   Median :45.71   Median :74.13   Median : 9577   #>  Mean   :17.38   Mean   :45.95   Mean   :74.43   Mean   : 9574   #>  3rd Qu.:18.31   3rd Qu.:47.22   3rd Qu.:76.66   3rd Qu.:10326   #>  Max.   :21.11   Max.   :50.62   Max.   :82.79   Max.   :12566   #>                  NA's   :28      NA's   :17      NA's   :13      #>        sleep11        age15           bmi15            hc15       #>  no problem: 37   Min.   :13.18   Min.   :13.76   Min.   :42.94   #>  sometimes :100   1st Qu.:14.06   1st Qu.:16.38   1st Qu.:45.44   #>  difficult : 11   Median :14.47   Median :17.14   Median :46.61   #>  NA's      : 52   Mean   :14.48   Mean   :17.20   Mean   :46.56   #>                   3rd Qu.:14.87   3rd Qu.:18.09   3rd Qu.:47.51   #>                   Max.   :16.56   Max.   :20.50   Max.   :50.29   #>                                                   NA's   :112     #>      hgt15           wgt15             sleep15       age20       #>  Min.   :70.42   Min.   : 6755   no problem:54   Min.   :17.02   #>  1st Qu.:76.41   1st Qu.: 9642   sometimes :82   1st Qu.:18.15   #>  Median :78.41   Median :10563   difficult :12   Median :18.75   #>  Mean   :78.31   Mean   :10491   NA's      :52   Mean   :18.78   #>  3rd Qu.:80.13   3rd Qu.:11332                   3rd Qu.:19.35   #>  Max.   :85.96   Max.   :13591                   Max.   :22.25   #>  NA's   :13      NA's   :14                                      #>      bmi20            hc20           hgt20           wgt20       #>  Min.   :13.45   Min.   :43.79   Min.   :74.56   Min.   : 7908   #>  1st Qu.:16.12   1st Qu.:46.59   1st Qu.:80.70   1st Qu.:10716   #>  Median :17.05   Median :47.88   Median :83.03   Median :11637   #>  Mean   :16.96   Mean   :47.92   Mean   :82.80   Mean   :11590   #>  3rd Qu.:17.79   3rd Qu.:49.07   3rd Qu.:84.67   3rd Qu.:12452   #>  Max.   :20.27   Max.   :51.92   Max.   :91.05   Max.   :15449   #>                  NA's   :30      NA's   :17      NA's   :17      #>        sleep20       age26           bmi26            hc26       #>  no problem:69   Min.   :23.05   Min.   :11.98   Min.   :46.24   #>  sometimes :81   1st Qu.:24.40   1st Qu.:15.59   1st Qu.:47.69   #>  difficult : 8   Median :25.07   Median :16.33   Median :48.94   #>  NA's      :42   Mean   :25.06   Mean   :16.37   Mean   :49.15   #>                  3rd Qu.:25.75   3rd Qu.:17.17   3rd Qu.:50.32   #>                  Max.   :28.27   Max.   :19.59   Max.   :52.76   #>                                                  NA's   :135     #>      hgt26           wgt26             sleep26       age32       #>  Min.   :80.58   Min.   : 8775   no problem:85   Min.   :29.00   #>  1st Qu.:86.21   1st Qu.:12217   sometimes :65   1st Qu.:30.01   #>  Median :88.78   Median :13093   difficult : 7   Median :30.76   #>  Mean   :88.69   Mean   :13149   NA's      :43   Mean   :30.78   #>  3rd Qu.:90.98   3rd Qu.:14121                   3rd Qu.:31.37   #>  Max.   :98.10   Max.   :18037                   Max.   :34.03   #>  NA's   :20      NA's   :15                                      #>      bmi32            hc32           hgt32            wgt32       #>  Min.   :11.35   Min.   :45.33   Min.   : 82.27   Min.   : 9021   #>  1st Qu.:15.32   1st Qu.:48.42   1st Qu.: 90.58   1st Qu.:13154   #>  Median :16.24   Median :49.81   Median : 93.15   Median :14328   #>  Mean   :16.28   Mean   :49.77   Mean   : 93.17   Mean   :14278   #>  3rd Qu.:17.27   3rd Qu.:51.00   3rd Qu.: 95.64   3rd Qu.:15513   #>  Max.   :19.80   Max.   :53.70   Max.   :102.17   Max.   :19133   #>                  NA's   :30      NA's   :34       NA's   :20      #>        sleep32       age40           bmi40            hc40       #>  no problem:92   Min.   :35.06   Min.   :10.33   Min.   :45.87   #>  sometimes :52   1st Qu.:36.42   1st Qu.:14.98   1st Qu.:48.91   #>  difficult : 5   Median :37.31   Median :15.93   Median :50.17   #>  NA's      :51   Mean   :37.31   Mean   :15.93   Mean   :50.31   #>                  3rd Qu.:38.15   3rd Qu.:16.86   3rd Qu.:51.51   #>                  Max.   :40.78   Max.   :19.45   Max.   :55.09   #>                                                  NA's   :30      #>      hgt40            wgt40             sleep40        age50       #>  Min.   : 87.61   Min.   :10138   no problem:100   Min.   :44.13   #>  1st Qu.: 95.03   1st Qu.:14169   sometimes : 45   1st Qu.:45.54   #>  Median : 98.04   Median :15378   difficult :  3   Median :46.18   #>  Mean   : 97.71   Mean   :15355   NA's      : 52   Mean   :46.21   #>  3rd Qu.:100.03   3rd Qu.:16697                    3rd Qu.:46.89   #>  Max.   :106.70   Max.   :20508                    Max.   :48.85   #>  NA's   :24       NA's   :13                                       #>      bmi50             hc50           hgt50            wgt50       #>  Min.   : 9.716   Min.   :47.49   Min.   : 93.78   Min.   :11540   #>  1st Qu.:14.827   1st Qu.:50.05   1st Qu.:101.05   1st Qu.:15490   #>  Median :15.835   Median :51.21   Median :103.97   Median :16974   #>  Mean   :15.848   Mean   :51.31   Mean   :103.87   Mean   :16966   #>  3rd Qu.:16.914   3rd Qu.:52.48   3rd Qu.:106.84   3rd Qu.:18284   #>  Max.   :20.205   Max.   :56.43   Max.   :116.83   Max.   :23855   #>                   NA's   :30      NA's   :25       NA's   :16      #>        sleep50    #>  no problem:104   #>  sometimes : 34   #>  difficult :  1   #>  NA's      : 61   #>                   #>                   #>"},{"path":"https://nerler.github.io/JointAI/reference/split_formula_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Split a list of formulas into fixed and random effects parts. — split_formula_list","title":"Split a list of formulas into fixed and random effects parts. — split_formula_list","text":"Calls extract_fixef_formula() extract_ranef_formula() formula list create one list fixed effects formulas one list containing random effects formulas.","code":""},{"path":"https://nerler.github.io/JointAI/reference/split_formula_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split a list of formulas into fixed and random effects parts. — split_formula_list","text":"","code":"split_formula_list(formula)"},{"path":"https://nerler.github.io/JointAI/reference/split_formula_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split a list of formulas into fixed and random effects parts. — split_formula_list","text":"formula formula list formula objects","code":""},{"path":"https://nerler.github.io/JointAI/reference/split_formula_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split a list of formulas into fixed and random effects parts. — split_formula_list","text":"list two elements, fixed random, named list formula objects (NULL)","code":""},{"path":"https://nerler.github.io/JointAI/reference/split_formula_list.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Split a list of formulas into fixed and random effects parts. — split_formula_list","text":"Internal function, used *_imp() (2022-02-06)","code":""},{"path":"https://nerler.github.io/JointAI/reference/sum_duration.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the sum of the computational duration of a JointAI object — sum_duration","title":"Calculate the sum of the computational duration of a JointAI object — sum_duration","text":"Calculate sum computational duration JointAI object","code":""},{"path":"https://nerler.github.io/JointAI/reference/sum_duration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the sum of the computational duration of a JointAI object — sum_duration","text":"","code":"sum_duration(object, by = NULL)"},{"path":"https://nerler.github.io/JointAI/reference/sum_duration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the sum of the computational duration of a JointAI object — sum_duration","text":"object object class JointAI optional grouping information; options NULL (default) calculate sum chains runs adaptive sampling phase, \"run\" get duration per run, \"phase\" get sum chains runs per phase, \"chain\" get sum per chain phases runs, \"phase run\" get sum chains, separately per phase run.","code":""},{"path":"https://nerler.github.io/JointAI/reference/summary.JointAI.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize the results from an object of class JointAI — print.Dmat","title":"Summarize the results from an object of class JointAI — print.Dmat","text":"Obtain print summary, (fixed effects) coefficients (coef) credible interval (confint) object class 'JointAI'.","code":""},{"path":"https://nerler.github.io/JointAI/reference/summary.JointAI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize the results from an object of class JointAI — print.Dmat","text":"","code":"# S3 method for class 'Dmat' print(x, digits = getOption(\"digits\"),   scientific = getOption(\"scipen\"), ...)  # S3 method for class 'JointAI' summary(object, start = NULL, end = NULL, thin = NULL,   quantiles = c(0.025, 0.975), subset = NULL, exclude_chains = NULL,   outcome = NULL, missinfo = FALSE, warn = TRUE, mess = TRUE, ...)  # S3 method for class 'summary.JointAI' print(x, digits = max(3, .Options$digits - 4), ...)  # S3 method for class 'JointAI' coef(object, start = NULL, end = NULL, thin = NULL,   subset = NULL, exclude_chains = NULL, warn = TRUE, mess = TRUE, ...)  # S3 method for class 'JointAI' confint(object, parm = NULL, level = 0.95,   quantiles = NULL, start = NULL, end = NULL, thin = NULL,   subset = NULL, exclude_chains = NULL, warn = TRUE, mess = TRUE, ...)  # S3 method for class 'JointAI' print(x, digits = max(4, getOption(\"digits\") - 4), ...)"},{"path":"https://nerler.github.io/JointAI/reference/summary.JointAI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize the results from an object of class JointAI — print.Dmat","text":"x object class summary.JointAI JointAI digits minimum number significant digits printed values. scientific penalty applied deciding print numeric values fixed exponential notation, default value obtained getOption(\"scipen\") ... currently used object object inheriting class 'JointAI' start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. quantiles posterior quantiles subset subset parameters/variables/nodes (columns MCMC sample). Follows principle argument monitor_params *_imp. exclude_chains optional vector index numbers chains excluded outcome optional; vector identifying outcomes summary given, either specifying indices, names (LHS respective model formulas character string). missinfo logical; information number proportion missing values included summary? warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE. parm subset (consistency confint method types objects) level confidence level (default 0.95)","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/summary.JointAI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize the results from an object of class JointAI — print.Dmat","text":"","code":"if (FALSE) { # \\dontrun{ mod1 <- lm_imp(y ~ C1 + C2 + M2, data = wideDF, n.iter = 100)  summary(mod1, missinfo = TRUE) coef(mod1) confint(mod1) } # }"},{"path":"https://nerler.github.io/JointAI/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create traceplots for a MCMC sample — traceplot","title":"Create traceplots for a MCMC sample — traceplot","text":"Creates set traceplots MCMC sample object class 'JointAI'.","code":""},{"path":"https://nerler.github.io/JointAI/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create traceplots for a MCMC sample — traceplot","text":"","code":"traceplot(object, ...)  # S3 method for class 'JointAI' traceplot(object, start = NULL, end = NULL,   thin = NULL, subset = c(analysis_main = TRUE), outcome = NULL,   exclude_chains = NULL, nrow = NULL, ncol = NULL, use_ggplot = FALSE,   warn = TRUE, mess = TRUE, ...)"},{"path":"https://nerler.github.io/JointAI/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create traceplots for a MCMC sample — traceplot","text":"object object inheriting class 'JointAI' ... Arguments passed graphics::matplot lty,lwd,lend vector line types, widths, end styles.     first element first column, second element     second column, etc., even lines plotted     columns. Line types used cyclically plots     drawn. col vector colors.  Colors used cyclically. cex vector character expansion sizes, used cyclically.     works multiple par(\"cex\").  NULL     equivalent 1.0. bg vector background (fill) colors open plot     symbols given pch = 21:25 points.      default NA corresponds one underlying function     plot.xy. add logical.  TRUE, plots added current one,     using points lines. verbose logical.  TRUE, write one line     done. start first iteration interest (see window.mcmc) end last iteration interest (see window.mcmc) thin thinning interval (integer; see window.mcmc). example, thin = 1 (default) keep MCMC samples iterations; thin = 5 keep every 5th iteration. subset subset parameters/variables/nodes (columns MCMC sample). Follows principle argument monitor_params *_imp. outcome optional; vector identifying subset sub-models included output, either specifying indices (using order used list model formulas), names (LHS respective model formula character string) exclude_chains optional vector index numbers chains excluded nrow optional; number rows plot layout; automatically chosen unspecified ncol optional; number columns plot layout; automatically chosen unspecified use_ggplot logical; ggplot used instead base graphics? warn logical; warnings given? Default TRUE. mess logical; messages given? Default TRUE.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/reference/traceplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create traceplots for a MCMC sample — traceplot","text":"","code":"# fit a JointAI model mod <- lm_imp(y ~ C1 + C2 + M1, data = wideDF, n.iter = 100)   # Example 1: simple traceplot traceplot(mod)    # Example 2: ggplot version of traceplot traceplot(mod, use_ggplot = TRUE)    # Example 5: changing how the ggplot version looks (using ggplot syntax) library(ggplot2)  traceplot(mod, use_ggplot = TRUE) +   theme(legend.position = 'bottom') +   xlab('iteration') +   ylab('value') +   scale_color_discrete(name = 'chain')"},{"path":"https://nerler.github.io/JointAI/reference/two_value_to_factor.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert two-value vectors to factors — two_value_to_factor","title":"Convert two-value vectors to factors — two_value_to_factor","text":"Convert two-value vectors factors","code":""},{"path":"https://nerler.github.io/JointAI/reference/two_value_to_factor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert two-value vectors to factors — two_value_to_factor","text":"","code":"two_value_to_factor(x)"},{"path":"https://nerler.github.io/JointAI/reference/two_value_to_factor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert two-value vectors to factors — two_value_to_factor","text":"x vector","code":""},{"path":"https://nerler.github.io/JointAI/reference/two_value_to_factor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert two-value vectors to factors — two_value_to_factor","text":"vector converted factor exactly two unique (non-missing) values already factor; otherwise input","code":""},{"path":"https://nerler.github.io/JointAI/reference/varname_to_modelframe.html","id":null,"dir":"Reference","previous_headings":"","what":"Create data.frame from variable term and data — varname_to_modelframe","title":"Create data.frame from variable term and data — varname_to_modelframe","text":"Create data.frame variable term data","code":""},{"path":"https://nerler.github.io/JointAI/reference/varname_to_modelframe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create data.frame from variable term and data — varname_to_modelframe","text":"","code":"varname_to_modelframe(varname, data)"},{"path":"https://nerler.github.io/JointAI/reference/varname_to_modelframe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create data.frame from variable term and data — varname_to_modelframe","text":"varname character string giving variable name model term data data.frame containing variables mentioned varname","code":""},{"path":"https://nerler.github.io/JointAI/reference/varname_to_modelframe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create data.frame from variable term and data — varname_to_modelframe","text":"data.frame","code":""},{"path":"https://nerler.github.io/JointAI/reference/wideDF.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-sectional example dataset — wideDF","title":"Cross-sectional example dataset — wideDF","text":"simulated cross-sectional dataset.","code":""},{"path":"https://nerler.github.io/JointAI/reference/wideDF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-sectional example dataset — wideDF","text":"","code":"data(wideDF)"},{"path":"https://nerler.github.io/JointAI/reference/wideDF.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cross-sectional example dataset — wideDF","text":"simulated data frame 100 rows 13 variables: C1 continuous, complete variable C2 continuous, incomplete variable B1 binary, complete variable B2 binary, incomplete variable M1 unordered factor; complete variable M2 unordered factor; incomplete variable O1 ordered factor; complete variable O2 ordered factor; incomplete variable L1 continuous, complete variable L2 continuous incomplete variable id id (grouping) variable time continuous complete variable y continuous, complete variable","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-110","dir":"Changelog","previous_headings":"","what":"JointAI 1.1.0","title":"JointAI 1.1.0","text":"CRAN release: 2026-01-30","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-features-1-1-0","dir":"Changelog","previous_headings":"","what":"New features","title":"JointAI 1.1.0","text":"Added functions crosscorr(), crosscorr_plot(), autocorr() autocorr_plot() assess cross-correlation autocorrelation MCMC samples.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"small-improvements-1-1-0","dir":"Changelog","previous_headings":"","what":"Small improvements","title":"JointAI 1.1.0","text":"all_vars(): update function; can now handle unspecified number input objects can extract variable names formulas character strings valid variable names objects provided data argument now converted .data.frame(), making possible provide tibble Elements list supplied append_data_list argument now overwrite existing elements data_list name. enables wider range changes automatically generated JAGS model.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-1-1-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 1.1.0","text":"Error using function twice model formula different number variables (e.g., (x^2) (/b)) fixed. Fix identifying number workers used parallel computation future package. Fix summary() printout showing wrong MCMC settings using thinning. rd_vcov(): fixed issue resulting error extracting random effects variance-covariance matrix fitted model case multivariate mixed model.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-106","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.6","title":"JointAI 1.0.6","text":"CRAN release: 2024-04-02 clean-helper functions additional unit tests fix typos argument names helpfiles fix documentation syntax (CRAN NOTEs)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-105","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.5","title":"JointAI 1.0.5","text":"CRAN release: 2023-04-27 (update request CRAN) use wrapper bs() avoid warning CMD check run older version R splines::bs() yet argument warn.outside.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-104","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.4","title":"JointAI 1.0.4","text":"CRAN release: 2022-09-03","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-features-1-0-4","dir":"Changelog","previous_headings":"","what":"New features","title":"JointAI 1.0.4","text":"md_pattern() additional argument sort_columns provide option switch sorting columns number missing values. sum_duration(): new function get sum computational time across chains, phases, runs, …","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-1-0-4","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 1.0.4","text":"formula() now also return model formula add_samples() used. JM_imp() ordinal longitudinal outcome using correct version linear predictor quadrature procedure approximating integral survival. Bug causing wrong elements data matrix monitored monitor_params(imps = TRUE) survival models fixed. predDF(): bugfix models including auxiliary variables (previously included data) nonprop: bugfix non-proportional effects covariate models","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"small-improvements-1-0-4","dir":"Changelog","previous_headings":"","what":"Small improvements","title":"JointAI 1.0.4","text":"Use add_samples() now result call element JointAI object list longer nested list. Re-structuring JAGS model code proportional hazards models reduce computational time. change parallel computation done: rely doFuture foreach , package future required. comp_info element fitted JointAI object changed due changes parallel computing, computational time reported separately adaptive phase sampling phase, separately per chain parallel computation used. predict() now lot faster proportional hazards models.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-103","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.3","title":"JointAI 1.0.3","text":"CRAN release: 2021-11-28","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-features-1-0-3","dir":"Changelog","previous_headings":"","what":"New features","title":"JointAI 1.0.3","text":"custom: new argument main analysis functions allows user replace JAGS syntax sub-models custom syntax. argument expects named list names names variables custom model used. feature requires knowledge JAGS syntax. append_data_list: new argument main analysis functions allows user add elements list data passed JAGS. may necessary custom sub-models. rd_vcov: new argument main analysis functions allows specification structure random effects variance-covariance matrices (multivariate) mixed models (joint models).","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-improvements-and-bug-fixes-1-0-3","dir":"Changelog","previous_headings":"","what":"Minor improvements and bug fixes","title":"JointAI 1.0.3","text":"Bug fix re-scaling random effects variance covariance matrix multi-level models >2 levels levels random intercept. Bug fix generating names random effect nodes monitor multiple analysis models random effects. Bug fix plot_all() displaying variable name message shown character string variables. Bug fix set_refcat(): wasn’t displaying factor labels correctly print.JointAI: bugfix multivariate mixed models full variance-covariance matrix random effects number random effects outcome, printing matrix resulted error. Bug fix: using function variable auxiliary now () correctly used covariate linear predictor covariate models (bug introduced commit 15014dcd)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-102","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.2","title":"JointAI 1.0.2","text":"CRAN release: 2021-01-13","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-features-1-0-2","dir":"Changelog","previous_headings":"","what":"New features","title":"JointAI 1.0.2","text":"rd_vcov(): new function added extract random effect variance- covariance matrices (posterior means)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-improvements-and-bug-fixes-1-0-2","dir":"Changelog","previous_headings":"","what":"Minor improvements and bug fixes","title":"JointAI 1.0.2","text":"change way model formula contained model call, make possible call *_imp() functions within another function model formula argument. fixed issue resulted error data previously attached search path","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-101","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.1","title":"JointAI 1.0.1","text":"CRAN release: 2020-11-16","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-improvements-and-bug-fixes-1-0-1","dir":"Changelog","previous_headings":"","what":"Minor improvements and bug fixes","title":"JointAI 1.0.1","text":"data_list: omit data matrix M_* data_list ncol == 0 data_list: syntax checking pos_* include can handle case multiple grouping variables , lowest level; pos_* excluded one random effects: now possible use different grouping levels different sub-models (providing list model formulas) add_samples(): remove unnecessary call doFuture::registerDoFuture() predDF() bug fix: parameter methods now called object list_models() now also works errored JointAI objects Bug fix models interaction repeatedly measured variable random slope variable. (term wrongly written mean structure random effect instead main linear predictor.)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-100","dir":"Changelog","previous_headings":"","what":"JointAI 1.0.0","title":"JointAI 1.0.0","text":"CRAN release: 2020-08-31 version JointAI contains major changes. extend package necessary change internal structure possible assure backward compatibility.","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-analysis-model-types-1-0-0","dir":"Changelog","previous_headings":"New features","what":"New analysis model types","title":"JointAI 1.0.0","text":"betareg_imp(): beta regression betamm_imp(): beta mixed model lognorm_imp(): log-normal regression model lognormmm_imp(): log-normal mixed model mlogit_imp(): multinomial logit model mlogitmm_imp(): multinomial mixed model JM_imp(): joint model longitudinal survival data","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"hierarchical-models-with-multiple-levels-of-grouping-1-0-0","dir":"Changelog","previous_headings":"New features","what":"Hierarchical models with multiple levels of grouping","title":"JointAI 1.0.0","text":"now possible fit hierarchical models one level grouping, nested well crossed random effects (check help file) main model function details specify random effects structures. also apply survival models, .e., possible specify random effects structure model survival outcomes data hierarchical structure, e.g., multi-centre setting.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"proportional-hazards-model-with-time-dependent-covariates-1-0-0","dir":"Changelog","previous_headings":"New features","what":"Proportional hazards model with time-dependent covariates","title":"JointAI 1.0.0","text":"coxph_imp() can now handle time-dependent covariates using last-observation-carried-forward. requires add (1 | <id variable>) model formula identify rows belong subject, specify argument timevar identify variable contains observation time longitudinal measurements.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"multivariate-models-1-0-0","dir":"Changelog","previous_headings":"New features","what":"Multivariate models","title":"JointAI 1.0.0","text":"providing list model formulas possible fit multiple analysis models (different types) simultaneously. models can share covariates possible response one model covariate another model (sequential manner, however, circular).","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"partial-proportional-odds-models-for-ordinal-responses-1-0-0","dir":"Changelog","previous_headings":"New features","what":"Partial proportional odds models for ordinal responses","title":"JointAI 1.0.0","text":", proportional odds assumed default covariates cumulative logit model. argument nonprop accepts one-sided formula named list one-sided formulas covariates specified non-proportional odds assumed. Additionally, argument rev available specify vector names ordinal responses odds inverted. details, see help file.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"other-new-features-1-0-0","dir":"Changelog","previous_headings":"New features","what":"Other new features","title":"JointAI 1.0.0","text":"functions lmer_imp() glmer_imp() aliases lme_imp() glme_imp(). mixed models can specified using nlme type specification (using fixed random) well using specification lme4 (combined model formula fixed random effects). argument df_basehaz coxph_imp() JM_imp() allows setting number degrees freedom B-spline basis used model baseline hazard. global setting options(\"contrasts\") longer ignored. completely observed covariates, contrasts available base R possible options(\"contrasts\") used determine contrasts use. covariates missing values, effect coding (contr.sum) dummy coding (contr.treatment) possible. means completely observed ordered factors default contr.poly, incomplete ordered factors default contr.treatment.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"other-changes-1-0-0","dir":"Changelog","previous_headings":"","what":"Other changes","title":"JointAI 1.0.0","text":"Within summary(), argument multivariate function GR_crit() now set FALSE avoid issues. multivariate version can still obtained using GR_crit() directly. parameters baseline hazard coxph_imp() JM_imp() monitored automatically “analysis_main = TRUE”. function get_models() longer exported now requires input variables longer convenient use. obtain default specification model types use one main functions (*_imp()), set n.adapt = 0 (n.iter = 0), obtain model types <mymodel>$models. list_models() now returns information sub-models, including main analysis models (previously included information covariates). output parameters() changed. function returns list matrices, one per analysis model, information response variable, response category, name regression coefficient associated covariate. argument missinfo = TRUE summar() adds information missing values data involved JointAI model (number proportion complete cases, number proportion missing values per variable). argument ridge changed shrinkage. shrinkage = \"ridge\", ridge prior used regression coefficients sub-models. vector response variable names provided shinkage, ridge priors used coefficients models. default_hyperpars(): default hyper-parameters random effects longer provided function consistently hyper-parameters model parts, vector (within list hyper-parameters). default_hyperpars(): default number degrees freedom Wishart distribution used inverse random effects covariance matrix now number random effects + 1 (number random effects ). effect using seed JointAI now local, .e., functions set.seed() called, random number generator state .Random.seed setting seed recorded, re-set value exiting function. predDF() argument var changed vars expects formula. extends functionality predDF() let multiple variables vary. JointAI objects now contain information computational time environment run : element comp_info contains time-stamp model fitted, duration computation, JointAI version number R session info. JAGS model stored character string element jagsmodel. arguments warn mess now also affect output rjags. doFuture package used parallel computation instead doParallel. Parallel computation specified setting future::plan() “future” handled. consequence, arguments parallel n.cores longer used. Information setting used regards parallel computation returned JointAI object via comp_list$future.","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-1-0-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 1.0.0","text":"Scaling continuous covariates longer done data, JAGS model. fixes issue previously estimated variance parameters continuous covariates variance parameters random effects incorrect (issue affected covariate models, main analysis model).","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-061","dir":"Changelog","previous_headings":"","what":"JointAI 0.6.1","title":"JointAI 0.6.1","text":"CRAN release: 2020-02-12","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-6-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.6.1","text":"Fixed bug messed coefficients clmm covariate model baseline covariates model enable newdata predict() contain outcome variable add_samples(): calculation end() MCMC samples fixed","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-060","dir":"Changelog","previous_headings":"","what":"JointAI 0.6.0","title":"JointAI 0.6.0","text":"CRAN release: 2019-08-31","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-6-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.6.0","text":"bug add_samples() used parallel thinning fixed bug fixed occurred complete longitudinal categorical variable used model contain incomplete baseline variables bug-fix monitoring random effects fixed typo selecting parameters Gamma models predict() can now handle newdata missing outcome values; predicted values cases missing covariates NA (prediction incomplete covariates planned implemented future) bug-fix get_MIdat() plot_imp_distr() one variable missing values bug-fix longitudinal model interaction random slope variable bug-fix model multiple longitudinal ordinal incomplete covariates (fixed wrong selection columns design matrix longitudinal covariates models)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-changes-0-6-0","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"JointAI 0.6.0","text":"moved message bug reports startup enabled inverse link adding max restriction “:” factor labels automatically replaced “_” argument ncores changed n.cores consistency n.iter, n.chains, etc. coxph_imp() longer use counting process implementation uses likelihood JAGS directly via zeros trick","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-features--extensions-0-6-0","dir":"Changelog","previous_headings":"","what":"New Features / Extensions","title":"JointAI 0.6.0","text":"predict() now argument length change number evaluation points summary(), predict(), traceplot(), densplot(), GR_crit(), MC_error() now argument exclude_chains allows specify chains omitted citation() now refers manuscript arXiv glmm_lognorm available impute level-1 covariates log-normal mixed model methods residuals() plot() available () main analysis types (details see documentation) argument models added get_models() user can specify also include models complete covariates (positioned sequence models according systematic used JointAI). Specification model needed imputation prints notification. JointAI objects (types) now also include residuals fitted values (far, using fixed effects)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-052","dir":"Changelog","previous_headings":"","what":"JointAI 0.5.2","title":"JointAI 0.5.2","text":"CRAN release: 2019-06-06","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-5-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.5.2","text":"Error message print.JointAI fixed","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-051","dir":"Changelog","previous_headings":"","what":"JointAI 0.5.1","title":"JointAI 0.5.1","text":"CRAN release: 2019-05-07","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-5-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.5.1","text":"bug ordinal models completely observed variables fixed (necessary data passed JAGS) enable thinning using parallel sampling matrix Xl longer included data_list used model bug-fix subset specified vector bug-fix ridge regression (gave error message) bug-fix recognition binary factors coded numeric missing values bug-fix summary: range iterations printed correctly now argument end used bug-fix: error occurred re-scaling reference category changed solved bug-fix survival models: coding censoring variable fixed","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-changes-0-5-1","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"JointAI 0.5.1","text":"summary() calls GR_crit() argument autoburnin = FALSE unless specified otherwise via ... inits specified function, function evaluated resulting list passed JAGS (previously function passed JAGS) example data simong simWide changed (variables, less subjects) added check incomplete covariates setting imp_pars = TRUE (user specified via monitor_params subset) survreg_imp sign regression coefficient now opposite match one survreg","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-050","dir":"Changelog","previous_headings":"","what":"JointAI 0.5.0","title":"JointAI 0.5.0","text":"CRAN release: 2019-03-08","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"important-0-5-0","dir":"Changelog","previous_headings":"","what":"Important","title":"JointAI 0.5.0","text":"argument meth changed models","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-5-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.5.0","text":"add_samples(): bug copied last chain chains fixed bug-fix order columns matrix Xc, specification functions covariates auxiliary variables works better adding vertical lines densplot() issue (plots showed lines) fixed nested functions involving powers made possible typo causing issue poisson glm glme removed","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-changes-0-5-0","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"JointAI 0.5.0","text":"plot_all(), densplot(), traceplot() limit number plots one page 64 rows columns layout user specified (avoid ‘figure margins large’ error) change longDF example data: new version containing complete incomplete categorical longitudinal variables (variable names L1 L2 changed c1 c2) minor changes notes, warnings error messages function list_impmodels() changed list_models() (list_impmodels() kept alias now) improved handling functional forms covariates (also longitudinal covariates random effects)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"new-features--extensions-0-5-0","dir":"Changelog","previous_headings":"","what":"New Features / Extensions","title":"JointAI 0.5.0","text":"clm_imp() clmm_imp(): new functions analysis ordinal (mixed) models now possible impute incomplete longitudinal covariates (continuous, binary ordered factors). coxph_imp(): new function fit Cox proportional hazards models incomplete (baseline) covariates Argument no_model allows specify names completely observed variables model specified (e.g., “time” mixed model) Shrinkage: argument ridge = TRUE allows use shrinkage priors precision regression coefficients analysis model plot_all() can now handle variables classes Date POSIXt new argument parallel allows different MCMC chains sampled parallel new argument ncores allows specify maximum number cores used new argument seed added reproducible results; also sampler (.RNG.name) seed value sampler (.RNG.seed) set added user-provided initial values (necessary parallel sampling reproducibility results) plot_imp_distr(): new function plot distribution observed imputed values","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-040","dir":"Changelog","previous_headings":"","what":"JointAI 0.4.0","title":"JointAI 0.4.0","text":"CRAN release: 2018-12-04","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.4.0","text":"RinvD longer selected monitored random intercept model (RinvD used model) fixed various bugs models intercept used (covariates)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-changes-0-4-0","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"JointAI 0.4.0","text":"summary(): reduced default number digits continuous variables two distinct values converted factor argument meth now uses default values specified subset incomplete variables get_MIdat(): argument minspace added ensure spacing iterations selected imputations densplot(): accepts additional options, e.g., lwd, col, … list_models() replaces function list_impmodels() (now alias)","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"extensions-0-4-0","dir":"Changelog","previous_headings":"","what":"Extensions","title":"JointAI 0.4.0","text":"coef() method added JointAI object summary.JointAI object confint() method added JointAI object print() method added JointAI object survreg_imp() added perform analysis parametric (Weibull) survival models glme_imp() added perform generalized linear mixed modelling extended documentation; two new vignettes MCMC parameters functions model estimated; added messages coding ordinal variables","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-3-4","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.3.4","text":"traceplot(), densplot(): specification nrow ncol possible; fixed bug nrow specified","code":""},{"path":[]},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-3-3","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.3.3","text":"remove deprecated code specifying contrast.arg now cases cause error fixed problem identifying non-linear functions formula name another variable contains function name","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-030","dir":"Changelog","previous_headings":"","what":"JointAI 0.3.0","title":"JointAI 0.3.0","text":"CRAN release: 2018-08-14","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-3-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.3.0","text":"monitor_params now checked avoid problems part main parameters selected categorical imputation models now use min-max trick prevent probabilities outside [0, 1] initial value generation logistic analysis model fixed bug-fix re-ordering columns function part linear predictor bug-fix initial values categorical covariates bug-fix finding imputation method function variable specified auxiliary variable","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-changes-0-3-0","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"JointAI 0.3.0","text":"md.pattern() now uses ggplot, scales better previous version lm_imp(), glm_imp() lme_imp() now ask overwriting model file analysis_main = T stays selected parameters followed well get_MIdat(): argument include added select original data included id variable .id added dataset subset argument uses logit monitor_params argument added switch hide messages; distinction messages warnings lm_imp(), glm_imp() lme_imp() now take argument trunc order truncate distribution incomplete variables summary() now omits auxiliary variables output imp_par_list now returned JointAI models cat_vars longer returned lm_imp(), glm_imp() lme_imp(), contained Mlist$refs","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"extensions-0-3-0","dir":"Changelog","previous_headings":"","what":"Extensions","title":"JointAI 0.3.0","text":"plot_all() function added densplot() traceplot() optional ggplot densplot() option combine chains plotting example datasets NHANES, simLong simWide added list_impmodels print information imputation models hyper-parameters parameters() added display parameters /monitored set_refcat() added guide specification reference categories extension possible functions variables model formula (almost ) functions available JAGS added vignettes Minimal Example, Visualizing Incomplete Data, Parameter Selection Model Specification","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"jointai-020","dir":"Changelog","previous_headings":"","what":"JointAI 0.2.0","title":"JointAI 0.2.0","text":"CRAN release: 2018-07-05","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"bug-fixes-0-2-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"JointAI 0.2.0","text":"md_pattern(): generate duplicate plot corrected names imputation methods help file scaling continuous covariates model scaling deselected fixed initial value specification coefficient auxiliary variables fixed get_MIdat(): imputed values now filled correct order get_MIdat(): variables imputed lognorm now included extracting imputed dataset get_MIdat(): imputed values transformed variables now included imputed datasets problem non valid names factor labels fixed data matrix now ordered according order user-specified meth argument","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"minor-changes-0-2-0","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"JointAI 0.2.0","text":"md.pattern(): adaptation new version md.pattern() mice package internally change NaN NA allow scaling incomplete covariates quadratic effects changed hyperparameter precision models logit link 4/9 0.001","code":""},{"path":"https://nerler.github.io/JointAI/news/index.html","id":"extensions-0-2-0","dir":"Changelog","previous_headings":"","what":"Extensions","title":"JointAI 0.2.0","text":"gamma beta imputation methods implemented","code":""}]

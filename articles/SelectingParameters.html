<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parameter Selection • JointAI</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Parameter Selection">
<meta property="og:description" content="JointAI">
<meta property="og:image" content="https://nerler.github.io/JointAI/reference/figures/logo.png">
<meta property="og:image:alt" content="JointAI: An R package for Joint Analysis and Imputation">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@N_Erler">
<meta name="twitter:site" content="@N_Erler">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-127879026-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-127879026-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JointAI</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.6.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AfterFitting.html">After Fitting</a>
    </li>
    <li>
      <a href="../articles/MCMCsettings.html">MCMC Settings</a>
    </li>
    <li>
      <a href="../articles/MinimalExample.html">Minimal Example</a>
    </li>
    <li>
      <a href="../articles/ModelSpecification.html">Model Specification</a>
    </li>
    <li>
      <a href="../articles/SelectingParameters.html">Parameter Selection</a>
    </li>
    <li>
      <a href="../articles/TheoreticalBackground.html">Theoretical Background</a>
    </li>
    <li>
      <a href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nerler/JointAI/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/N_Erler">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="SelectingParameters_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Parameter Selection</h1>
            <h3 class="subtitle">How to specify which parameters to monitor and display in the results</h3>
            
            <h4 class="date">2020-06-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/master/vignettes/SelectingParameters.Rmd"><code>vignettes/SelectingParameters.Rmd</code></a></small>
      <div class="hidden name"><code>SelectingParameters.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we use the <a href="https://nerler.github.io/JointAI/reference/NHANES.html">NHANES</a> data for examples in cross-sectional data and the dataset <a href="https://nerler.github.io/JointAI/reference/simLong.html">simLong</a> for examples in longitudinal data. For more info on these datasets, check out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html"><em>Visualizing Incomplete Data</em></a>, in which the distribution of variables and missing values in both sets is explored.</p>
<p><strong>Note:</strong><br> In several of the examples we use <code>n.adapt = 0</code> (and <code>n.iter = 0</code>, which is the default) in order to prevent the MCMC sampling to reduce computational some time. <code>progress.bar = 'none'</code> prevents printing of the progress of the MCMC sampling, which results in lengthy output in the vignette, but is useful in practice.</p>
<div id="monitoring-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#monitoring-parameters" class="anchor"></a>Monitoring parameters</h2>
<p><strong>JointAI</strong> uses <a href="http://mcmc-jags.sourceforge.net/">JAGS</a> for performing the MCMC (<a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov Chain Monte Carlo</a>) sampling. Since JAGS only saves the values of MCMC chains for those parameters/variables for which the user has specified that they should be monitored, this is also the case in <strong>JointAI</strong>.</p>
<p>For this purpose, the main functions <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>*_imp()</code></a> have an argument <code>monitor_params</code>.</p>
<p><code>monitor_params</code> takes a named list (often a named vector also works) with the following possible entries:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="91%">
</colgroup>
<thead><tr class="header">
<th align="left">name/key word</th>
<th align="left">what is monitored</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>analysis_main</code></td>
<td align="left">
<code>betas</code> and <code>sigma_main</code>, <code>tau_main</code> (in beta regression) or <code>shape_main</code> (in parametric survival models), <code>D_main</code> (in multi-level models) and <code>basehaz</code> (in proportional hazards models)</td>
</tr>
<tr class="even">
<td align="left"><code>analysis_random</code></td>
<td align="left">
<code>ranef_main</code>, <code>D_main</code>, <code>invD_main</code>, <code>RinvD_main</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>other_models</code></td>
<td align="left">
<code>alphas</code>, <code>tau_other</code>, <code>gamma_other</code>, <code>delta_other</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>imps</code></td>
<td align="left">imputed values</td>
</tr>
<tr class="odd">
<td align="left"><code>betas</code></td>
<td align="left">regression coefficients of the main analysis model(s)</td>
</tr>
<tr class="even">
<td align="left"><code>tau_main</code></td>
<td align="left">precision of the residuals from the analysis model(s)</td>
</tr>
<tr class="odd">
<td align="left"><code>sigma_main</code></td>
<td align="left">standard deviation of the residuals from the analysis model(s)</td>
</tr>
<tr class="even">
<td align="left"><code>gamma_main</code></td>
<td align="left">intercepts in ordinal main model</td>
</tr>
<tr class="odd">
<td align="left"><code>delta_main</code></td>
<td align="left">increments of ordinal intercepts in main model(s)</td>
</tr>
<tr class="even">
<td align="left"><code>ranef_main</code></td>
<td align="left">random effects of the analysis model(s)</td>
</tr>
<tr class="odd">
<td align="left"><code>D_main</code></td>
<td align="left">covariance matrix of the random effects of the main model(s)</td>
</tr>
<tr class="even">
<td align="left"><code>invD_main</code></td>
<td align="left">inverse of <code>D_main</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>RinvD_main</code></td>
<td align="left">scale matrix in Wishart prior for <code>invD_main</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>alphas</code></td>
<td align="left">regression coefficients in the covariate models</td>
</tr>
<tr class="odd">
<td align="left"><code>tau_other</code></td>
<td align="left">precision parameters of the residuals from covariate models</td>
</tr>
<tr class="even">
<td align="left"><code>gamma_other</code></td>
<td align="left">intercepts in ordinal covariate models</td>
</tr>
<tr class="odd">
<td align="left"><code>delta_other</code></td>
<td align="left">increments of ordinal intercepts in covariate models</td>
</tr>
<tr class="even">
<td align="left"><code>ranef_other</code></td>
<td align="left">random effects of the covariate model(s)</td>
</tr>
<tr class="odd">
<td align="left"><code>D_other</code></td>
<td align="left">covariance matrix of the random effects of the covariate model(s)</td>
</tr>
<tr class="even">
<td align="left"><code>invD_other</code></td>
<td align="left">inverse of <code>D_other</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>RinvD_other</code></td>
<td align="left">scale matrix in Wishart prior for <code>invD_other</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>other</code></td>
<td align="left">additional parameters</td>
</tr>
</tbody>
</table>
<p>Each of the key words works as a switch, except for <code>other</code>, which should be a vector of character strings.</p>
<div id="parameters-of-the-analysis-model" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters-of-the-analysis-model" class="anchor"></a>Parameters of the analysis model</h3>
<p>The default setting is <code>monitor_params = c(analysis_main = TRUE)</code>, i.e., only the main parameters of the analysis model are monitored, and monitoring is switched off for all other parameters.</p>
<p>The main parameters are the regression coefficients of the analysis model (<code>beta</code>) and potentially the residual standard deviation, for example in linear or Gamma models, the second parameter in a beta distribution (parametrized with <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span> instead of two shape parameters), the variance-covariance matrices of random effects used in the main models, the shape parameter in a parametric Weibull survival model, and the coefficients used in the spline specification of the baseline hazard of proportional hazards survival models.</p>
<p>The function <code><a href="../reference/parameters.html">parameters()</a></code> returns the parameters that are specified to be followed (even for models where no MCMC sampling was performed, i.e. when <code>n.iter = 0</code> and <code>n.adapt = 0</code>).</p>
<p>For example:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">lm1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">gender</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">creat</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>,  <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>)

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lm1</span>)
<span class="co">#&gt;   outcome outcat      varname      coef</span>
<span class="co">#&gt; 1     SBP   &lt;NA&gt;  (Intercept)   beta[1]</span>
<span class="co">#&gt; 2     SBP   &lt;NA&gt; genderfemale   beta[2]</span>
<span class="co">#&gt; 3     SBP   &lt;NA&gt;           WC   beta[3]</span>
<span class="co">#&gt; 4     SBP   &lt;NA&gt;       alc&gt;=1   beta[4]</span>
<span class="co">#&gt; 5     SBP   &lt;NA&gt;        creat   beta[5]</span>
<span class="co">#&gt; 6    &lt;NA&gt;   &lt;NA&gt;         &lt;NA&gt; sigma_SBP</span></pre></body></html></div>
<p>The column <code>outcome</code> refers to the response variable of a particular model, to distinguish between the regression coefficients in different sub-models, and the column <code>outcat</code> will contain the category of the response variable that a particular linear predictor corresponds to in multinomial logit models.</p>
</div>
<div id="imputed-values-parameters-of-the-imputation-models" class="section level3">
<h3 class="hasAnchor">
<a href="#imputed-values-parameters-of-the-imputation-models" class="anchor"></a>Imputed values &amp; parameters of the imputation models</h3>
<p>To generate (multiple) imputed datasets that can be used for further analyses, the imputed values need to be monitored. This can be done by setting <code>monitor_params = c(imps = TRUE)</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">lm2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">age</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">smoke</span> + <span class="no">occup</span>,
              <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>, <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>,
              <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">imps</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
)

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lm2</span>)
<span class="co">#&gt;    outcome outcat varname            coef</span>
<span class="co">#&gt; 1       NA     NA      NA   M_lvlone[1,2]</span>
<span class="co">#&gt; 2       NA     NA      NA   M_lvlone[7,2]</span>
<span class="co">#&gt; 3       NA     NA      NA   M_lvlone[8,2]</span>
<span class="co">#&gt; 4       NA     NA      NA  M_lvlone[12,2]</span>
<span class="co">#&gt; 5       NA     NA      NA  M_lvlone[13,2]</span>
<span class="co">#&gt; 6       NA     NA      NA  M_lvlone[21,2]</span>
<span class="co">#&gt; 7       NA     NA      NA  M_lvlone[22,2]</span>
<span class="co">#&gt; 8       NA     NA      NA  M_lvlone[31,2]</span>
<span class="co">#&gt; 9       NA     NA      NA  M_lvlone[33,2]</span>
<span class="co">#&gt; 10      NA     NA      NA  M_lvlone[34,2]</span>
<span class="co">#&gt; 11      NA     NA      NA  M_lvlone[39,2]</span>
<span class="co">#&gt; 12      NA     NA      NA  M_lvlone[49,2]</span>
<span class="co">#&gt; 13      NA     NA      NA  M_lvlone[66,2]</span>
<span class="co">#&gt; 14      NA     NA      NA  M_lvlone[67,2]</span>
<span class="co">#&gt; 15      NA     NA      NA  M_lvlone[80,2]</span>
<span class="co">#&gt; 16      NA     NA      NA  M_lvlone[86,2]</span>
<span class="co">#&gt; 17      NA     NA      NA  M_lvlone[91,2]</span>
<span class="co">#&gt; 18      NA     NA      NA  M_lvlone[92,2]</span>
<span class="co">#&gt; 19      NA     NA      NA M_lvlone[105,2]</span>
<span class="co">#&gt; 20      NA     NA      NA M_lvlone[111,2]</span>
<span class="co">#&gt; 21      NA     NA      NA M_lvlone[115,2]</span>
<span class="co">#&gt; 22      NA     NA      NA M_lvlone[118,2]</span>
<span class="co">#&gt; 23      NA     NA      NA M_lvlone[120,2]</span>
<span class="co">#&gt; 24      NA     NA      NA M_lvlone[127,2]</span>
<span class="co">#&gt; 25      NA     NA      NA M_lvlone[132,2]</span>
<span class="co">#&gt; 26      NA     NA      NA M_lvlone[139,2]</span>
<span class="co">#&gt; 27      NA     NA      NA M_lvlone[146,2]</span>
<span class="co">#&gt; 28      NA     NA      NA M_lvlone[149,2]</span>
<span class="co">#&gt; 29      NA     NA      NA M_lvlone[152,2]</span>
<span class="co">#&gt; 30      NA     NA      NA M_lvlone[163,2]</span>
<span class="co">#&gt; 31      NA     NA      NA M_lvlone[165,2]</span>
<span class="co">#&gt; 32      NA     NA      NA M_lvlone[169,2]</span>
<span class="co">#&gt; 33      NA     NA      NA M_lvlone[180,2]</span>
<span class="co">#&gt; 34      NA     NA      NA M_lvlone[185,2]</span>
<span class="co">#&gt; 35      NA     NA      NA   M_lvlone[6,3]</span>
<span class="co">#&gt; 36      NA     NA      NA  M_lvlone[16,3]</span>
<span class="co">#&gt; 37      NA     NA      NA  M_lvlone[24,3]</span>
<span class="co">#&gt; 38      NA     NA      NA  M_lvlone[27,3]</span>
<span class="co">#&gt; 39      NA     NA      NA  M_lvlone[45,3]</span>
<span class="co">#&gt; 40      NA     NA      NA  M_lvlone[57,3]</span>
<span class="co">#&gt; 41      NA     NA      NA  M_lvlone[58,3]</span>
<span class="co">#&gt; 42      NA     NA      NA  M_lvlone[60,3]</span>
<span class="co">#&gt; 43      NA     NA      NA  M_lvlone[61,3]</span>
<span class="co">#&gt; 44      NA     NA      NA  M_lvlone[65,3]</span>
<span class="co">#&gt; 45      NA     NA      NA  M_lvlone[66,3]</span>
<span class="co">#&gt; 46      NA     NA      NA  M_lvlone[70,3]</span>
<span class="co">#&gt; 47      NA     NA      NA  M_lvlone[80,3]</span>
<span class="co">#&gt; 48      NA     NA      NA  M_lvlone[81,3]</span>
<span class="co">#&gt; 49      NA     NA      NA  M_lvlone[85,3]</span>
<span class="co">#&gt; 50      NA     NA      NA  M_lvlone[88,3]</span>
<span class="co">#&gt; 51      NA     NA      NA  M_lvlone[89,3]</span>
<span class="co">#&gt; 52      NA     NA      NA  M_lvlone[90,3]</span>
<span class="co">#&gt; 53      NA     NA      NA M_lvlone[101,3]</span>
<span class="co">#&gt; 54      NA     NA      NA M_lvlone[104,3]</span>
<span class="co">#&gt; 55      NA     NA      NA M_lvlone[116,3]</span>
<span class="co">#&gt; 56      NA     NA      NA M_lvlone[133,3]</span>
<span class="co">#&gt; 57      NA     NA      NA M_lvlone[137,3]</span>
<span class="co">#&gt; 58      NA     NA      NA M_lvlone[143,3]</span>
<span class="co">#&gt; 59      NA     NA      NA M_lvlone[168,3]</span>
<span class="co">#&gt; 60      NA     NA      NA M_lvlone[170,3]</span>
<span class="co">#&gt; 61      NA     NA      NA M_lvlone[180,3]</span>
<span class="co">#&gt; 62      NA     NA      NA M_lvlone[186,3]</span>
<span class="co">#&gt; 63      NA     NA      NA  M_lvlone[16,4]</span>
<span class="co">#&gt; 64      NA     NA      NA  M_lvlone[99,4]</span>
<span class="co">#&gt; 65      NA     NA      NA M_lvlone[123,4]</span>
<span class="co">#&gt; 66      NA     NA      NA M_lvlone[156,4]</span>
<span class="co">#&gt; 67      NA     NA      NA M_lvlone[158,4]</span>
<span class="co">#&gt; 68      NA     NA      NA M_lvlone[166,4]</span>
<span class="co">#&gt; 69      NA     NA      NA M_lvlone[172,4]</span>
<span class="co">#&gt; 70      NA     NA      NA  M_lvlone[33,5]</span>
<span class="co">#&gt; 71      NA     NA      NA M_lvlone[150,5]</span></pre></body></html></div>
<p><strong>JointAI</strong> uses separate data matrices per level in the hierarchy of a multi-level model. The lowest level (and only level for models with no hierarchical structure) is called <code>lvlone</code>, the other levels are named based on the corresponding grouping/id variables.</p>
<p>For categorical variables the original variable as well as the corresponding dummy variables are stored in the matrices. The same is the case for interaction terms and transformations of variables.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">lm2</span>$<span class="no">data_list</span>$<span class="no">M_lvlone</span>)
<span class="co">#&gt;          SBP alc occup smoke    WC (Intercept) age alc&gt;=1 smokeformer</span>
<span class="co">#&gt; 10  108.0000  NA     1     1  99.0           1  35     NA          NA</span>
<span class="co">#&gt; 14  105.3333   0     1     1  82.7           1  38     NA          NA</span>
<span class="co">#&gt; 41  110.0000   0     3     1  94.9           1  78     NA          NA</span>
<span class="co">#&gt; 77  106.0000   1     2     1  82.4           1  23     NA          NA</span>
<span class="co">#&gt; 91  114.6667   0     3     1  93.1           1  40     NA          NA</span>
<span class="co">#&gt; 105 139.3333   1    NA     3 105.4           1  54     NA          NA</span>
<span class="co">#&gt;     smokecurrent occuplooking for work occupnot working</span>
<span class="co">#&gt; 10            NA                    NA               NA</span>
<span class="co">#&gt; 14            NA                    NA               NA</span>
<span class="co">#&gt; 41            NA                    NA               NA</span>
<span class="co">#&gt; 77            NA                    NA               NA</span>
<span class="co">#&gt; 91            NA                    NA               NA</span>
<span class="co">#&gt; 105           NA                    NA               NA</span></pre></body></html></div>
<p>The parameters of the models for the incomplete variables can be selected with <code>monitor_params = c(other_models = TRUE)</code>. This will set monitors for the regression coefficients (<code>alpha</code>) and other parameters, such as precision (<code>tau_*</code>) and intercepts &amp; increments (<code>gamma_*</code> and <code>delta_*</code>) in cumulative logit models.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">lm3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">age</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">smoke</span> + <span class="no">occup</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>, <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>,
              <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">other_models</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
)

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lm3</span>)
<span class="co">#&gt;    outcome                outcat               varname        coef</span>
<span class="co">#&gt; 1      alc                  &lt;NA&gt;           (Intercept)    alpha[1]</span>
<span class="co">#&gt; 2      alc                  &lt;NA&gt;                   age    alpha[2]</span>
<span class="co">#&gt; 3      alc                  &lt;NA&gt;                    WC    alpha[3]</span>
<span class="co">#&gt; 4      alc                  &lt;NA&gt;           smokeformer    alpha[4]</span>
<span class="co">#&gt; 5      alc                  &lt;NA&gt;          smokecurrent    alpha[5]</span>
<span class="co">#&gt; 6      alc                  &lt;NA&gt; occuplooking for work    alpha[6]</span>
<span class="co">#&gt; 7      alc                  &lt;NA&gt;      occupnot working    alpha[7]</span>
<span class="co">#&gt; 8    occup occuplooking for work           (Intercept)    alpha[8]</span>
<span class="co">#&gt; 9    occup occuplooking for work                   age    alpha[9]</span>
<span class="co">#&gt; 10   occup occuplooking for work                    WC   alpha[10]</span>
<span class="co">#&gt; 11   occup occuplooking for work           smokeformer   alpha[11]</span>
<span class="co">#&gt; 12   occup occuplooking for work          smokecurrent   alpha[12]</span>
<span class="co">#&gt; 13   occup      occupnot working           (Intercept)   alpha[13]</span>
<span class="co">#&gt; 14   occup      occupnot working                   age   alpha[14]</span>
<span class="co">#&gt; 15   occup      occupnot working                    WC   alpha[15]</span>
<span class="co">#&gt; 16   occup      occupnot working           smokeformer   alpha[16]</span>
<span class="co">#&gt; 17   occup      occupnot working          smokecurrent   alpha[17]</span>
<span class="co">#&gt; 18   smoke                  &lt;NA&gt;                   age   alpha[18]</span>
<span class="co">#&gt; 19   smoke                  &lt;NA&gt;                    WC   alpha[19]</span>
<span class="co">#&gt; 20      WC                  &lt;NA&gt;           (Intercept)   alpha[20]</span>
<span class="co">#&gt; 21      WC                  &lt;NA&gt;                   age   alpha[21]</span>
<span class="co">#&gt; 22    &lt;NA&gt;                  &lt;NA&gt;                  &lt;NA&gt; gamma_smoke</span>
<span class="co">#&gt; 23    &lt;NA&gt;                  &lt;NA&gt;                  &lt;NA&gt;    sigma_WC</span></pre></body></html></div>
<div id="side-note-getting-information-about-of-the-imputation-models" class="section level4">
<h4 class="hasAnchor">
<a href="#side-note-getting-information-about-of-the-imputation-models" class="anchor"></a>Side note: Getting information about of the imputation models</h4>
<p>An overview of all models that form part of the joint model, including the names of the parameters and the hyper-parameters can be obtained with</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/list_models.html">list_models</a></span>(<span class="no">lm2</span>)
<span class="co">#&gt; Linear model for "SBP" </span>
<span class="co">#&gt;    family: gaussian </span>
<span class="co">#&gt;    link: identity </span>
<span class="co">#&gt; * Predictor variables:</span>
<span class="co">#&gt;   (Intercept), age, WC, alc&gt;=1, smokeformer, smokecurrent, occuplooking </span>
<span class="co">#&gt;   for work, occupnot working </span>
<span class="co">#&gt; * Regression coefficients:</span>
<span class="co">#&gt;   beta[1:8] (normal prior(s) with mean 0 and precision 1e-04) </span>
<span class="co">#&gt; * Precision of  "SBP" :</span>
<span class="co">#&gt;   tau_SBP (Gamma prior with shape parameter 0.01 and rate parameter 0.01)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Binomial model for "alc" </span>
<span class="co">#&gt;    family: binomial </span>
<span class="co">#&gt;    link: logit </span>
<span class="co">#&gt; * Reference category: "&lt;1"</span>
<span class="co">#&gt; * Predictor variables:</span>
<span class="co">#&gt;   (Intercept), age, WC, smokeformer, smokecurrent, occuplooking for </span>
<span class="co">#&gt;   work, occupnot working </span>
<span class="co">#&gt; * Regression coefficients:</span>
<span class="co">#&gt;   alpha[1:7] (normal prior(s) with mean 0 and precision 1e-04) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multinomial logit model for "occup" </span>
<span class="co">#&gt; * Reference category: "working"</span>
<span class="co">#&gt; * Predictor variables:</span>
<span class="co">#&gt;   (Intercept), age, WC, smokeformer, smokecurrent </span>
<span class="co">#&gt; * Regression coefficients:</span>
<span class="co">#&gt;   occuplooking for work: alpha[8:12]</span>
<span class="co">#&gt;   occupnot working: alpha[13:17] (normal prior(s) with mean 0 and precision 1e-04) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cumulative logit model for "smoke" </span>
<span class="co">#&gt; * Reference category: "never"</span>
<span class="co">#&gt; * Predictor variables:</span>
<span class="co">#&gt;   age, WC </span>
<span class="co">#&gt; * Regression coefficients:</span>
<span class="co">#&gt;   alpha[18:19] (normal prior(s) with mean 0 and precision 1e-04) </span>
<span class="co">#&gt; * Intercepts:</span>
<span class="co">#&gt;   - never: gamma_smoke[1] (normal prior with mean 0 and precision 1e-04)</span>
<span class="co">#&gt;   - former: gamma_smoke[2] = gamma_smoke[1] + exp(delta_smoke[1])</span>
<span class="co">#&gt; * Increments:</span>
<span class="co">#&gt;   delta_smoke[1] (normal prior(s) with mean 0 and precision 1e-04)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear model for "WC" </span>
<span class="co">#&gt;    family: gaussian </span>
<span class="co">#&gt;    link: identity </span>
<span class="co">#&gt; * Predictor variables:</span>
<span class="co">#&gt;   (Intercept), age </span>
<span class="co">#&gt; * Regression coefficients:</span>
<span class="co">#&gt;   alpha[20:21] (normal prior(s) with mean 0 and precision 1e-04) </span>
<span class="co">#&gt; * Precision of  "WC" :</span>
<span class="co">#&gt;   tau_WC (Gamma prior with shape parameter 0.01 and rate parameter 0.01)</span></pre></body></html></div>
</div>
<div id="side-note-how-to-extract-imputed-datasets" class="section level4">
<h4 class="hasAnchor">
<a href="#side-note-how-to-extract-imputed-datasets" class="anchor"></a>Side note: How to extract imputed datasets</h4>
<p>Imputed datasets can be extracted and exported with the function <a href="https://nerler.github.io/JointAI/reference/get_MIdat.html"><code><a href="../reference/get_MIdat.html">get_MIdat()</a></code></a>. A completed dataset is created by taking the imputed values from a randomly chosen iteration of the MCMC sample (transforming them back to the original scale, if scaling had been performed during the MCMC sampling) and filling them into the original, incomplete data.</p>
<p><code><a href="../reference/get_MIdat.html">get_MIdat()</a></code> returns a long-format <code>data.frame</code> containing the imputed datasets (and possibly the original data) stacked onto each other. The imputation number is given in the variable <code>Imputation_</code>, column <code>.id</code> contains a newly created id variable for each observation in cross-sectional data (multi-level data should already contain an id variable).</p>
<p><code><a href="../reference/get_MIdat.html">get_MIdat()</a></code> takes the arguments:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="91%">
</colgroup>
<thead><tr class="header">
<th align="left">argument</th>
<th align="left">explanation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>object</code></td>
<td align="left">‘an object of class ’JointAI’</td>
</tr>
<tr class="even">
<td align="left"><code>m</code></td>
<td align="left">number of datasets to be created</td>
</tr>
<tr class="odd">
<td align="left"><code>include</code></td>
<td align="left">logical; should the original data be included?</td>
</tr>
<tr class="even">
<td align="left"><code>start</code></td>
<td align="left">the first iteration that may be randomly chosen (i.e., all previous iterations are discarded as burn-in)</td>
</tr>
<tr class="odd">
<td align="left"><code>minspace</code></td>
<td align="left">minimum number of iterations between iterations chosen as imputed values</td>
</tr>
<tr class="even">
<td align="left"><code>seed</code></td>
<td align="left">optional seed value in order to make the random selection of iterations reproducible</td>
</tr>
<tr class="odd">
<td align="left"><code>export_to_SPSS</code></td>
<td align="left">logical; should the datasets be exported to SPSS, i.e., written as .txt and .sps file? If <code>export_to_SPSS = FALSE</code> (default) the imputed data is only returned <code>data.frame</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>resdir</code></td>
<td align="left">directory the files are exported to</td>
</tr>
<tr class="odd">
<td align="left"><code>filename</code></td>
<td align="left">the name of the .txt and .sps files</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="random-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#random-effects" class="anchor"></a>Random effects</h3>
<p>For mixed models, <code>analysis_main</code> also includes the random effects covariance matrix <code>D</code>:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">lme1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lme_imp</a></span>(<span class="no">bmi</span> ~ <span class="no">age</span> + <span class="no">EDUC</span>, <span class="kw">random</span> <span class="kw">=</span> ~<span class="no">age</span> <span class="kw">|</span> <span class="no">ID</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">simLong</span>, <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>)

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lme1</span>)
<span class="co">#&gt;   outcome outcat     varname          coef</span>
<span class="co">#&gt; 1     bmi   &lt;NA&gt; (Intercept)       beta[1]</span>
<span class="co">#&gt; 2     bmi   &lt;NA&gt;     EDUCmid       beta[2]</span>
<span class="co">#&gt; 3     bmi   &lt;NA&gt;     EDUClow       beta[3]</span>
<span class="co">#&gt; 4     bmi   &lt;NA&gt;         age       beta[4]</span>
<span class="co">#&gt; 5    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     sigma_bmi</span>
<span class="co">#&gt; 6    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; D_bmi_ID[1,1]</span>
<span class="co">#&gt; 7    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; D_bmi_ID[1,2]</span>
<span class="co">#&gt; 8    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; D_bmi_ID[2,2]</span></pre></body></html></div>
<p>Setting <code>analysis_random = TRUE</code> will switch on monitoring for the random effects (<code>ranef</code>), random effects covariance matrix (<code>D</code>), inverse of the random effects covariance matrix (<code>invD</code>) and the diagonal of the scale matrix of the Wishart-prior of <code>invD</code> (<code>RinvD</code>).</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">lme2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lme_imp</a></span>(<span class="no">bmi</span> ~ <span class="no">age</span> + <span class="no">EDUC</span>, <span class="kw">random</span> <span class="kw">=</span> ~<span class="no">age</span> <span class="kw">|</span> <span class="no">ID</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">simLong</span>, <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>,
                <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">analysis_random</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lme2</span>)
<span class="co">#&gt;    outcome outcat     varname              coef</span>
<span class="co">#&gt; 1      bmi   &lt;NA&gt; (Intercept)           beta[1]</span>
<span class="co">#&gt; 2      bmi   &lt;NA&gt;     EDUCmid           beta[2]</span>
<span class="co">#&gt; 3      bmi   &lt;NA&gt;     EDUClow           beta[3]</span>
<span class="co">#&gt; 4      bmi   &lt;NA&gt;         age           beta[4]</span>
<span class="co">#&gt; 5     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;         sigma_bmi</span>
<span class="co">#&gt; 6     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;          b_bmi_ID</span>
<span class="co">#&gt; 7     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;  invD_bmi_ID[1,1]</span>
<span class="co">#&gt; 8     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;  invD_bmi_ID[1,2]</span>
<span class="co">#&gt; 9     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;  invD_bmi_ID[2,2]</span>
<span class="co">#&gt; 10    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     D_bmi_ID[1,1]</span>
<span class="co">#&gt; 11    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     D_bmi_ID[1,2]</span>
<span class="co">#&gt; 12    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     D_bmi_ID[2,2]</span>
<span class="co">#&gt; 13    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; RinvD_bmi_ID[1,1]</span>
<span class="co">#&gt; 14    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; RinvD_bmi_ID[2,2]</span></pre></body></html></div>
<p>It is possible to select only a subset of the random effects parameters by specifying them directly, e.g.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">lme3a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lme_imp</a></span>(<span class="no">bmi</span> ~ <span class="no">age</span> + <span class="no">EDUC</span>, <span class="kw">random</span> <span class="kw">=</span> ~<span class="no">age</span> <span class="kw">|</span> <span class="no">ID</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">simLong</span>, <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>,
                 <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">RinvD_main</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lme3a</span>)
<span class="co">#&gt;    outcome outcat     varname              coef</span>
<span class="co">#&gt; 1      bmi   &lt;NA&gt; (Intercept)           beta[1]</span>
<span class="co">#&gt; 2      bmi   &lt;NA&gt;     EDUCmid           beta[2]</span>
<span class="co">#&gt; 3      bmi   &lt;NA&gt;     EDUClow           beta[3]</span>
<span class="co">#&gt; 4      bmi   &lt;NA&gt;         age           beta[4]</span>
<span class="co">#&gt; 5     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;         sigma_bmi</span>
<span class="co">#&gt; 6     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     D_bmi_ID[1,1]</span>
<span class="co">#&gt; 7     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     D_bmi_ID[1,2]</span>
<span class="co">#&gt; 8     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;     D_bmi_ID[2,2]</span>
<span class="co">#&gt; 9     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; RinvD_bmi_ID[1,1]</span>
<span class="co">#&gt; 10    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; RinvD_bmi_ID[2,2]</span></pre></body></html></div>
<p>or by switching unwanted parts of <code>analysis_random</code> off, e.g.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">lme3b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lme_imp</a></span>(<span class="no">bmi</span> ~ <span class="no">age</span> + <span class="no">EDUC</span>, <span class="kw">random</span> <span class="kw">=</span> ~<span class="no">age</span> <span class="kw">|</span> <span class="no">ID</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">simLong</span>, <span class="kw">n.adapt</span> <span class="kw">=</span> <span class="fl">0</span>,
                <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">analysis_random</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                   <span class="kw">RinvD_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                   <span class="kw">ranef_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>))
<span class="co">#&gt; Warning: </span>
<span class="co">#&gt; It is currently not possible to use "contr.poly" for incomplete</span>
<span class="co">#&gt; categorical covariates. I will use "contr.treatment" instead.  You can</span>
<span class="co">#&gt; specify (globally) which types of contrasts are used by changing</span>
<span class="co">#&gt; "options('contrasts')".</span>

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lme3b</span>)
<span class="co">#&gt;    outcome outcat     varname             coef</span>
<span class="co">#&gt; 1      bmi   &lt;NA&gt; (Intercept)          beta[1]</span>
<span class="co">#&gt; 2      bmi   &lt;NA&gt;     EDUCmid          beta[2]</span>
<span class="co">#&gt; 3      bmi   &lt;NA&gt;     EDUClow          beta[3]</span>
<span class="co">#&gt; 4      bmi   &lt;NA&gt;         age          beta[4]</span>
<span class="co">#&gt; 5     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;        sigma_bmi</span>
<span class="co">#&gt; 6     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; invD_bmi_ID[1,1]</span>
<span class="co">#&gt; 7     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; invD_bmi_ID[1,2]</span>
<span class="co">#&gt; 8     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt; invD_bmi_ID[2,2]</span>
<span class="co">#&gt; 9     &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;    D_bmi_ID[1,1]</span>
<span class="co">#&gt; 10    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;    D_bmi_ID[1,2]</span>
<span class="co">#&gt; 11    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;    D_bmi_ID[2,2]</span></pre></body></html></div>
</div>
<div id="other-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a>Other parameters</h3>
<p>The element <code>other</code> in <code>monitor_params</code> allows to specify one or multiple additional parameters to be monitored. When <code>other</code> is used with more than one element, <code>monitor_params</code> has to be a list.</p>
<p>Here, we monitor the probability to be in the <code>alc&gt;=1</code> group for subjects 1 through 3 and the expected value of the distribution of <code>creat</code> for the first subject. (This may not make a lot of sense here but being able to monitor any node in a JAGS model can be quite useful when investigating convergence issues.)</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">lm4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">gender</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">creat</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>,
              <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                    <span class="kw">other</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'p_alc[1:3]'</span>, <span class="st">"mu_creat[1]"</span>)))

<span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lm4</span>)
<span class="co">#&gt;   outcome outcat varname        coef</span>
<span class="co">#&gt; 1      NA     NA      NA  p_alc[1:3]</span>
<span class="co">#&gt; 2      NA     NA      NA mu_creat[1]</span></pre></body></html></div>
</div>
</div>
<div id="subsets-of-parameters-for-plots-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#subsets-of-parameters-for-plots-summaries" class="anchor"></a>Subsets of Parameters for Plots, Summaries, …</h2>
<p>The functions <a href="https://nerler.github.io/JointAI/reference/summary.JointAI.html"><code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/traceplot.html"><code><a href="../reference/traceplot.html">traceplot()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/densplot.html"><code><a href="../reference/densplot.html">densplot()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/GR_crit.html"><code><a href="../reference/GR_crit.html">GR_crit()</a></code></a> and <a href="https://nerler.github.io/JointAI/reference/MC_error.html"><code><a href="../reference/MC_error.html">MC_error()</a></code></a> all have an argument <code>subset</code>. This argument allows us to select a subset of parameters to be shown in the output. Especially when not only the parameters of the main analysis model are followed, but also, for example, imputed values, looking at a subset may be desirable. For more details about these functions, see also the vignette <a href="https://nerler.github.io/JointAI/articles/AfterFitting.html"><em>After Fitting</em></a>.</p>
<p><code>subset</code> follows the same logic as <code>monitor_params</code> described above.</p>
<p>By default, only the parameters of the main analysis model are displayed if they were monitored:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># Run a model monitoring analysis parameters and imputation parameters</span>
<span class="no">lm5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">gender</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">creat</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>, <span class="kw">n.iter</span> <span class="kw">=</span> <span class="fl">100</span>,
              <span class="kw">progress.bar</span> <span class="kw">=</span> <span class="st">'none'</span>, <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">other_models</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="co"># model summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">lm5</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bayesian linear model fitted with JointAI</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES, </span>
<span class="co">#&gt;     n.iter = 100, monitor_params = c(other_models = TRUE), progress.bar = "none")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Posterior summary:</span>
<span class="co">#&gt;                Mean     SD   2.5%  97.5% tail-prob. GR-crit MCE/SD</span>
<span class="co">#&gt; (Intercept)  81.034 9.6778 61.139 97.757     0.0000    1.05 0.0577</span>
<span class="co">#&gt; genderfemale  0.779 2.6016 -4.509  5.491     0.7800    1.02 0.0577</span>
<span class="co">#&gt; WC            0.299 0.0696  0.154  0.437     0.0000    1.07 0.0727</span>
<span class="co">#&gt; alc&gt;=1        6.368 2.6325  1.081 11.217     0.0267    1.07 0.0811</span>
<span class="co">#&gt; creat         8.343 7.9969 -6.799 25.037     0.2400    1.03 0.0628</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Posterior summary of residual std. deviation:</span>
<span class="co">#&gt;           Mean   SD 2.5% 97.5% GR-crit MCE/SD</span>
<span class="co">#&gt; sigma_SBP 14.5 0.74   13  15.9    1.06 0.0622</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MCMC settings:</span>
<span class="co">#&gt; Iterations = 101:200</span>
<span class="co">#&gt; Sample size per chain = 100 </span>
<span class="co">#&gt; Thinning interval = 1 </span>
<span class="co">#&gt; Number of chains = 3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of observations: 186</span>

<span class="co"># traceplot of the MCMC sample</span>
<span class="fu"><a href="../reference/traceplot.html">traceplot</a></span>(<span class="no">lm5</span>)</pre></body></html></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">
<span class="co"># density plot of the MCMC sample</span>
<span class="fu"><a href="../reference/densplot.html">densplot</a></span>(<span class="no">lm5</span>)</pre></body></html></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">
<span class="co"># Gelman-Rubin criterion</span>
<span class="fu"><a href="../reference/GR_crit.html">GR_crit</a></span>(<span class="no">lm5</span>)
<span class="co">#&gt; Potential scale reduction factors:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Point est. Upper C.I.</span>
<span class="co">#&gt; (Intercept)        1.01       1.05</span>
<span class="co">#&gt; genderfemale       1.00       1.02</span>
<span class="co">#&gt; WC                 1.02       1.07</span>
<span class="co">#&gt; alc&gt;=1             1.02       1.07</span>
<span class="co">#&gt; creat              1.01       1.03</span>
<span class="co">#&gt; sigma_SBP          1.01       1.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multivariate psrf</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 1.04</span>

<span class="co"># Monte Carlo Error of the MCMC sample</span>
<span class="fu"><a href="../reference/MC_error.html">MC_error</a></span>(<span class="no">lm5</span>)
<span class="co">#&gt;                est   MCSE   SD MCSE/SD</span>
<span class="co">#&gt; (Intercept)  81.03 0.5587 9.68   0.058</span>
<span class="co">#&gt; genderfemale  0.78 0.1502 2.60   0.058</span>
<span class="co">#&gt; WC            0.30 0.0051 0.07   0.073</span>
<span class="co">#&gt; alc&gt;=1        6.37 0.2134 2.63   0.081</span>
<span class="co">#&gt; creat         8.34 0.5021 8.00   0.063</span>
<span class="co">#&gt; sigma_SBP    14.47 0.0460 0.74   0.062</span></pre></body></html></div>
<p>When <code>analysis_main</code> was not switched on the default behaviour is that all parameters are displayed:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># Re-run the model from above, now creating MCMC samples</span>
<span class="no">lm4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">gender</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">creat</span>,
              <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>, <span class="kw">n.iter</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">progress.bar</span> <span class="kw">=</span> <span class="st">'none'</span>,
              <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                                    <span class="kw">other</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'mu_alc[1:3]'</span>, <span class="st">"mu_creat[1]"</span>)))

<span class="fu"><a href="../reference/traceplot.html">traceplot</a></span>(<span class="no">lm4</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
<div id="select-a-subset-of-the-variables-to-display" class="section level3">
<h3 class="hasAnchor">
<a href="#select-a-subset-of-the-variables-to-display" class="anchor"></a>Select a subset of the variables to display</h3>
<p>To display other parts of the MCMC sample, <code>subset</code> needs to be specified:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># we use lm5 from above</span>
<span class="fu"><a href="../reference/GR_crit.html">GR_crit</a></span>(<span class="no">lm5</span>, <span class="kw">subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">other_models</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="co">#&gt; Potential scale reduction factors:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                     Point est. Upper C.I.</span>
<span class="co">#&gt; alc: (Intercept)         1.019      1.065</span>
<span class="co">#&gt; alc: genderfemale        1.033      1.113</span>
<span class="co">#&gt; alc: WC                  1.019      1.044</span>
<span class="co">#&gt; alc: creat               1.009      1.034</span>
<span class="co">#&gt; creat: (Intercept)       1.015      1.060</span>
<span class="co">#&gt; creat: genderfemale      1.010      1.041</span>
<span class="co">#&gt; creat: WC                1.013      1.057</span>
<span class="co">#&gt; WC: (Intercept)          1.001      1.003</span>
<span class="co">#&gt; WC: genderfemale         0.997      0.999</span>
<span class="co">#&gt; sigma_creat              0.997      1.000</span>
<span class="co">#&gt; sigma_WC                 1.003      1.021</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multivariate psrf</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 1.07</span></pre></body></html></div>
<p>To select only some of the parameters, they can be specified directly by name via the <code>other</code> element of <code>subset</code>:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">lm5</span>, <span class="kw">subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">other</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'creat'</span>, <span class="st">'alc&gt;=1'</span>)))
<span class="co">#&gt; </span>
<span class="co">#&gt; Bayesian linear model fitted with JointAI</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES, </span>
<span class="co">#&gt;     n.iter = 100, monitor_params = c(other_models = TRUE), progress.bar = "none")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Posterior summary:</span>
<span class="co">#&gt;                Mean     SD   2.5%  97.5% tail-prob. GR-crit MCE/SD</span>
<span class="co">#&gt; (Intercept)  81.034 9.6778 61.139 97.757     0.0000    1.05 0.0577</span>
<span class="co">#&gt; genderfemale  0.779 2.6016 -4.509  5.491     0.7800    1.02 0.0577</span>
<span class="co">#&gt; WC            0.299 0.0696  0.154  0.437     0.0000    1.07 0.0727</span>
<span class="co">#&gt; alc&gt;=1        6.368 2.6325  1.081 11.217     0.0267    1.07 0.0811</span>
<span class="co">#&gt; creat         8.343 7.9969 -6.799 25.037     0.2400    1.03 0.0628</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Posterior summary of residual std. deviation:</span>
<span class="co">#&gt;           Mean   SD 2.5% 97.5% GR-crit MCE/SD</span>
<span class="co">#&gt; sigma_SBP 14.5 0.74   13  15.9    1.06 0.0622</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MCMC settings:</span>
<span class="co">#&gt; Iterations = 101:200</span>
<span class="co">#&gt; Sample size per chain = 100 </span>
<span class="co">#&gt; Thinning interval = 1 </span>
<span class="co">#&gt; Number of chains = 3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of observations: 186</span></pre></body></html></div>
<p>Note that the model summary will contain separate parts per sub-model when regression coefficients from different models are monitored.</p>
<p>This also works when a subset of the imputed values should be displayed:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># Re-run the model from above, now creating MCMC samples</span>
<span class="no">lm2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span>(<span class="no">SBP</span> ~ <span class="no">age</span> + <span class="no">WC</span> + <span class="no">alc</span> + <span class="no">smoke</span> + <span class="no">occup</span>,
              <span class="kw">data</span> <span class="kw">=</span> <span class="no">NHANES</span>, <span class="kw">n.iter</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">progress.bar</span> <span class="kw">=</span> <span class="st">'none'</span>,
              <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">imps</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
)

<span class="co"># select only imputed values for 'WC' (4th column of Wc)</span>
<span class="no">sub3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'M_lvlone\\[[[:digit:]]+,5\\]'</span>, <span class="fu"><a href="../reference/parameters.html">parameters</a></span>(<span class="no">lm2</span>)$<span class="no">coef</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">sub3</span>
<span class="co">#&gt; [1] "M_lvlone[33,5]"  "M_lvlone[150,5]"</span>

<span class="fu"><a href="../reference/traceplot.html">traceplot</a></span>(<span class="no">lm2</span>, <span class="kw">subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">other</span> <span class="kw">=</span> <span class="no">sub3</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="SelectingParameters_files/figure-html/lm2_2-1.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div id="random-subset-of-subject-specific-values" class="section level3">
<h3 class="hasAnchor">
<a href="#random-subset-of-subject-specific-values" class="anchor"></a>Random subset of subject-specific values</h3>
<p>When the number of imputed values is larger, or in order to check convergence of random effects, it may not be feasible to plot all trace plots. In that case, a random subset of, for instance, the random effects can be selected:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">lme4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lme_imp</a></span>(<span class="no">bmi</span> ~ <span class="no">age</span> + <span class="no">EDUC</span>, <span class="kw">random</span> <span class="kw">=</span> ~<span class="no">age</span> <span class="kw">|</span> <span class="no">ID</span>,
                <span class="kw">data</span> <span class="kw">=</span> <span class="no">simLong</span>, <span class="kw">n.iter</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">progress.bar</span> <span class="kw">=</span> <span class="st">'none'</span>,
                <span class="kw">monitor_params</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">analysis_main</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ranef_main</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="co"># exract random intercepts</span>
<span class="no">ri</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'^b_bmi_ID\\[[[:digit:]]+,1\\]$'</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">lme4</span>$<span class="no">MCMC</span><span class="kw">[[</span><span class="fl">1</span>]]), <span class="kw">value</span> <span class="kw">=</span> <span class="no">T</span>)

<span class="co"># extract random slopes</span>
<span class="no">rs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'^b_bmi_ID\\[[[:digit:]]+,2\\]$'</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">lme4</span>$<span class="no">MCMC</span><span class="kw">[[</span><span class="fl">1</span>]]), <span class="kw">value</span> <span class="kw">=</span> <span class="no">T</span>)

<span class="co"># plot the chains of 8 randomly selected random intercepts</span>
<span class="fu"><a href="../reference/traceplot.html">traceplot</a></span>(<span class="no">lme4</span>, <span class="kw">subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">other</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">ri</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>)), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">
<span class="co"># plot the chains of 8 randomly selected random slopes</span>
<span class="fu"><a href="../reference/traceplot.html">traceplot</a></span>(<span class="no">lme4</span>, <span class="kw">subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">other</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">rs</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>)), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-11-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '0d21d69e7c3eb00e029f5b8d9424cd56',
    indexName: 'jointal',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>

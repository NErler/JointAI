<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Minimal Example • JointAI</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Minimal Example">
<meta name="description" content="A minimal example to demonstrate the usage of the R package JointAI.">
<meta property="og:description" content="A minimal example to demonstrate the usage of the R package JointAI.">
<meta property="og:image" content="https://nerler.github.io/JointAI/reference/figures/JointAI_square.png">
<meta property="og:image:alt" content="JointAI: An R package for Joint Analysis and Imputation">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@NErler">
<meta name="twitter:site" content="../,JointAI">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JointAI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AfterFitting.html">After Fitting</a></li>
    <li><a class="dropdown-item" href="../articles/MCMCsettings.html">MCMC Settings</a></li>
    <li><a class="dropdown-item" href="../articles/MinimalExample.html">Minimal Example</a></li>
    <li><a class="dropdown-item" href="../articles/ModelSpecification.html">Model Specification</a></li>
    <li><a class="dropdown-item" href="../articles/SelectingParameters.html">Parameter Selection</a></li>
    <li><a class="dropdown-item" href="../articles/TheoreticalBackground.html">Theoretical Background</a></li>
    <li><a class="dropdown-item" href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nerler/JointAI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Minimal Example</h1>
                        <h4 data-toc-skip class="author">Nicole
Erler</h4>
            
            <h4 data-toc-skip class="date">February 22, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/master/vignettes/MinimalExample.Rmd" class="external-link"><code>vignettes/MinimalExample.Rmd</code></a></small>
      <div class="d-none name"><code>MinimalExample.Rmd</code></div>
    </div>

    
    
<p>This vignette gives a first and very brief overview of how the
package <strong>JointAI</strong> can be used. The different settings and
options are explained in more depth in the <a href="https://nerler.github.io/JointAI/reference/index.html">help
pages</a> and other <a href="https://nerler.github.io/JointAI/articles/index.html">vignettes</a>.</p>
<p>Here, we use the NHANES data that are part of the
<strong>JointAI</strong> package. For more info on this data, check the
<a href="https://nerler.github.io/JointAI/reference/NHANES.html">help
file</a> for the NHANES data, go to the <a href="https://www.cdc.gov/nchs/nhanes/index.htm" class="external-link">web page of the
National Health and Nutrition Examination Survey (NHANES)</a> and check
out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html"><em>Visualizing
Incomplete Data</em></a>, in which the NHANES data is explored.</p>
<div class="section level2">
<h2 id="fitting-a-linear-regression-model">Fitting a linear regression model<a class="anchor" aria-label="anchor" href="#fitting-a-linear-regression-model"></a>
</h2>
<p>Fitting a linear regression model with <strong>JointAI</strong> is
straightforward with the function <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>lm_imp()</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_imp.html">lm_imp</a></span><span class="op">(</span><span class="va">SBP</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">WC</span> <span class="op">+</span> <span class="va">alc</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">albu</span> <span class="op">+</span> <span class="va">bili</span>,</span>
<span>              data <span class="op">=</span> <span class="va">NHANES</span>, n.iter <span class="op">=</span> <span class="fl">500</span>, progress.bar <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p>The specification of <code><a href="../reference/model_imp.html">lm_imp()</a></code> is similar to the
specification of a linear regression model for complete data using
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>. In this minimal example, the only difference is that
for <code><a href="../reference/model_imp.html">lm_imp()</a></code> the number of iterations <code>n.iter</code>
has to be specified. Of course, there are many more parameters that can
(and sometimes should) be specified. In the vignette <a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html"><em>Model
Specification</em></a>, many of these parameters are explained in
detail.</p>
<p><code>n.iter</code> specifies the length of the <a href="https://en.wikipedia.org/wiki/Markov_chain" class="external-link">Markov chain</a>,
i.e., the number of draws from the posterior distribution of the
parameter or unobserved value. How many iterations are necessary depends
on the data and complexity of the model and can vary from as few as 100
up to thousands or millions.</p>
<p>One important criterion is that the Markov chains need to have
converged. Convergence can be evaluated visually with a trace plot.</p>
</div>
<div class="section level2">
<h2 id="traceplot">Traceplot<a class="anchor" aria-label="anchor" href="#traceplot"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/traceplot.html">traceplot</a></span><span class="op">(</span><span class="va">lm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures_MinimalExample/results_lm1-1.svg" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>The function <a href="https://nerler.github.io/JointAI/reference/traceplot.html"><code>traceplot()</code></a>
produces a plot of the sampled values across iterations per parameter.
Different chains are represented by different colours.</p>
<p>When the sampler has converged, the chains show a horizontal band, as
in the above figure. Consequently, when traces show a trend, convergence
has not been reached, and more iterations are necessary (e.g., using the
function <a href="https://nerler.github.io/JointAI/reference/add_samples.html"><code>add_samples()</code></a>).</p>
<p>When the chains have converged, we can obtain the result of the model
from the model summary.</p>
</div>
<div class="section level2">
<h2 id="model-summary">Model Summary<a class="anchor" aria-label="anchor" href="#model-summary"></a>
</h2>
<p>Results from a model fitted with <strong>JointAI</strong> can be
printed using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayesian linear model fitted with JointAI</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm_imp(formula = SBP ~ gender + age + race + WC + alc + educ + </span></span>
<span><span class="co">#&gt;     albu + bili, data = NHANES, n.iter = 500, progress.bar = "none")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Posterior summary:</span></span>
<span><span class="co">#&gt;                          Mean      SD     2.5%   97.5% tail-prob. GR-crit MCE/SD</span></span>
<span><span class="co">#&gt; (Intercept)            60.879 22.8704  19.1247 106.227     0.0040    1.00 0.0271</span></span>
<span><span class="co">#&gt; genderfemale           -3.177  2.2549  -7.6423   1.099     0.1640    1.00 0.0258</span></span>
<span><span class="co">#&gt; age                     0.364  0.0708   0.2196   0.505     0.0000    1.01 0.0258</span></span>
<span><span class="co">#&gt; raceOther Hispanic      0.518  5.0580  -9.2403  10.675     0.9373    1.00 0.0258</span></span>
<span><span class="co">#&gt; raceNon-Hispanic White -1.451  3.0937  -7.2049   4.686     0.6227    1.00 0.0276</span></span>
<span><span class="co">#&gt; raceNon-Hispanic Black  9.047  3.6389   2.0441  16.042     0.0147    1.00 0.0267</span></span>
<span><span class="co">#&gt; raceother               3.686  3.4550  -3.0852  10.725     0.2653    1.00 0.0268</span></span>
<span><span class="co">#&gt; WC                      0.236  0.0822   0.0754   0.392     0.0040    1.00 0.0258</span></span>
<span><span class="co">#&gt; alc&gt;=1                  7.272  2.3870   2.5418  11.763     0.0040    1.03 0.0284</span></span>
<span><span class="co">#&gt; educhigh               -3.397  2.1457  -7.3896   0.869     0.1120    1.00 0.0258</span></span>
<span><span class="co">#&gt; albu                    5.320  4.0590  -2.7810  12.922     0.1987    1.00 0.0291</span></span>
<span><span class="co">#&gt; bili                   -5.516  4.9060 -15.2486   4.592     0.2413    1.01 0.0274</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Posterior summary of residual std. deviation:</span></span>
<span><span class="co">#&gt;           Mean    SD 2.5% 97.5% GR-crit MCE/SD</span></span>
<span><span class="co">#&gt; sigma_SBP 13.2 0.738 11.9  14.7    1.02 0.0282</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MCMC settings:</span></span>
<span><span class="co">#&gt; Iterations = 101:600</span></span>
<span><span class="co">#&gt; Sample size per chain = 500 </span></span>
<span><span class="co">#&gt; Thinning interval = 1 </span></span>
<span><span class="co">#&gt; Number of chains = 3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 186</span></span></code></pre></div>
<p>The output gives the posterior summary, i.e., the summary of the MCMC
(<a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" class="external-link">Markov
Chain Monte Carlo</a>) sample, which consists of all chains
combined.</p>
<p>By default, <a href="https://nerler.github.io/JointAI/reference/summary.JointAI.html"><code>summary()</code></a>
will only print the posterior summary for the main model parameters of
the analysis model. How one can select which parameters are shown is
described in the vignette <a href="https://nerler.github.io/JointAI/articles/SelectingParameters.html"><em>Selecting
Parameters</em></a>.</p>
<p>The summary consists of the posterior mean, the standard deviation,
2.5% and 97.5% quantiles of the MCMC sample, the tail probability, the
Gelman-Rubin criterion for convergence and the ratio of the Monte Carlo
error to the standard deviation of the posterior sample.</p>
<div class="section level4">
<h4 id="tail-probability">Tail probability<a class="anchor" aria-label="anchor" href="#tail-probability"></a>
</h4>
<p>The tail probability is a measure of how likely the value 0 is under
the estimated posterior distribution, and is calculated as <span class="math display">2\times\min\left\{Pr(\theta &gt; 0), Pr(\theta &lt;
0)\right\}</span> (where <span class="math inline">\theta</span> is the
parameter of interest).</p>
<p>In the following graphics, the shaded areas represent the minimum of
<span class="math inline">Pr(\theta &gt; 0)</span> and <span class="math inline">Pr(\theta &lt; 0)</span>:
<img src="figures_MinimalExample/tailprob-1.svg" alt="" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="gelman-rubin-criterion">Gelman-Rubin criterion<a class="anchor" aria-label="anchor" href="#gelman-rubin-criterion"></a>
</h4>
<p>The Gelman-Rubin<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Gelman, A and Rubin, DB (1992) Inference from iterative
simulation using multiple sequences, Statistical Science, 7,
457-511.&lt;br&gt; Brooks, SP. and Gelman, A. (1998) General methods for
monitoring convergence of iterative simulations. Journal of
Computational and Graphical Statistics, 7, 434-455.&lt;/p&gt;"><sup>1</sup></a> criterion, also available via the function
<a href="https://nerler.github.io/JointAI/reference/GR_crit.html"><code>GR_crit()</code></a>,
compares the within and between chain variation. When it is close enough
to 1<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;for example &amp;lt; 1.1; but this is not a generally
accepted cut-off&lt;/p&gt;"><sup>2</sup></a>,
the chains can be assumed to have converged.</p>
</div>
<div class="section level4">
<h4 id="monte-carlo-error">Monte Carlo error<a class="anchor" aria-label="anchor" href="#monte-carlo-error"></a>
</h4>
<p>The Monte Carlo error is a measure of the error that is made because
the estimate is based on a finite sample. It can also be obtained using
the function <a href="https://nerler.github.io/JointAI/reference/MC_error.html"><code>MC_error()</code></a>.
Ideally, the Monte Carlo error should be small compared to the standard
error of the posterior sample. The values shown in the model summary are
the Monte Carlo error divided by the posterior standard deviation.</p>
</div>
<div class="section level4">
<h4 id="additional-information">Additional information<a class="anchor" aria-label="anchor" href="#additional-information"></a>
</h4>
<p>In the model summary, additionally, some important characteristics of
the MCMC samples on which the summary is based, are given. This includes
the range and number of iterations (=
<code>Sample size per chain</code>), thinning interval and number of
chains.</p>
<p>Furthermore, the number of observations (the sample size of the data)
is given.</p>
<p>With the arguments <code>start</code>, <code>end</code> and
<code>thin</code> it is possible to select which iterations from the
MCMC sample are included in the summary.</p>
<p>For example:<br> When the traceplot shows that the chains only
converged after 1500 iterations, <code>start = 1500</code> should be
specified in <a href="https://nerler.github.io/JointAI/reference/summary.JointAI.html"><code>summary()</code></a>.</p>
<p>A summary of the missing values in all variables involved in the
model can be added to the summary by setting
<code>missinfo = TRUE</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-of-the-posterior-distributions">Plot of the posterior distributions<a class="anchor" aria-label="anchor" href="#plot-of-the-posterior-distributions"></a>
</h2>
<p>The posterior distributions can be visualized using the function
<code><a href="../reference/densplot.html">densplot()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/densplot.html">densplot</a></span><span class="op">(</span><span class="va">lm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures_MinimalExample/densplot-1.svg" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>By default, <code><a href="../reference/densplot.html">densplot()</a></code> plots the empirical distribution
of each of the chains separately. When <code>joined = TRUE</code> the
distributions of the combined chains are plotted.</p>
</div>
<div class="section level2">
<h2 id="other-types-of-models">Other types of models<a class="anchor" aria-label="anchor" href="#other-types-of-models"></a>
</h2>
<p>Besides linear regression models, it is also possible to fit</p>
<ul>
<li><p><strong>generalized linear models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>glm_imp()</code></a></p></li>
<li><p><strong>log-normal models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>lognorm_imp()</code></a></p></li>
<li><p><strong>beta models</strong> for continuous outcomes between 0
and 1 (proportions): <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>betareg_imp()</code></a></p></li>
<li><p><strong>cumulative logit models</strong> for ordinal outcomes: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>clm_imp()</code></a></p></li>
<li><p><strong>multinomial logit models</strong> for unordered factors
with multiple levels: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>mlogit_imp()</code></a></p></li>
<li><p><strong>linear mixed models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>lme_imp()</code></a>
or <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>lmer_imp()</code></a>
(identical)</p></li>
<li><p><strong>generalized linear mixed models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>glme_imp()</code></a>
or <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>glmer_imp()</code></a>
(identical)</p></li>
<li><p><strong>log-normal mixed models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>lognormmm_imp()</code></a></p></li>
<li><p><strong>beta mixed models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>betamm_imp()</code></a></p></li>
<li><p><strong>cumulative logit mixed models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>clmm_imp()</code></a></p></li>
<li><p><strong>multinomial logit mixed models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>mlogitmm_imp()</code></a></p></li>
<li><p><strong>parametric (Weibull) survival models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>survreg_imp()</code></a></p></li>
<li><p><strong>proportional hazards survival models</strong>: <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>coxph_imp()</code></a></p></li>
<li><p><strong>joint models for longitudinal and survival data</strong>:
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>JM_imp()</code></a></p></li>
</ul>
<p>It is also possible to specify multiple analysis models at the same
time, by providing a list of model formulas.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

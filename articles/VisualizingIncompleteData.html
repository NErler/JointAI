<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing Incomplete Data • JointAI</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing Incomplete Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JointAI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AfterFitting.html">After Fitting</a></li>
    <li><a class="dropdown-item" href="../articles/MCMCsettings.html">MCMC Settings</a></li>
    <li><a class="dropdown-item" href="../articles/MinimalExample.html">Minimal Example</a></li>
    <li><a class="dropdown-item" href="../articles/ModelSpecification.html">Model Specification</a></li>
    <li><a class="dropdown-item" href="../articles/SelectingParameters.html">Parameter Selection</a></li>
    <li><a class="dropdown-item" href="../articles/TheoreticalBackground.html">Theoretical Background</a></li>
    <li><a class="dropdown-item" href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nerler/JointAI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Visualizing Incomplete Data</h1>
            
            <h4 data-toc-skip class="date">2020-06-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/master/vignettes/VisualizingIncompleteData.Rmd" class="external-link"><code>vignettes/VisualizingIncompleteData.Rmd</code></a></small>
      <div class="d-none name"><code>VisualizingIncompleteData.Rmd</code></div>
    </div>

    
    
<p>When analysing data with missing values it is important to be
familiar with the variables of interest, i.e., to know their measurement
level and distribution, as well as the amount of missing values per
variable, and to investigate the pattern of missing values.</p>
<p>Currently, the package <strong>JointAI</strong> has two functions to
help the exploration of incomplete data.</p>
<p>In this vignette, we use the <code>NHANES</code> data and the
<code>simLong</code> data, that are part of the <strong>JointAI</strong>
package. For more info on these datasets, check the help files <a href="https://nerler.github.io/JointAI/reference/NHANES.html">for the
<code>NHANES</code></a> and <a href="https://nerler.github.io/JointAI/reference/simLong.html">for the
<code>simLong</code></a> data or go to the <a href="https://www.cdc.gov/nchs/nhanes/index.htm" class="external-link">web page of the
National Health and Nutrition Examination Survey (NHANES)</a>.</p>
<div class="section level2">
<h2 id="visualize-the-distribution-of-each-variable">Visualize the distribution of each variable<a class="anchor" aria-label="anchor" href="#visualize-the-distribution-of-each-variable"></a>
</h2>
<p>Using <code><a href="../reference/plot_all.html">plot_all()</a></code>, an array of histograms (for continuous
variables and dates) and bar plots (for categorical variables) can be
obtained.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">3</span>, <span class="fl">2.5</span>, <span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.8</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_all.html">plot_all</a></span><span class="op">(</span><span class="va">NHANES</span><span class="op">)</span></span></code></pre></div>
<p><img src="VisualizingIncompleteData_files/figure-html/unnamed-chunk-1-1.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> Here, we are looking at the marginal
distribution of each variable. Since missing values are (usually)
imputed conditionally on other variables, marginal plots can only be
used as an indication of what type of imputation model (e.g., normal vs
non-normal) is appropriate.</p>
<div class="section level3">
<h3 id="plot-titles-proportion-of-missing-values">Plot titles: proportion of missing values<a class="anchor" aria-label="anchor" href="#plot-titles-proportion-of-missing-values"></a>
</h3>
<p>The argument <code>allNA</code> allows to select whether the
proportion of missing values is given only for incomplete variables or,
by setting <code>allNA = TRUE</code>, for all variables.</p>
</div>
<div class="section level3">
<h3 id="changing-colors">Changing colors<a class="anchor" aria-label="anchor" href="#changing-colors"></a>
</h3>
<p>The colour of the bars and their border can be controlled with the
arguments <code>fill</code> and <code>border</code>.</p>
</div>
<div class="section level3">
<h3 id="layout">Layout<a class="anchor" aria-label="anchor" href="#layout"></a>
</h3>
<p>The number of rows and columns of the plot layout is determined
automatically depending on the number of variables in the data but can
be overwritten using <code>nrow</code> and/or <code>ncol</code>.</p>
</div>
<div class="section level3">
<h3 id="additional-arguments">Additional arguments<a class="anchor" aria-label="anchor" href="#additional-arguments"></a>
</h3>
<p>It is also possible to provide some of the other arguments of <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/hist.html" class="external-link"><code>hist()</code></a>
or <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html" class="external-link"><code>barplot()</code></a>.</p>
<p>For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">3</span>, <span class="fl">2.5</span>, <span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.8</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_all.html">plot_all</a></span><span class="op">(</span><span class="va">NHANES</span>, allNA <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">'#e30f41'</span>, border <span class="op">=</span> <span class="st">'#34111b'</span>, ncol <span class="op">=</span> <span class="fl">3</span>, breaks <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="VisualizingIncompleteData_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="multi-level-data">Multi-level data<a class="anchor" aria-label="anchor" href="#multi-level-data"></a>
</h3>
<p>When the data has a multi-level structure, e.g., subjects are nested
within hospitals, or subjects have been measured repeatedly as in the
<code>simLong</code> data, the level of each variable can be taken into
account by specifying the names of the grouping variables (“id”
variables) via the argument <code>idvars</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">3</span>, <span class="fl">2.5</span>, <span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.8</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_all.html">plot_all</a></span><span class="op">(</span><span class="va">simLong</span>, allNA <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">'#e30f41'</span>, border <span class="op">=</span> <span class="st">'#34111b'</span>,</span>
<span>         ncol <span class="op">=</span> <span class="fl">3</span>, breaks <span class="op">=</span> <span class="fl">30</span>, idvars <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span></code></pre></div>
<p><img src="VisualizingIncompleteData_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;">
The information to which level a variable belongs is added to the title
of each plot (“lvlone” refers to the first level, for which there is no
grouping variable). Variables belonging to higher levels (e.g.,
center-specific variables in a multi-center setting, or patient-specific
variables in a setting with repeated measurements for each patient) are
summarized on their respective level, i.e., the counts of
<code>ETHN</code>, for instance, will sum up to the number of subjects
in the <code>simLong</code> data.</p>
</div>
</div>
<div class="section level2">
<h2 id="missing-data-pattern">Missing Data Pattern<a class="anchor" aria-label="anchor" href="#missing-data-pattern"></a>
</h2>
<p>The pattern of the missing data can be visualized with the function
<code><a href="../reference/md_pattern.html">md_pattern()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/md_pattern.html">md_pattern</a></span><span class="op">(</span><span class="va">NHANES</span><span class="op">)</span></span></code></pre></div>
<p><img src="VisualizingIncompleteData_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>In the resulting plot, variables are given in the columns and each
row corresponds to one pattern of missingness across the variables. The
numbers on the right margin give the number of cases per pattern.
Underneath the plot, the number of missing values per variable is given.
Columns are automatically sorted by number of missing values, rows by
number of cases per pattern.</p>
<p>The plot is generated with the help of <a href="https://ggplot2.tidyverse.org/" class="external-link"><code>ggplot()</code></a>, and,
hence, the package <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><strong>ggplot2</strong></a>
needs to be installed. By setting <code>plot = FALSE</code>, no plot
will be generated (and then <strong>ggplot2</strong> is not
required).</p>
<div class="section level4">
<h4 id="missing-data-pattern-as-a-matrix">Missing data pattern as a matrix<a class="anchor" aria-label="anchor" href="#missing-data-pattern-as-a-matrix"></a>
</h4>
<p>When the argument <code>pattern = TRUE</code> is set, the missing
data pattern is returned as a matrix, where observed values are
represented by <code>1</code> and missing values by <code>0</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/md_pattern.html">md_pattern</a></span><span class="op">(</span><span class="va">NHANES</span>, pattern <span class="op">=</span> <span class="cn">T</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt;      SBP gender age race educ WC smoke creat albu uricacid bili occup alc Npat</span></span>
<span><span class="co">#&gt; 1      1      1   1    1    1  1     1     1    1        1    1     1   1  116</span></span>
<span><span class="co">#&gt; 2      1      1   1    1    1  1     1     1    1        1    1     1   0   29</span></span>
<span><span class="co">#&gt; 3      1      1   1    1    1  1     1     1    1        1    1     0   1   24</span></span>
<span><span class="co">#&gt; 4      1      1   1    1    1  1     0     1    1        1    1     1   1    5</span></span>
<span><span class="co">#&gt; 5      1      1   1    1    1  1     1     0    0        0    0     1   1    4</span></span>
<span><span class="co">#&gt; 6      1      1   1    1    1  1     1     0    0        0    0     0   0    2</span></span>
<span><span class="co">#&gt; 7      1      1   1    1    1  1     0     1    1        1    1     0   1    1</span></span>
<span><span class="co">#&gt; 8      1      1   1    1    1  0     1     1    1        1    1     1   0    1</span></span>
<span><span class="co">#&gt; 9      1      1   1    1    1  1     1     1    1        1    1     0   0    1</span></span>
<span><span class="co">#&gt; 10     1      1   1    1    1  1     1     0    0        0    0     1   0    1</span></span>
<span><span class="co">#&gt; 11     1      1   1    1    1  0     1     1    1        1    1     1   1    1</span></span>
<span><span class="co">#&gt; 12     1      1   1    1    1  1     0     0    0        0    0     1   1    1</span></span>
<span><span class="co">#&gt; Nmis   0      0   0    0    0  2     7     8    8        8    8    28  34  103</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-colors-1">Changing colors<a class="anchor" aria-label="anchor" href="#changing-colors-1"></a>
</h3>
<p>The arguments <code>color</code> and <code>border</code> can be used
to change the colour that is used for observed and missing values (in
that order, i.e., <code>color</code> is a vector of length two), and the
border separating the rectangles, respectively.</p>
</div>
<div class="section level3">
<h3 id="legend-position">Legend position<a class="anchor" aria-label="anchor" href="#legend-position"></a>
</h3>
<p>The position of the legend can be controlled with the argument
<code>legend.position</code>, which can be one of <code>"left"</code>,
<code>"right"</code>, <code>"bottom"</code> or <code>"top"</code>. When
<code>legend.position = 'none'</code>, no legend is printed.</p>
</div>
<div class="section level3">
<h3 id="changing-the-axes">Changing the axes<a class="anchor" aria-label="anchor" href="#changing-the-axes"></a>
</h3>
<p>To hide the x-axis, the argument <code>print_xaxis</code> can be set
to <code>FALSE</code>. With the corresponding argument
<code>print_yaxis = FALSE</code> the y-axis can be omitted.</p>
<p>To change the title of the y-axis, you can change the argument
<code>ylab</code>. Setting <code>ylab = ''</code> will hide the axis
title, but keep the number of observations per missing data pattern.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/md_pattern.html">md_pattern</a></span><span class="op">(</span><span class="va">NHANES</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#34111b'</span>, <span class="st">'#e30f41'</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">'white'</span>,</span>
<span>           legend.position <span class="op">=</span> <span class="st">'none'</span>, print_xaxis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           ylab <span class="op">=</span> <span class="st">'Alternative axis title'</span><span class="op">)</span></span></code></pre></div>
<p><img src="VisualizingIncompleteData_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<p><br></p>
<p>For the <code>simLong</code> data, the missing data pattern is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/md_pattern.html">md_pattern</a></span><span class="op">(</span><span class="va">simLong</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#34111b'</span>, <span class="st">'#e30f41'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="VisualizingIncompleteData_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

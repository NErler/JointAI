<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Specification • JointAI</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Model Specification">
<meta property="og:description" content="">
<meta property="og:image" content="https://nerler.github.io/JointAI/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-127879026-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-127879026-4');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JointAI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AfterFitting.html">After Fitting</a>
    </li>
    <li>
      <a href="../articles/MCMCsettings.html">MCMC Settings</a>
    </li>
    <li>
      <a href="../articles/MinimalExample.html">Minimal Example</a>
    </li>
    <li>
      <a href="../articles/ModelSpecification.html">Model Specification</a>
    </li>
    <li>
      <a href="../articles/SelectingParameters.html">Parameter Selection</a>
    </li>
    <li>
      <a href="../articles/TheoreticalBackground.html">Theoretical Background</a>
    </li>
    <li>
      <a href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nerler/JointAI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/N_Erler">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Model Specification</h1>
            
            <h4 class="date">2019-08-29</h4>
      
      
      <div class="hidden name"><code>ModelSpecification.Rmd</code></div>

    </div>

    
    
<p>In this vignette we use the <a href="https://nerler.github.io/JointAI/reference/NHANES.html">NHANES</a> data for examples in cross-sectional data and the dataset <a href="https://nerler.github.io/JointAI/reference/simLong.html">simLong</a> for examples in longitudinal data. For more info on these datasets, check out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html"><em>Visualizing Incomplete Data</em></a>, in which the distributions of variables and missing values in both sets is explored.</p>
<p>To learn more about the theoretical background of the statistical approach that is implemented in <strong>JointAI</strong>, check out the vignette <a href="https://nerler.github.io/JointAI/articles/TheoreticalBackground.html">Theoretical Background</a>.</p>
<p><strong>Note:</strong><br> In some of the examples we use <code>n.adapt = 0</code> (and <code>n.iter = 0</code>, which is the default). This is in order to prevent the MCMC sampling and thereby reduce computational time when compiling this vignette.</p>
<div id="analysis-model-type" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-model-type" class="anchor"></a>Analysis model type</h2>
<p><strong>JointAI</strong> has several main functions (which we abbreviate in the following with <code>*_imp()</code>):</p>
<ul>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">lm_imp()</a></code></a>: linear regression</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">glm_imp()</a></code></a>: generalized linear regression</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">clm_imp()</a></code></a>: cumulative logit models</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">lme_imp()</a></code></a>: linear mixed effects regression</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">glme_imp()</a></code></a>: generalized linear mixed effects regression</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">clmm_imp()</a></code></a>: cumulative logit mixed models</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">survreg_imp()</a></code></a>: parametric (Weibull) survival models</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">coxph_imp()</a></code></a>: Cox proportional hazards survival models</li>
</ul>
<p>Specification of these functions is similar to the specification of the complete data versions <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html"><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/glm.html"><code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/lme.html"><code>lme()</code></a> (from package <a href="https://CRAN.R-project.org/package=nlme"><strong>nlme</strong></a>) and <code>clm()</code> and <code>clmm2()</code> (from package <a href="https://CRAN.R-project.org/package=ordinal"><strong>ordinal</strong></a>), <a href="https://stat.ethz.ch/R-manual/R-devel/library/survival/html/survreg.html"><code>survreg()</code></a> and <a href="https://stat.ethz.ch/R-manual/R-devel/library/survival/html/coxph.html"><code>coxph()</code></a> (from package <a href="https://CRAN.R-project.org/package=survival"><strong>survival</strong></a>). <code><a href="../reference/model_imp.html">glme_imp()</a></code> uses a combination of the specification used for <code>lme()</code> and <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>.</p>
<p><code><a href="../reference/model_imp.html">lm_imp()</a></code>, <code><a href="../reference/model_imp.html">glm_imp()</a></code>, <code><a href="../reference/model_imp.html">clm_imp()</a></code>, <code><a href="../reference/model_imp.html">survreg_imp()</a></code> and <code><a href="../reference/model_imp.html">coxph_imp()</a></code> take arguments <code>formula</code> and <code>data</code>, whereas <code><a href="../reference/model_imp.html">lme_imp()</a></code> and <code><a href="../reference/model_imp.html">glme_imp()</a></code>, <code><a href="../reference/model_imp.html">clmm_imp()</a></code> require the specification of a <code>fixed</code> effects and a <code>random</code> effects formula. Specification of the fixed effects formula is demonstrated in section <a href="#ModelFormula">Model formula</a>, specification of the random effects in section <a href="#MultiLevelStructure">Multi-level structure &amp; longitudinal covariates</a>.</p>
<p>Additionally, <code><a href="../reference/model_imp.html">glm_imp()</a></code> and <code><a href="../reference/model_imp.html">glme_imp()</a></code> require the specification of the model <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/family.html"><code>family</code></a> (and <code>link</code> function).</p>
<div id="model-family-and-link-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#model-family-and-link-functions" class="anchor"></a>Model family and link functions</h3>
<p>Implemented families and links for <code><a href="../reference/model_imp.html">glm_imp()</a></code> and <code><a href="../reference/model_imp.html">glme_imp()</a></code> are</p>
<table class="table">
<thead><tr class="header">
<th align="left">family</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>gaussian</code></td>
<td>with links: <code>identity</code>, <code>log</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>binomial</code></td>
<td>with links: <code>logit</code>, <code>probit</code>, <code>log</code>, <code>cloglog</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>Gamma</code></td>
<td>with links: <code>inverse</code>, <code>identity</code>, <code>log</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>poisson</code></td>
<td>with links: <code>log</code>, <code>identity</code>
</td>
</tr>
</tbody>
</table>
<p>The argument <code>family</code> can be given as character string or as a function. If the link function is omitted, the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/family.html">default link</a> is used.</p>
<p><strong>Example:</strong><br> The following three specifications are equal:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>mod1a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</span>
<span id="cb1-2"><a href="#cb1-2"></a>               <span class="dt">family =</span> <span class="st">"binomial"</span>, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>mod1b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</span>
<span id="cb1-5"><a href="#cb1-5"></a>               <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>mod1c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</span>
<span id="cb1-8"><a href="#cb1-8"></a>               <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">'logit'</span>), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a>mod1a<span class="op">$</span>analysis_type</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; [1] "glm"</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; attr(,"family")</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; [1] "binomial"</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; attr(,"link")</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; [1] "logit"</span></span></code></pre></div>
<p>To use a probit link instead, this needs to be specified explicitly:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>mod1d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</span>
<span id="cb2-2"><a href="#cb2-2"></a>               <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">'probit'</span>), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>mod1d<span class="op">$</span>analysis_type</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; [1] "glm"</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; attr(,"family")</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; [1] "binomial"</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; attr(,"link")</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; [1] "probit"</span></span></code></pre></div>
</div>
</div>
<div id="ModelFormula" class="section level2">
<h2 class="hasAnchor">
<a href="#ModelFormula" class="anchor"></a>Model formula</h2>
<p>The arguments <code>formula</code> (in <code><a href="../reference/model_imp.html">lm_imp()</a></code>, <code><a href="../reference/model_imp.html">glm_imp()</a></code>, <code><a href="../reference/model_imp.html">clm_imp()</a></code>, <code><a href="../reference/model_imp.html">survreg_imp()</a></code> and <code><a href="../reference/model_imp.html">coxph_imp()</a></code>) and <code>fixed</code> (in <code><a href="../reference/model_imp.html">lme_imp()</a></code>, <code><a href="../reference/model_imp.html">glme_imp()</a></code> and <code><a href="../reference/model_imp.html">clmm_imp()</a></code>) take a two-sided <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html"><code>formula</code></a> object, where <code>~</code> separates the response (outcome / dependent variable) from the linear predictor, in which covariates (independent variables) are separated by <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>. An intercept is added automatically (except in Cox models or models for ordinal outcomes).</p>
<p><code><a href="../reference/model_imp.html">survreg_imp()</a></code> and <code><a href="../reference/model_imp.html">coxph_imp()</a></code> expect a <a href="https://stat.ethz.ch/R-manual/R-devel/library/survival/html/Surv.html">survival object (<code>Surv()</code>)</a> on the left hand side of the model formula. Currently, only right censored data can be handled.</p>
<div id="interactions" class="section level3">
<h3 class="hasAnchor">
<a href="#interactions" class="anchor"></a>Interactions</h3>
<p>Interactions between variables can be introduced using <code>:</code> or <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code>, which adds the interaction term AND the main effects, i.e.,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>smoke <span class="op">*</span><span class="st"> </span>creat</span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat <span class="op">+</span><span class="st"> </span>smoke<span class="op">:</span>creat</span></code></pre></div>
<div id="interaction-with-multiple-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#interaction-with-multiple-variables" class="anchor"></a>Interaction with multiple variables</h4>
<p>Interactions between multiple variables can be specified using parentheses:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mod2a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>gender <span class="op">*</span><span class="st"> </span>(age <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat),</span>
<span id="cb5-2"><a href="#cb5-2"></a>                 <span class="dt">data =</span> NHANES, <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(mod2a)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;  [1] "(Intercept)"               "genderfemale"              "age"                      </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;  [4] "smokeformer"               "smokecurrent"              "creat"                    </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;  [7] "genderfemale:age"          "genderfemale:smokeformer"  "genderfemale:smokecurrent"</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; [10] "genderfemale:creat"</span></span></code></pre></div>
<p>The function <a href="https://nerler.github.io/JointAI/reference/parameters.html"><code><a href="../reference/parameters.html">parameters()</a></code></a> returns the parameters that are specified to be followed (even for models where no MCMC sampling was performed, i.e., when <code>n.iter = 0</code> and <code>n.adapt = 0</code>).</p>
</div>
<div id="higher-level-interactions" class="section level4">
<h4 class="hasAnchor">
<a href="#higher-level-interactions" class="anchor"></a>Higher level interactions</h4>
<p>To specify interactions of a given level, <code><a href="https://rdrr.io/r/base/Arithmetic.html">^</a></code> can be used:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># all two-way interactions:</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>mod2b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>(age <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat)<span class="op">^</span><span class="dv">2</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>                 <span class="dt">data =</span> NHANES, <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(mod2b)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt;  [1] "(Intercept)"        "genderfemale"       "age"                "smokeformer"       </span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;  [5] "smokecurrent"       "creat"              "age:smokeformer"    "age:smokecurrent"  </span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt;  [9] "age:creat"          "smokeformer:creat"  "smokecurrent:creat"</span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co"># all two- and three-way interactions:</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>mod2c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>(age <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat)<span class="op">^</span><span class="dv">3</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>                 <span class="dt">data =</span> NHANES, <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(mod2c)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt;  [1] "(Intercept)"            "genderfemale"           "age"                   </span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt;  [4] "smokeformer"            "smokecurrent"           "creat"                 </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt;  [7] "age:smokeformer"        "age:smokecurrent"       "age:creat"             </span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; [10] "smokeformer:creat"      "smokecurrent:creat"     "age:smokeformer:creat" </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; [13] "age:smokecurrent:creat"</span></span></code></pre></div>
<p>In <strong>JointAI</strong>, interactions between any type of variables (observed, incomplete, time-varying) are allowed. When an incomplete variable is involved, the interaction term is re-calculated within each iteration of the MCMC sampling, using the imputed values from the current iteration.</p>
<p>It is <strong>important</strong> not to pre-calculate interactions with incomplete variables as extra variables in the dataset, but to specify them in the model formula. Otherwise imputed values of the main effect and interaction term will not match and results may be incorrect.</p>
</div>
</div>
<div id="non-linear-functional-forms" class="section level3">
<h3 class="hasAnchor">
<a href="#non-linear-functional-forms" class="anchor"></a>Non-linear functional forms</h3>
<p>In practice, associations between outcome and covariates do not always meet the standard assumption that all covariate effects are linear. Often, assuming a logarithmic, quadratic or other non-linear effect is more appropriate.</p>
<p>Non-linear associations can be specified in the model formula using either functions such as <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Log.html"><code><a href="https://rdrr.io/r/base/Log.html">log()</a></code></a> (the natural logarithm), <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/MathFun.html"><code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code></a> (the square root) or <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Log.html"><code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code></a> (the exponential function), or by specifying a function of a variable using <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/AsIs.html"><code><a href="https://rdrr.io/r/base/AsIs.html">I()</a></code></a>, for example, <code><a href="https://rdrr.io/r/base/AsIs.html">I(x^2)</a></code> would be the quadratic term of a variable <code>x</code>.</p>
<p>For <em>completely observed covariates</em>, <strong>JointAI</strong> can handle any common type of function implemented in R, including splines, e.g., using <a href="https://stat.ethz.ch/R-manual/R-devel/library/splines/html/ns.html"><code>ns()</code></a> or <a href="https://stat.ethz.ch/R-manual/R-devel/library/splines/html/bs.html"><code>bs()</code></a> from the package <strong>splines</strong> (which is automatically installed with R).</p>
<p>Since functions involving <em>variables that have missing values</em> need to be re-calculated in each iteration of the MCMC sampling, currently, only functions that are available in <a href="http://mcmc-jags.sourceforge.net">JAGS</a> can be used for incomplete variables. Those functions include:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code>
</li>
<li>
<code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code>, polynomials (using <code><a href="https://rdrr.io/r/base/AsIs.html">I()</a></code>)</li>
<li><code><a href="https://rdrr.io/r/base/MathFun.html">abs()</a></code></li>
<li>
<code><a href="https://rdrr.io/r/base/Trig.html">sin()</a></code>, <code><a href="https://rdrr.io/r/base/Trig.html">cos()</a></code>
</li>
<li>algebraic operations involving one or multiple (in)complete variables, as long as the formula can be interpreted by <a href="http://mcmc-jags.sourceforge.net">JAGS</a>.</li>
</ul>
<p>The list of functions implemented in JAGS can be found in the <a href="https://sourceforge.net/projects/mcmc-jags/files/Manuals/">JAGS user manual</a>.</p>
<p><strong>Some examples:</strong><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Absolute difference between bili and creat</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>mod3a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(bili <span class="op">-</span><span class="st"> </span>creat), <span class="dt">data =</span> NHANES)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Using a natural cubic spline for age (completely observed) and a quadratic</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># and a cubic effect for bili</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(splines)</span>
<span id="cb7-7"><a href="#cb7-7"></a>mod3b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(bili<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(bili<span class="op">^</span><span class="dv">3</span>), <span class="dt">data =</span> NHANES)</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co"># A function of creat and albu</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>mod3c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(creat<span class="op">/</span>albu<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> NHANES,</span>
<span id="cb7-11"><a href="#cb7-11"></a>                <span class="dt">models =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">creat =</span> <span class="st">'lognorm'</span>, <span class="dt">albu =</span> <span class="st">'lognorm'</span>))</span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co"># This function may make more sense to calculate BMI as weight/height^2, but</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># we currently do not have those variables in the NHANES dataset.</span></span>
<span id="cb7-14"><a href="#cb7-14"></a></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co"># Using the sinus and cosinus</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>mod3d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(creat) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span>(albu), <span class="dt">data =</span> NHANES)</span></code></pre></div>
<div id="what-happens-inside-jointai" class="section level4">
<h4 class="hasAnchor">
<a href="#what-happens-inside-jointai" class="anchor"></a>What happens inside <strong>JointAI</strong>?</h4>
<p>When a function of a complete or incomplete variable is used in the model formula, the main effect of that variable is automatically added as auxiliary variable (more on auxiliary variables in section <a href="#auxvars">Auxiliary variables</a>), and (usually) only main effects are used as predictors in models for incomplete variables.</p>
<p>In <code>mod3b</code>, for example, the spline of age is used as predictor for <code>SBP</code>, but in the imputation model for <code>bili</code>, <code>age</code> enters with a linear effect.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod3b, <span class="dt">priors =</span> <span class="ot">FALSE</span>, <span class="dt">regcoef =</span> <span class="ot">FALSE</span>, <span class="dt">otherpars =</span> <span class="ot">FALSE</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; Linear regression model for "bili"</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;   (Intercept), genderfemale, age</span></span></code></pre></div>
<p>The function <a href="https://nerler.github.io/JointAI/reference/list_models.html"><code><a href="../reference/list_models.html">list_models()</a></code></a> prints a list of the models specified for covariates in a <code>JointAI</code> object. Since, here, we are only interested in the predictor variables, we suppress printing of information on prior distributions, regression coefficients and other parameters by setting <code>priors</code>, <code>regcoef</code> and <code>otherpars</code> to <code>FALSE</code>.</p>
<p><br></p>
<p>When a function of a variable is specified as an auxiliary variable, this function is used (as well) in the models for covariates. For example, in <code>mod3e</code>, waist circumference (<code>WC</code>) is not part of the model for <code>SBP</code>, and <code><a href="https://rdrr.io/r/base/AsIs.html">I(WC^2)</a></code> is used in the linear predictor of the imputation model for <code>bili</code>: <a id="mod3e"></a></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>mod3e &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>bili, <span class="dt">auxvars =</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(WC<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> NHANES)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod3e, <span class="dt">priors =</span> F, <span class="dt">regcoef =</span> F, <span class="dt">otherpars =</span> F)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; Linear regression model for "WC"</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt;   (Intercept), age, genderfemale</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; Linear regression model for "bili"</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;   (Intercept), age, genderfemale, I(WC^2)</span></span></code></pre></div>
<p>When <code>WC</code> is used as predictor variable in the main model and a function of <code>WC</code> is specified as auxiliary variable, both variables are used as predictors in the imputation models:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>mod3f &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span>WC, <span class="dt">auxvars =</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(WC<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> NHANES)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod3f, <span class="dt">priors =</span> F, <span class="dt">regcoef =</span> F, <span class="dt">otherpars =</span> F)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; Linear regression model for "WC"</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;   (Intercept), age, genderfemale</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; Linear regression model for "bili"</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt;   (Intercept), age, genderfemale, WC, I(WC^2)</span></span></code></pre></div>
<p>When a function of a covariate is used in the linear predictor of the analysis model, and that function should also be used in the linear predictor of imputation models, it is necessary to also include that function in the argument <code>auxvars</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>mod3g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(WC<span class="op">^</span><span class="dv">2</span>), <span class="dt">auxvars =</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(WC<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> NHANES)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod3g, <span class="dt">priors =</span> F, <span class="dt">regcoef =</span> F, <span class="dt">otherpars =</span> F)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; Linear regression model for "WC"</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt;   (Intercept), age, genderfemale</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; </span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; Linear regression model for "bili"</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;   (Intercept), age, genderfemale, I(WC^2)</span></span></code></pre></div>
<p>Incomplete variables are always imputed on their original scale, i.e.,</p>
<ul>
<li>in <code>mod3b</code> the variable <code>bili</code> is imputed and the quadratic and cubic versions calculated from the imputed values.</li>
<li>Likewise, <code>creat</code> and <code>albu</code> in <code>mod3c</code> are imputed separately, and <code><a href="https://rdrr.io/r/base/AsIs.html">I(creat/albu^2)</a></code> calculated from the imputed (and observed) values.</li>
</ul>
<p><strong>Important:</strong>: <br> When different transformations of the same incomplete variable are used in one model, or interaction terms involve the main and interaction effect of an incomplete variable, it is strongly discouraged to calculate these transformations or interaction terms beforehand and supply them as different variables.<br> If, for example, a model formula contains both <code>x</code> and <code>x2</code> (where <code>x2</code> = <code>x^2</code>), they are treated as separate variables and imputed with separate models. Imputed values of <code>x2</code> are thus not equal to the square of imputed values of <code>x</code>. Instead, <code>x + I(x^2)</code> should be used in the model formula. Then, only <code>x</code> is imputed and used in the linear predictor of models for other incomplete variables, and <code>x^2</code> is calculated from the imputed values of <code>x</code>.</p>
</div>
<div id="functions-with-restricted-support" class="section level4">
<h4 class="hasAnchor">
<a href="#functions-with-restricted-support" class="anchor"></a>Functions with restricted support</h4>
<p>When a function has restricted support, e.g., <code><a href="https://rdrr.io/r/base/Log.html">log(x)</a></code> is only defined for <code>x &gt; 0</code>, the distribution used to impute that variable needs to comply with these restrictions. This can either be achieved by truncating the distribution, using the argument <code>trunc</code>, or by selecting an imputation method that meets the restrictions. For more information on imputation methods, see the section <a href="#meth">Imputation model types</a>.</p>
<p><strong>Example</strong>:<br> When using a <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code> transformation for the covariate <code>bili</code>, we can either use the default imputation method <code>"norm"</code> (a normal distribution) and truncate it by specifying <code>trunc = list(bili = c(&lt;lower&gt;, &lt;upper&gt;))</code> (where the lower and upper limits are the smallest and largest allowed values) or choose an imputation method (using the argument <code>models</code>; more details see the section on <a href="#meth">imputation model types</a>) that only imputes positive values such as a log-normal distribution (<code>"lognorm"</code>) or a Gamma distribution (<code>"gamma"</code>): <a id="mod4"></a></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># truncation of the distribution of  bili</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>mod4a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(bili) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(creat),</span>
<span id="cb12-3"><a href="#cb12-3"></a>                <span class="dt">trunc =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">bili =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-5</span>, <span class="fl">1e10</span>)), <span class="dt">data =</span> NHANES)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># log-normal model for bili</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>mod4b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(bili) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(creat),</span>
<span id="cb12-7"><a href="#cb12-7"></a>                <span class="dt">models =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">bili =</span> <span class="st">'lognorm'</span>, <span class="dt">creat =</span> <span class="st">'norm'</span>), <span class="dt">data =</span> NHANES)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># gamma model for bili</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>mod4c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(bili) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(creat),</span>
<span id="cb12-11"><a href="#cb12-11"></a>                <span class="dt">models =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">bili =</span> <span class="st">'gamma'</span>, <span class="dt">creat =</span> <span class="st">'norm'</span>), <span class="dt">data =</span> NHANES)</span></code></pre></div>
<p>Truncation always requires to specify both limits. Since <code>-Inf</code> and <code>Inf</code> are not accepted, a value outside the range of the variable (here: 1e10) can be selected for the second boundary of the truncation interval.</p>
</div>
<div id="functions-that-are-not-available-in-r" class="section level4">
<h4 class="hasAnchor">
<a href="#functions-that-are-not-available-in-r" class="anchor"></a>Functions that are not available in R</h4>
<p>It is possible to use functions that have different names in R and JAGS, or that do exist in JAGS, but not in R, by defining a new function in R that has the name of the function in JAGS.</p>
<p><strong>Example</strong>:<br> In JAGS the inverse logit transformation is defined in the function <code>ilogit</code>. In R, there is no function <code>ilogit</code>, but the inverse logit is available as the distribution function of the logistic distribution <code><a href="https://rdrr.io/r/stats/Logistic.html">plogis()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Define the function ilogit</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>ilogit &lt;-<span class="st"> </span>plogis</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># Use ilogit in the model formula</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>mod5a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">ilogit</span>(creat), <span class="dt">data =</span> NHANES)</span></code></pre></div>
</div>
<div id="nested-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#nested-functions" class="anchor"></a>Nested functions</h4>
<p>It is also possible to nest a function in another function.</p>
<p><strong>Example:</strong><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>The complementary log log transformation is restricted to values larger than 0 and smaller than 1. In order to use this function on a variable that exceeds this range, as is the case for <code>creat</code>, a second transformation might be used, for instance the inverse logit from the previous example.</p>
<p>In JAGS, the complementary log-log transformation is implemented as <code>cloglog</code>, but since this function does not exist in (base) R, we first need to define it:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># define the complementary log log transformation</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>cloglog &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x))</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># define the inverse logit (in case you have not done it in the previous example)</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>ilogit &lt;-<span class="st"> </span>plogis</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># nest ilogit inside cloglog</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>mod6a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">cloglog</span>(<span class="kw">ilogit</span>(creat)), <span class="dt">data =</span> NHANES)</span></code></pre></div>
</div>
</div>
</div>
<div id="MultiLevelStructure" class="section level2">
<h2 class="hasAnchor">
<a href="#MultiLevelStructure" class="anchor"></a>Multi-level structure &amp; longitudinal covariates</h2>
<p>In multi-level models, additional to the fixed effects structure specified by the argument <code>fixed</code> a random effects structure needs to be provided via the argument <code>random</code>.</p>
<div id="random-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#random-effects" class="anchor"></a>Random effects</h3>
<p><code>random</code> takes a one-sided formula starting with a <code>~</code>. Variables for which a random effect should be included are usually separated by a <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>, and the grouping variable is separated by <code><a href="https://rdrr.io/r/base/Logic.html">|</a></code>. A random intercept is added automatically and only needs to be specified in a random intercept only model.</p>
<p>A few examples:</p>
<ul>
<li>
<code>random = ~ 1 | id</code>: random intercept only, with <code>id</code> as grouping variable</li>
<li>
<code>random = ~ time | id</code>: random intercept and slope for variable <code>time</code>
</li>
<li>
<code>random = ~ time + I(time^2) | id</code>: random intercept, slope and quadratic random effect for <code>time</code>
</li>
<li>
<code>random = ~ time + x | id</code> random intercept, random slope for <code>time</code> and random effect for variable <code>x</code>
</li>
</ul>
<p>It is possible to use splines in the random effects structure (but only for completely observed variables), e.g.:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>mod7a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>GESTBIR <span class="op">+</span><span class="st"> </span>ETHN <span class="op">+</span><span class="st"> </span>HEIGHT_M <span class="op">+</span><span class="st"> </span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>),</span>
<span id="cb15-2"><a href="#cb15-2"></a>                 <span class="dt">random =</span> <span class="op">~</span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>ID, <span class="dt">data =</span> simLong)</span></code></pre></div>
<p>Currently, multiple levels of nesting (nested or crossed random effects) are not yet available.</p>
</div>
<div id="longitudinal-covariates" class="section level3">
<h3 class="hasAnchor">
<a href="#longitudinal-covariates" class="anchor"></a>Longitudinal covariates</h3>
<p>From <strong>JointAI</strong> version 0.5.0 onward imputation of longitudinal covariates is possible. Currently, imputation of continuous, binary and ordered factors is implemented. For more details, see the section <a href="#meth">covariate model types</a> below.</p>
<p><strong>Note:</strong><br> When incomplete baseline covariates are involved in the model it is necessary to specify models for all longitudinal covariates, complete and incomplete. This is done automatically by <strong>JointAI</strong>, but it may be necessary to change the default model types to models that better fit the distributions of the respective longitudinal variables.</p>
<p>When no incomplete baseline covariates are involved, models only need to be specified for incomplete longitudinal covariates, but not for completely observed longitudinal covariates.</p>
<div id="why-do-we-need-models-for-completely-observed-longitudinal-covariates" class="section level4">
<h4 class="hasAnchor">
<a href="#why-do-we-need-models-for-completely-observed-longitudinal-covariates" class="anchor"></a>Why do we need models for completely observed longitudinal covariates?</h4>
<p>The joint distribution of an outcome <span class="math inline">\(y\)</span>, covariates <span class="math inline">\(x\)</span>, random effects <span class="math inline">\(b\)</span> and parameters <span class="math inline">\(\theta\)</span>, <span class="math inline">\(p(y, x, b, \theta)\)</span>, is modeled as the product of univariate conditional distributions. To facilitate the specification of these distributions they are ordered so that longitudinal (level-1) variables may have baseline (level-2) variables in their linear predictors but not vice versa.</p>
<p>For example: <span class="math display">\[\begin{align}
p(y, x, b, \theta) = &amp; p(y \mid x_1, ..., x_4, b_y, \theta_y) &amp;&amp; \text{analysis model}\\
&amp; p(x_1\mid \theta_{x1}) &amp;&amp; \text{model for a complete baseline covariate}\\
&amp; p(x_2\mid x_1, \theta_{x2}) &amp;&amp; \text{model for an incomplete baseline covariate}\\
&amp; p(x_3\mid x_1, x_2, b_{x3}, \theta_{x3}) &amp;&amp; \text{model for a complete longitudinal covariate}\\
&amp; p(x_4\mid x_1, x_2, x_3, b_{x4}, \theta_{x4}) &amp;&amp; \text{model for an incomplete longitudinal covariate}\\
&amp; p(b_y|\theta_b) p(b_{x3}|\theta_b) p(b_{x4}|\theta_b) &amp;&amp; \text{models for the random effects}\\
&amp; p(\theta_y) p(\theta_{x1}) \ldots p(\theta_{x4}) p(\theta_b) &amp;&amp; \text{prior distributions}\end{align}\]</span></p>
<p>Since the parameter vectors <span class="math inline">\(\theta_{x1}\)</span>, <span class="math inline">\(\theta_{x2}\)</span>, … are assumed to be a priori independent, and furthermore <span class="math inline">\(x_1\)</span> is completely observed and modeled independently of incomplete variables, estimation of the other model parts is not affected by <span class="math inline">\(p(x_1\mid \theta_{x1})\)</span> and, hence, this model can be omitted.</p>
<p><span class="math inline">\(p(x_3 \mid x_1, x_2, b_{x3}, \theta_{x3})\)</span>, on the other hand is modeled conditional on the incomplete covariate <span class="math inline">\(x_2\)</span> and can therefore not be omitted.</p>
<p>If there were no incomplete baseline covariates, i.e., if <span class="math inline">\(x_2\)</span> was completely observed, <span class="math inline">\(p(x_3 \mid x_1, x_2, b_{x3}, \theta_{x3})\)</span> would also not affect the estimation of parameters in the other parts of the model and could be omitted.</p>
</div>
</div>
</div>
<div id="meth" class="section level2">
<h2 class="hasAnchor">
<a href="#meth" class="anchor"></a>Covariate model types</h2>
<p><strong>JointAI</strong> automatically selects an imputation model for each of the incomplete baseline covariates (level-2 covariates) and for each of the (incomplete) longitudinal covariates (level-1 covariates), based on the <code>class</code> of the variable and the number of levels. The automatically selected types for baseline covariates are:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">model</th>
<th align="left">variable type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>norm</code></td>
<td align="left">linear regression</td>
<td align="left">continuous variables</td>
</tr>
<tr class="even">
<td align="left"><code>logit</code></td>
<td align="left">logistic regression</td>
<td align="left">factors with two levels</td>
</tr>
<tr class="odd">
<td align="left"><code>multilogit</code></td>
<td align="left">multinomial logit model</td>
<td align="left">unordered factors with &gt;2 levels</td>
</tr>
<tr class="even">
<td align="left"><code>cumlogit</code></td>
<td align="left">cumulative logit model</td>
<td align="left">ordered factors with &gt;2 levels</td>
</tr>
</tbody>
</table>
<p>The default methods for longitudinal covariates are:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">model</th>
<th align="left">variable type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>lmm</code></td>
<td align="left">linear mixed model</td>
<td align="left">continuous longitudinal variables</td>
</tr>
<tr class="even">
<td align="left"><code>glmm_logit</code></td>
<td align="left">logistic mixed model</td>
<td align="left">longitudinal factors with two levels</td>
</tr>
<tr class="odd">
<td align="left"><code>clmm</code></td>
<td align="left">cumulative logit mixed model</td>
<td align="left">longitudinal ordered factors with &gt;2 levels</td>
</tr>
</tbody>
</table>
<p>The imputation models that are chosen by default may not necessarily be appropriate for the data at hand, especially for continuous variables, which often do not comply with the assumptions of (conditional) normality.</p>
<p>Therefore, alternative imputation methods are available for continuous baseline covariates:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">model</th>
<th align="left">variable type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>lognorm</code></td>
<td align="left">normal regression of the log-transformed variable</td>
<td align="left">right-skewed variables &gt;0</td>
</tr>
<tr class="even">
<td align="left"><code>gamma</code></td>
<td align="left">Gamma regression (with log-link)</td>
<td align="left">right-skewed variables &gt;0</td>
</tr>
<tr class="odd">
<td align="left"><code>beta</code></td>
<td align="left">beta regression (with logit-link)</td>
<td align="left">continuous variables with values in [0, 1]</td>
</tr>
</tbody>
</table>
<p><code>lognorm</code> assumes a normal distribution for the natural logarithm of the variable, but the variable enters the linear predictor of the analysis model (and possibly other imputation models) on its original scale.</p>
<p>For longitudinal covariates the following alternative model types are available:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">model</th>
<th align="left">variable type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>glmm_lognorm</code></td>
<td align="left">normal mixed model for the log-transformed variable</td>
<td align="left">longitudinal right-skewed variables &gt;0</td>
</tr>
<tr class="even">
<td align="left"><code>glmm_gamma</code></td>
<td align="left">gamma mixed model (with log-link)</td>
<td align="left">longitudinal right-skewed variables &gt;0</td>
</tr>
<tr class="odd">
<td align="left"><code>glmm_poisson</code></td>
<td align="left">poisson mixed model (with log-link)</td>
<td align="left">longitudinal count variables</td>
</tr>
</tbody>
</table>
<div id="specification-of-covariate-model-types" class="section level3">
<h3 class="hasAnchor">
<a href="#specification-of-covariate-model-types" class="anchor"></a>Specification of covariate model types</h3>
<p>In models <a href="#mod4"><code>mod4b</code> and <code>mod4c</code></a> we have already seen two examples in which the imputation model type was changed using the argument <code>models</code>.</p>
<p><code>models</code> takes a named vector of (imputation/covariate) model types, where the names are the names of the (incomplete) baseline or longitudinal variables. When the vector supplied to <code>models</code> only contains specifications for a subset of those variables, default models are used for the remaining variables.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>mod8a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</span>
<span id="cb16-2"><a href="#cb16-2"></a>                <span class="dt">models =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">bili =</span> <span class="st">'gamma'</span>, <span class="dt">WC =</span> <span class="st">'lognorm'</span>),</span>
<span id="cb16-3"><a href="#cb16-3"></a>                <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a>mod8a<span class="op">$</span>models</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt;           WC        smoke         bili        occup          alc </span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt;    "lognorm"   "cumlogit"      "gamma" "multilogit"      "logit"</span></span></code></pre></div>
<p>The function <a href="https://nerler.github.io/JointAI/reference/get_models.html"><code><a href="../reference/get_models.html">get_models()</a></code></a>, which finds and assigns the default covariate model types, can also be called directly. <code><a href="../reference/get_models.html">get_models()</a></code> has arguments</p>
<ul>
<li>
<code>fixed</code>: the fixed effects formula</li>
<li>
<code>random</code>: the random effects formula (if necessary)</li>
<li>
<code>data</code>: the dataset</li>
<li>
<code>auxvars</code>: an optional one-sided formula of auxiliary variables</li>
<li>
<code>no_model</code>: an optional vector of variables for which no model should be specified</li>
<li>
<code>models</code>: and optional vector of (non-default) model types chosen by the user</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>mod8b_models &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_models.html">get_models</a></span>(bmi <span class="op">~</span><span class="st"> </span>GESTBIR <span class="op">+</span><span class="st"> </span>ETHN <span class="op">+</span><span class="st"> </span>HEIGHT_M <span class="op">+</span><span class="st"> </span>SMOKE <span class="op">+</span><span class="st"> </span>hc <span class="op">+</span><span class="st"> </span>MARITAL <span class="op">+</span><span class="st"> </span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>),</span>
<span id="cb17-2"><a href="#cb17-2"></a>                           <span class="dt">random =</span> <span class="op">~</span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>ID, <span class="dt">data =</span> simLong)</span>
<span id="cb17-3"><a href="#cb17-3"></a>mod8b_models</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; $models</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt;     HEIGHT_M         ETHN      MARITAL        SMOKE          age           hc </span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt;       "norm"      "logit" "multilogit"   "cumlogit"        "lmm"        "lmm" </span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#&gt; </span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt; $meth</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt;     HEIGHT_M         ETHN      MARITAL        SMOKE           hc </span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#&gt;       "norm"      "logit" "multilogit"   "cumlogit"        "lmm"</span></span></code></pre></div>
<p><code><a href="../reference/get_models.html">get_models()</a></code> returns a list of two vectors:</p>
<ul>
<li>
<code>models</code>: containing all specified models</li>
<li>
<code>meth</code>: containing the models for the incomplete variables only</li>
</ul>
<p>When there is a “time” variable in the model, such as <code>age</code> in our example, which is the age of the child at the time of the measurement, it may not be meaningful to specify a model for that variable. Especially when the “time” variable is pre-specified by the design of the study it can usually be assumed to be independent of the covariates and a model for it has no useful interpretation.</p>
<p>The argument <code>no_model</code> (in <code><a href="../reference/get_models.html">get_models()</a></code> as well as in the main functions <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>*_imp()</code></a>) allows us to exclude models for such variables (as long as they are completely observed):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>mod8c_models &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_models.html">get_models</a></span>(bmi <span class="op">~</span><span class="st"> </span>GESTBIR <span class="op">+</span><span class="st"> </span>ETHN <span class="op">+</span><span class="st"> </span>HEIGHT_M <span class="op">+</span><span class="st"> </span>SMOKE <span class="op">+</span><span class="st"> </span>hc <span class="op">+</span><span class="st"> </span>MARITAL <span class="op">+</span><span class="st"> </span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>),</span>
<span id="cb18-2"><a href="#cb18-2"></a>                           <span class="dt">random =</span> <span class="op">~</span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>) <span class="op">|</span><span class="st"> </span>ID, <span class="dt">data =</span> simLong, <span class="dt">no_model =</span> <span class="st">"age"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>mod8c_models</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; $models</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt;     HEIGHT_M         ETHN      MARITAL        SMOKE           hc </span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt;       "norm"      "logit" "multilogit"   "cumlogit"        "lmm" </span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt; </span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt; $meth</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt;     HEIGHT_M         ETHN      MARITAL        SMOKE           hc </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt;       "norm"      "logit" "multilogit"   "cumlogit"        "lmm"</span></span></code></pre></div>
<p>By excluding the model for <code>age</code> we implicitly assume that incomplete baseline variables are independent of <code>age</code>.</p>
<p><strong>Note:</strong><br> When a continuous incomplete variable has only two different values it is assumed to be binary and its coding and default imputation model will be changed accordingly. This behavior can be overwritten when the imputation method for that variable is specified directly by the user.</p>
<p>Variables of type <code>logical</code> are automatically converted to binary factors.</p>
</div>
<div id="order-of-the-sequence-of-imputation-models" class="section level3">
<h3 class="hasAnchor">
<a href="#order-of-the-sequence-of-imputation-models" class="anchor"></a>Order of the sequence of imputation models</h3>
<p>In <strong>JointAI</strong>, models for level-1 covariates are specified after models for level-2 covariates, so that the level-2 covariates are used as predictor variables in the models for level-1 covariates, but not vice versa.<br> Within the two groups, models are ordered by number of missing values (decreasing), so that the model for the variable with the most missing values has the most other variables in its linear predictor:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># number of missing values in the covariates in mod8a</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(NHANES[, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(mod8a<span class="op">$</span>models)]))</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt;    WC smoke  bili occup   alc </span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt;     2     7     8    28    34</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># =&gt; The sequence of models is ordered according to the number of missing values.</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># </span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co"># print information on the imputation models (and omit everything but the predictor variables)</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod8a, <span class="dt">priors =</span> F, <span class="dt">regcoef =</span> F, <span class="dt">otherpars =</span> F, <span class="dt">refcat =</span> F)</span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#&gt; Log-normal regression model for "WC"</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#&gt;   (Intercept), age, genderfemale</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">#&gt; </span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">#&gt; Cumulative logit model for "smoke"</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#&gt;   age, genderfemale, WC</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#&gt; </span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#&gt; Gamma regression model for "bili"</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#&gt; * Parametrization:</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt;   - shape: shape_bili = mu_bili^2 * tau_bili</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#&gt;   - rate: rate_bili = mu_bili * tau_bili</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt;   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#&gt; </span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">#&gt; Multinomial logit model for "occup"</span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">#&gt;   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent, bili</span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">#&gt; </span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co">#&gt; Logistic regression model for "alc"</span></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co">#&gt;   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent, bili, occuplooking for work, occupnot working</span></span></code></pre></div>
</div>
</div>
<div id="auxvars" class="section level2">
<h2 class="hasAnchor">
<a href="#auxvars" class="anchor"></a>Auxiliary variables</h2>
<p>Auxiliary variables are variables that are not part of the analysis model, but should be considered as predictor variables in the imputation models because they can inform the imputation of on unobserved values.</p>
<p>Good auxiliary variables are <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<ul>
<li>associated with an incomplete variable of interest, or are</li>
<li>associated with the missingness of that variable, and</li>
<li>do not have too many missing values themselves. Importantly, they should be observed for a large proportion of the cases that have a missing value in the variable to be imputed.</li>
</ul>
<p>In the main functions, <code>*_imp()</code>, auxiliary variables can be specified with the argument <code>auxvars</code>, which is a one-sided formula.</p>
<p><strong>Example:</strong><br> We might consider the variables <code>educ</code> and <code>smoke</code> as predictors for the imputation of <code>occup</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>mod9a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>occup, <span class="dt">auxvars =</span> <span class="op">~</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>smoke,</span>
<span id="cb20-2"><a href="#cb20-2"></a>                <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>)</span></code></pre></div>
<p>The variables <code>educ</code> and <code>smoke</code> are not used as predictors in the analysis model:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mod9a)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#&gt; </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#&gt;  Linear model fitted with JointAI </span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#&gt; lm_imp(formula = SBP ~ gender + age + occup, data = NHANES, n.iter = 100, </span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#&gt;     auxvars = ~educ + smoke, progress.bar = "none")</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co">#&gt; </span></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co">#&gt; Posterior summary:</span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co">#&gt;                          Mean     SD    2.5%   97.5% tail-prob. GR-crit</span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co">#&gt; (Intercept)           105.355 2.9340  99.432 110.680      0.000    1.00</span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="co">#&gt; genderfemale           -5.818 2.3518 -10.224  -1.151      0.020    1.01</span></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co">#&gt; age                     0.386 0.0666   0.265   0.516      0.000    1.01</span></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co">#&gt; occuplooking for work   4.344 6.4772  -8.323  17.032      0.553    1.01</span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co">#&gt; occupnot working       -0.765 2.7957  -6.028   4.568      0.787    1.02</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="co">#&gt; </span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co">#&gt; Posterior summary of residual std. deviation:</span></span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="co">#&gt;           Mean   SD 2.5% 97.5% GR-crit</span></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="co">#&gt; sigma_SBP 14.5 0.79 12.9  15.9    1.04</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co">#&gt; </span></span>
<span id="cb21-21"><a href="#cb21-21"></a><span class="co">#&gt; </span></span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="co">#&gt; MCMC settings:</span></span>
<span id="cb21-23"><a href="#cb21-23"></a><span class="co">#&gt; Iterations = 101:200</span></span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="co">#&gt; Sample size per chain = 100 </span></span>
<span id="cb21-25"><a href="#cb21-25"></a><span class="co">#&gt; Thinning interval = 1 </span></span>
<span id="cb21-26"><a href="#cb21-26"></a><span class="co">#&gt; Number of chains = 3 </span></span>
<span id="cb21-27"><a href="#cb21-27"></a><span class="co">#&gt; </span></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="co">#&gt; Number of observations: 186</span></span></code></pre></div>
<p>They are, however, used as predictors in the imputation for <code>occup</code> and imputed themselves (if they have missing values):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod9a, <span class="dt">priors =</span> <span class="ot">FALSE</span>, <span class="dt">regcoef =</span> <span class="ot">FALSE</span>, <span class="dt">otherpars =</span> <span class="ot">FALSE</span>, <span class="dt">refcat =</span> <span class="ot">FALSE</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt; Cumulative logit model for "smoke"</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt;   genderfemale, age, educhigh</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; </span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; Multinomial logit model for "occup"</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#&gt;   (Intercept), genderfemale, age, educhigh, smokeformer, smokecurrent</span></span></code></pre></div>
<div id="functions-of-variables-as-auxiliary-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-of-variables-as-auxiliary-variables" class="anchor"></a>Functions of variables as auxiliary variables</h3>
<p>As shown above in <a href="#mod3e"><code>mod3e</code></a> and <a href="#mod3e"><code>mod3f</code></a>, it is possible to specify functions of auxiliary variables. In that case, the auxiliary variable is not considered as linear effect but as specified by the function:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>mod9b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>occup, <span class="dt">data =</span> NHANES,</span>
<span id="cb23-2"><a href="#cb23-2"></a>                <span class="dt">auxvars =</span> <span class="op">~</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(WC),</span>
<span id="cb23-3"><a href="#cb23-3"></a>                <span class="dt">trunc =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">WC =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-10</span>, <span class="fl">1e10</span>)), <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw"><a href="../reference/list_models.html">list_models</a></span>(mod9b, <span class="dt">priors =</span> <span class="ot">FALSE</span>, <span class="dt">regcoef =</span> <span class="ot">FALSE</span>, <span class="dt">otherpars =</span> <span class="ot">FALSE</span>,</span>
<span id="cb24-2"><a href="#cb24-2"></a>               <span class="dt">refcat =</span> <span class="ot">FALSE</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#&gt; Linear regression model for "WC"</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">#&gt;   (Intercept), genderfemale, age, educhigh</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">#&gt; </span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#&gt; Cumulative logit model for "smoke"</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co">#&gt;   genderfemale, age, educhigh, log(WC)</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">#&gt; </span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">#&gt; Multinomial logit model for "occup"</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co">#&gt; * Predictor variables: </span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co">#&gt;   (Intercept), genderfemale, age, educhigh, log(WC), smokeformer, smokecurrent</span></span></code></pre></div>
<p><strong>Note:</strong><br> Omitting auxiliary variables from the analysis model implies that the outcome is independent of these variables, conditional on the other variables in the model. If this is not true, the model is mis-specified which may lead to biased results (similar to leaving a confounding variable out of a model).</p>
</div>
</div>
<div id="reference-values-for-categorical-covariates" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-values-for-categorical-covariates" class="anchor"></a>Reference values for categorical covariates</h2>
<p>In <strong>JointAI</strong>, dummy coding is used when categorical variables enter a linear predictor, i.e., a binary variables is created for each category, except the reference category. These binary variables have value one when that category was observed and zero otherwise. Contrary to the behavior in base R, this is also done for ordered factors. Note that it is not possible to overwrite this behavior using the base R contrasts specification.</p>
<p>By default, the first category of a categorical variable (ordered or unordered) is used as reference, however, this may not always allow the desired interpretation of the regression coefficients. Moreover, when categories are unbalanced, setting the largest group as reference may result in better mixing of the MCMC chains.</p>
<p>Therefore, <strong>JointAI</strong> allows specification of the reference category separately for each variable, via the argument <code>refcats</code>.</p>
<div id="setting-reference-categories-for-all-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-reference-categories-for-all-variables" class="anchor"></a>Setting reference categories for all variables</h3>
<p>To specify the choice of reference category globally for all variables in the model, <code>refcats</code> can be set as</p>
<ul>
<li><code>refcats = "first"</code></li>
<li><code>refcats = "last"</code></li>
<li><code>refcats = "largest"</code></li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>mod10a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</span>
<span id="cb25-2"><a href="#cb25-2"></a>                 <span class="dt">refcats =</span> <span class="st">"largest"</span>, <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<div id="setting-reference-categories-for-individual-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-reference-categories-for-individual-variables" class="anchor"></a>Setting reference categories for individual variables</h3>
<p>Alternatively, <code>refcats</code> takes a named vector, in which the reference category for each variable can be specified either by its number or its name, or one of the three global types: “first”, “last” or “largest”. For variables for which no reference category is specified in the list the default is used.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>mod10b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</span>
<span id="cb26-2"><a href="#cb26-2"></a>                 <span class="dt">refcats =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">occup =</span> <span class="st">"not working"</span>, <span class="dt">race =</span> <span class="dv">3</span>, <span class="dt">educ =</span> <span class="st">'largest'</span>),</span>
<span id="cb26-3"><a href="#cb26-3"></a>                 <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>To help to specify the reference category, the function <a href="https://nerler.github.io/JointAI/reference/set_refcat.html"><code><a href="../reference/set_refcat.html">set_refcat()</a></code></a> can be used. It prints the names of the categorical variables that are selected by</p>
<ul>
<li>a specified model formula and/or</li>
<li>a vector of auxiliary variables, or</li>
<li>a vector of naming covariates</li>
</ul>
<p>or all categorical variables in the data if only <code>data</code> is provided, and asks a number of questions which the user needs to reply to by input of a number.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>refs_mod10 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_refcat.html">set_refcat</a></span>(NHANES, <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span>(mod10b))</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co">#&gt; The categorical variables are:</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">#&gt; - "gender"</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">#&gt; - "race"</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">#&gt; - "educ"</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">#&gt; - "occup"</span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">#&gt; - "smoke"</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">#&gt; </span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co">#&gt; How do you want to specify the reference categories?</span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">#&gt; </span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#&gt; 1: Use the first category for each variable.</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">#&gt; 2: Use the last category for each variabe.</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">#&gt; 3: Use the largest category for each variable.</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="co">#&gt; 4: Specify the reference categories individually.</span></span></code></pre></div>
<p>When option 4 is chosen, a question for each categorical variable is asked, for example:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">#&gt; The reference category for “race” should be </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; 1: Mexican American</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">#&gt; 2: Other Hispanic</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">#&gt; 3: Non-Hispanic White</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">#&gt; 4: Non-Hispanic Black</span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">#&gt; 5: other</span></span></code></pre></div>
<p>After specification of the reference categories for all categorical variables, the determined specification for the argument <code>refcats</code> is printed:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">#&gt; In the JointAI model specify:</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt;  refcats = c(gender = 'female', race = 'Non-Hispanic White', educ = 'low',</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#&gt;              occup = 'not working', smoke = 'never')</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co">#&gt; </span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co">#&gt; or use the output of this function.</span></span></code></pre></div>
<p><code><a href="../reference/set_refcat.html">set_refcat()</a></code> also returns a named vector that can be passed to the argument <code>refcats</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>mod10c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</span>
<span id="cb30-2"><a href="#cb30-2"></a>                 <span class="dt">refcats =</span> refs_mod10, <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<div id="some-notes" class="section level3">
<h3 class="hasAnchor">
<a href="#some-notes" class="anchor"></a>Some notes</h3>
<p>Contrary to base R behavior, dummy coding (i.e., <code>contr.treatment</code> contrasts) are used for ordered factors in any linear predictor. Since the order of levels in an ordered factor contains information relevant to the imputation of missing values, it is important that incomplete ordinal variables are coded as such.</p>
<p>For unordered factors, the reference category could be changed in the dataset directly, outside of <strong>JointAI</strong>, e.g., using <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/relevel.html"><code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code></a>. For ordered factors, however, this is not possible without loosing or changing the order of the levels. In this case, the <code>refcats</code> argument in <strong>JointAI</strong> has to be used.</p>
<p>Changing a reference category via the argument <code>refcats</code> does not change the order of levels in the dataset or any of the data matrices inside <strong>JointAI</strong>. Only when, in the JAGS model, the categorical variables is converted into dummy variables, the reference category is used to determine for which levels the dummies are created.</p>
</div>
</div>
<div id="hyperparameters" class="section level2">
<h2 class="hasAnchor">
<a href="#hyperparameters" class="anchor"></a>Hyperparameters</h2>
<p>In the Bayesian framework, parameters are random variables for which a distribution needs to be specified. These distributions depend on parameters themselves, i.e., on hyperparameters.</p>
<p>The function <code><a href="../reference/default_hyperpars.html">default_hyperpars()</a></code> returns a list containing the default hyper parameters used in a <code>JointAI</code> model.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw"><a href="../reference/default_hyperpars.html">default_hyperpars</a></span>()</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">#&gt; $norm</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt;    mu_reg_norm   tau_reg_norm shape_tau_norm  rate_tau_norm </span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">#&gt;          0e+00          1e-04          1e-02          1e-02 </span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#&gt; </span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co">#&gt; $gamma</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">#&gt;    mu_reg_gamma   tau_reg_gamma shape_tau_gamma  rate_tau_gamma </span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co">#&gt;           0e+00           1e-04           1e-02           1e-02 </span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">#&gt; </span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co">#&gt; $beta</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="co">#&gt;    mu_reg_beta   tau_reg_beta shape_tau_beta  rate_tau_beta </span></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="co">#&gt;          0e+00          1e-04          1e-02          1e-02 </span></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="co">#&gt; </span></span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="co">#&gt; $logit</span></span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="co">#&gt;  mu_reg_logit tau_reg_logit </span></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co">#&gt;         0e+00         1e-04 </span></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="co">#&gt; </span></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="co">#&gt; $poisson</span></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="co">#&gt;  mu_reg_poisson tau_reg_poisson </span></span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="co">#&gt;           0e+00           1e-04 </span></span>
<span id="cb31-21"><a href="#cb31-21"></a><span class="co">#&gt; </span></span>
<span id="cb31-22"><a href="#cb31-22"></a><span class="co">#&gt; $probit</span></span>
<span id="cb31-23"><a href="#cb31-23"></a><span class="co">#&gt;  mu_reg_probit tau_reg_probit </span></span>
<span id="cb31-24"><a href="#cb31-24"></a><span class="co">#&gt;          0e+00          1e-04 </span></span>
<span id="cb31-25"><a href="#cb31-25"></a><span class="co">#&gt; </span></span>
<span id="cb31-26"><a href="#cb31-26"></a><span class="co">#&gt; $multinomial</span></span>
<span id="cb31-27"><a href="#cb31-27"></a><span class="co">#&gt;  mu_reg_multinomial tau_reg_multinomial </span></span>
<span id="cb31-28"><a href="#cb31-28"></a><span class="co">#&gt;               0e+00               1e-04 </span></span>
<span id="cb31-29"><a href="#cb31-29"></a><span class="co">#&gt; </span></span>
<span id="cb31-30"><a href="#cb31-30"></a><span class="co">#&gt; $ordinal</span></span>
<span id="cb31-31"><a href="#cb31-31"></a><span class="co">#&gt;    mu_reg_ordinal   tau_reg_ordinal  mu_delta_ordinal tau_delta_ordinal </span></span>
<span id="cb31-32"><a href="#cb31-32"></a><span class="co">#&gt;             0e+00             1e-04             0e+00             1e-04 </span></span>
<span id="cb31-33"><a href="#cb31-33"></a><span class="co">#&gt; </span></span>
<span id="cb31-34"><a href="#cb31-34"></a><span class="co">#&gt; $Z</span></span>
<span id="cb31-35"><a href="#cb31-35"></a><span class="co">#&gt; function (nranef) </span></span>
<span id="cb31-36"><a href="#cb31-36"></a><span class="co">#&gt; {</span></span>
<span id="cb31-37"><a href="#cb31-37"></a><span class="co">#&gt;     if (nranef &gt; 1) {</span></span>
<span id="cb31-38"><a href="#cb31-38"></a><span class="co">#&gt;         RinvD &lt;- diag(as.numeric(rep(NA, nranef)))</span></span>
<span id="cb31-39"><a href="#cb31-39"></a><span class="co">#&gt;         KinvD &lt;- nranef</span></span>
<span id="cb31-40"><a href="#cb31-40"></a><span class="co">#&gt;     }</span></span>
<span id="cb31-41"><a href="#cb31-41"></a><span class="co">#&gt;     else {</span></span>
<span id="cb31-42"><a href="#cb31-42"></a><span class="co">#&gt;         RinvD &lt;- KinvD &lt;- NULL</span></span>
<span id="cb31-43"><a href="#cb31-43"></a><span class="co">#&gt;     }</span></span>
<span id="cb31-44"><a href="#cb31-44"></a><span class="co">#&gt;     list(RinvD = RinvD, KinvD = KinvD, shape_diag_RinvD = 0.1, </span></span>
<span id="cb31-45"><a href="#cb31-45"></a><span class="co">#&gt;         rate_diag_RinvD = 0.01)</span></span>
<span id="cb31-46"><a href="#cb31-46"></a><span class="co">#&gt; }</span></span>
<span id="cb31-47"><a href="#cb31-47"></a><span class="co">#&gt; &lt;bytecode: 0x0000000015c19300&gt;</span></span>
<span id="cb31-48"><a href="#cb31-48"></a><span class="co">#&gt; &lt;environment: 0x000000001c06f678&gt;</span></span>
<span id="cb31-49"><a href="#cb31-49"></a><span class="co">#&gt; </span></span>
<span id="cb31-50"><a href="#cb31-50"></a><span class="co">#&gt; $surv</span></span>
<span id="cb31-51"><a href="#cb31-51"></a><span class="co">#&gt;  mu_reg_surv tau_reg_surv </span></span>
<span id="cb31-52"><a href="#cb31-52"></a><span class="co">#&gt;        0.000        0.001</span></span></code></pre></div>
<p>To change the hyperparameters in a <strong>JointAI</strong> model, the list obtained from <code><a href="../reference/default_hyperpars.html">default_hyperpars()</a></code> can be edited and passed to the argument <code>hyperpars</code> in the main functions <code>*_imp()</code>.</p>
<p><code>mu_reg_*</code> and <code>tau_reg_*</code> refer to the mean and precision in the distribution for regression coefficients. <code>shape_tau_*</code> and <code>rate_tau_*</code> are the shape and rate parameters of a Gamma distribution that is used has prior for precision parameters. <code>RinvD</code> is the scale matrix in the Wishart prior for the inverse of the random effects design matrix <code>D</code>, and <code>KinvD</code> the number of degrees of freedom in that distribution. <code>shape_diag_RinvD</code> and <code>rate_diag_RinvD</code> are the scale and rate parameters of the Gamma prior of the diagonal elements of <code>RinvD</code>. In random effects models with only one random effect, instead of the Wishart distribution a Gamma prior is used for the inverse of <code>D</code>.</p>
</div>
<div id="scaling" class="section level2">
<h2 class="hasAnchor">
<a href="#scaling" class="anchor"></a>Scaling</h2>
<p>When variables are measured on very different scales this can result in slow convergence and bad mixing. Therefore, <strong>JointAI</strong> automatically scales continuous variables to have mean zero and standard deviation one. Results (parameters and imputed values) are transformed back to the original scale.</p>
<p>In some settings, however, it is not possible to scale continuous variables. This is the case for incomplete variables that enter a linear predictor in a function and variables that are imputed with models that are defined on a subset of the real line (i.e., with a Gamma or a Beta distribution). Variables that are imputed with a log-normal distribution are scaled, but not centered. To prevent scaling, the argument <code>scale_vars</code> can be set to <code>FALSE</code>. When a vector of variable names is supplied to <code>scale_vars</code>, only those variables are scaled.</p>
<p>By default, only the MCMC samples that is scaled back to the scale of the data is stored in a <code>JointAI</code> object. When the argument <code>keep_scaled_mcmc = TRUE</code> also the scaled sample is kept.</p>
</div>
<div id="ridge-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#ridge-regression" class="anchor"></a>Ridge regression</h2>
<p>Using the argument <code>ridge = TRUE</code> it is possible to impose a ridge penalty on the parameters of the analysis model, shrinking these parameters towards zero. This is done by specification of a <span class="math inline">\(\text{Ga}(0.01, 0.01)\)</span> prior for the precision of the regression coefficients <span class="math inline">\(\beta\)</span> instead of setting it to a fixed (small) value.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note: these examples are chosen to demonstrate functionality and may not fit the data.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Again, this is just a demonstration of the possibilities in JointAI, but nesting transformations will most often result in coefficients that that do not have meaningful interpretation in practice.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Van Buuren, S. (2012). Flexible imputation of missing data. Chapman and Hall/CRC. See also the <a href="https://stefvanbuuren.name/fimd/">second edition online</a>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#analysis-model-type">Analysis model type</a></li>
      <li><a href="#ModelFormula">Model formula</a></li>
      <li><a href="#MultiLevelStructure">Multi-level structure &amp; longitudinal covariates</a></li>
      <li><a href="#meth">Covariate model types</a></li>
      <li><a href="#auxvars">Auxiliary variables</a></li>
      <li><a href="#reference-values-for-categorical-covariates">Reference values for categorical covariates</a></li>
      <li><a href="#hyperparameters">Hyperparameters</a></li>
      <li><a href="#scaling">Scaling</a></li>
      <li><a href="#ridge-regression">Ridge regression</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '0d21d69e7c3eb00e029f5b8d9424cd56',
    indexName: 'jointal',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Specification • JointAI</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Model Specification">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JointAI</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MinimalExample.html">Minimal Example</a>
    </li>
    <li>
      <a href="../articles/ModelSpecification.html">Model Specification</a>
    </li>
    <li>
      <a href="../articles/SelectingParameters.html">Parameter Selection</a>
    </li>
    <li>
      <a href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nerler/JointAI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/N_Erler">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Model Specification</h1>
                        <h4 class="author">Nicole Erler</h4>
            
            <h4 class="date">2018-08-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/master/vignettes/ModelSpecification.Rmd"><code>vignettes/ModelSpecification.Rmd</code></a></small>
      <div class="hidden name"><code>ModelSpecification.Rmd</code></div>

    </div>

    
    
<p>In this vignette we use the <a href="https://nerler.github.io/JointAI/reference/NHANES.html">NHANES</a> data for examples in cross-sectional data and the dataset <a href="https://nerler.github.io/JointAI/reference/simLong.html">simLong</a> for examples in longitudinal data. For more info on these datasets, check out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html"><em>Visualizing Incomplete Data</em></a>, in which the distributions of variables and missing values in both sets is explored.</p>
<p><strong>Note:</strong><br> In many of the examples we use <code>n.adapt = 0</code> (and <code>n.iter = 0</code>, which is the default) in order to prevent the MCMC sampling and, hence, reduce computational time. <code>mess = FALSE</code> is used to suppress messages that are not of interest in this vignette.</p>
<div id="analysis-model-type" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-model-type" class="anchor"></a>Analysis model type</h2>
<p><strong>JointAI</strong> has three main functions:</p>
<ul>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">lm_imp()</a></code></a>: linear regression</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">glm_imp()</a></code></a>: generalized linear regression</li>
<li>
<a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">lme_imp()</a></code></a>: linear mixed effects regression</li>
</ul>
<p>Specification of these functions is similar to the specification of the complete data versions <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html"><code>lm()</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/glm.html"><code>glm()</code></a> and <a href="https://stat.ethz.ch/R-manual/R-devel/library/nlme/html/lme.html"><code>lme()</code></a> (from package <strong>nlme</strong>).</p>
<p><code><a href="../reference/model_imp.html">lm_imp()</a></code> and <code><a href="../reference/model_imp.html">glm_imp()</a></code> take arguments <code>formula</code> and <code>data</code>, whereas <code><a href="../reference/model_imp.html">lme_imp()</a></code> requires the specification of a <code>fixed</code> effects and a <code>random</code> effects formula. Specification of the fixed effects formula is discussed in section <a href="#ModelFormula">Model formula</a>, specification of the random effects is discussed in section <a href="#MultiLevelStructure">Multi level structure &amp; longitudinal covariates</a></p>
<p>Additionally, <code><a href="../reference/model_imp.html">glm_imp()</a></code> requires the specification of the model <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/family.html"><code>family</code></a> and <code>link</code> function.</p>
<div id="model-family-and-link-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#model-family-and-link-functions" class="anchor"></a>Model family and link functions</h3>
<p>Implemented families and links are</p>
<table class="table">
<thead><tr class="header">
<th align="left">family</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>gaussian</code></td>
<td>with links: <code>identity</code>, <code>log</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>binomial</code></td>
<td>with links: <code>logit</code>, <code>probit</code>, <code>log</code>, <code>cloglog</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>Gamma</code></td>
<td>with links: <code>identity</code>, <code>log</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>poisson</code></td>
<td>with links: <code>log</code>, <code>identity</code>
</td>
</tr>
</tbody>
</table>
<p>The argument <code>family</code> can be given as character string or as function. If the link function is omitted, the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/family.html">default link</a> is used.</p>
<p><strong>Example:</strong><br> The following three specifications are equal:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">mod1a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">               <span class="dt">family =</span> <span class="st">"binomial"</span>, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">mod1b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">               <span class="dt">family =</span> <span class="kw">binomial</span>(), <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">mod1c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">               <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">'logit'</span>), <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">mod1a<span class="op">$</span>family</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">mod1a<span class="op">$</span>link</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>To use a probit link instead, this needs to be specified explicitly:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">mod1d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES,</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">               <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">'probit'</span>), <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">mod1d<span class="op">$</span>family</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">mod1d<span class="op">$</span>link</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; NULL</span></a></code></pre></div>
</div>
</div>
<div id="ModelFormula" class="section level2">
<h2 class="hasAnchor">
<a href="#ModelFormula" class="anchor"></a>Model formula</h2>
<p>The arguments <code>formula</code> (in <code><a href="../reference/model_imp.html">lm_imp()</a></code> and <code><a href="../reference/model_imp.html">glm_imp()</a></code>) and <code>fixed</code> (in <code><a href="../reference/model_imp.html">lme_imp()</a></code>) take a two-sided <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html"><code>formula</code></a> object, where <code>~</code> separates the response (outcome / dependent variable) from the linear predictor, in which covariates (independent variables) are separated by <code>+</code>. An intercept is added automatically.</p>
<div id="interactions" class="section level3">
<h3 class="hasAnchor">
<a href="#interactions" class="anchor"></a>Interactions</h3>
<p>Interactions between variables can be introduced using <code>:</code> or <code>*</code>, which adds the interaction term AND the main effects, i.e.,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>smoke <span class="op">*</span><span class="st"> </span>creat</a></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat <span class="op">+</span><span class="st"> </span>smoke<span class="op">:</span>creat</a></code></pre></div>
<div id="interaction-with-multiple-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#interaction-with-multiple-variables" class="anchor"></a>Interaction with multiple variables</h4>
<p>Interactions between multiple variables can be specified using parentheses:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">mod2a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>gender <span class="op">*</span><span class="st"> </span>(age <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat),</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                 <span class="dt">data =</span> NHANES, <span class="dt">family =</span> <span class="st">'binomial'</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(mod2a, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  [1] "(Intercept)"               "genderfemale"              "age"                      </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;  [4] "smokeformer"               "smokecurrent"              "creat"                    </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;  [7] "genderfemale:age"          "genderfemale:smokeformer"  "genderfemale:smokecurrent"</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [10] "genderfemale:creat"</span></a></code></pre></div>
<p>The function <a href="https://nerler.github.io/JointAI/reference/parameters.html"><code><a href="../reference/parameters.html">parameters()</a></code></a> returns the parameters that are specified to be followed (even for models where no MCMC sampling was performed, i.e., when <code>n.iter = 0</code> and <code>n.adapt = 0</code>).</p>
</div>
<div id="higher-level-interactions" class="section level4">
<h4 class="hasAnchor">
<a href="#higher-level-interactions" class="anchor"></a>Higher level interactions</h4>
<p>To specify interactions of a given level <code>^</code> can be used:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># all two-way interactions:</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">mod2b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>(age <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat)<span class="op">^</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                 <span class="dt">data =</span> NHANES, <span class="dt">family =</span> <span class="st">'binomial'</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(mod2b, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;  [1] "(Intercept)"        "genderfemale"       "age"                "smokeformer"       </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  [5] "smokecurrent"       "creat"              "age:smokeformer"    "age:smokecurrent"  </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  [9] "age:creat"          "smokeformer:creat"  "smokecurrent:creat"</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># all two- and three-way interactions:</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">mod2c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">glm_imp</a></span>(educ <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>(age <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>creat)<span class="op">^</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">                 <span class="dt">data =</span> NHANES, <span class="dt">family =</span> <span class="st">'binomial'</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">n.adapt =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(mod2c, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;  [1] "(Intercept)"            "genderfemale"           "age"                   </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;  [4] "smokeformer"            "smokecurrent"           "creat"                 </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;  [7] "age:smokeformer"        "age:smokecurrent"       "age:creat"             </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; [10] "smokeformer:creat"      "smokecurrent:creat"     "age:smokeformer:creat" </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; [13] "age:smokecurrent:creat"</span></a></code></pre></div>
<p>In <strong>JointAI</strong>, interactions between any type of variables (observed, incomplete, time-varying) are allowed. When an incomplete variable is involved, the interaction term is re-calculated within each iteration of the MCMC sampling, using the imputed values from the current iteration.</p>
</div>
</div>
<div id="non-linear-functional-forms" class="section level3">
<h3 class="hasAnchor">
<a href="#non-linear-functional-forms" class="anchor"></a>Non-linear functional forms</h3>
<p>In practice, associations between outcome and covariates do not always meet the standard assumption that all covariate effects are linear. Often, assuming a logarithmic, quadratic or other non-linear effect is more appropriate.</p>
<p>Non-linear associations can be specified in the model formula using either functions such as <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Log.html"><code>log()</code></a> (the natural logarithm), <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/MathFun.html"><code>sqrt()</code></a> (the square root) or <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Log.html"><code>exp()</code></a> (the exponential function), or by specifying a function of a variable using <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/AsIs.html"><code>I()</code></a>, for example, <code>I(x^2)</code> would be the quadratic term of a variable <code>x</code>.</p>
<p>For <em>completely observed covariates</em>, <strong>JointAI</strong> can handle any common type of function implemented in R, including splines, e.g., using <a href="https://stat.ethz.ch/R-manual/R-devel/library/splines/html/ns.html"><code>ns()</code></a> or <a href="https://stat.ethz.ch/R-manual/R-devel/library/splines/html/bs.html"><code>bs()</code></a> from the package <strong>splines</strong> (which is automatically installed with R).</p>
<p>Since functions involving <em>variables that have missing values</em> need to be re-calculated in each iteration of the MCMC sampling, currently, only functions that are available in JAGS can be used for incomplete variables. Those functions include:</p>
<ul>
<li>
<code>log()</code>, <code>exp()</code>
</li>
<li>
<code>sqrt()</code>, polynomials (using <code>I()</code>)</li>
<li><code>abs()</code></li>
<li>
<code>sin()</code>, <code>cos()</code>
</li>
<li>algebraic operations involving one or multiple (in)complete variables, as long as the formula can be interpreted by JAGS</li>
</ul>
<p>The list of functions implemented in JAGS can be found in the <a href="https://sourceforge.net/projects/mcmc-jags/files/Manuals/">JAGS user manual</a>.</p>
<p><strong>Some examples:</strong><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Absolute difference between bili and creat</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">mod3a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(bili <span class="op">-</span><span class="st"> </span>creat),</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co"># Using a natural cubic spline for age (completely observed) and a quadratic</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co"># and a cubic effect for bili</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">library</span>(splines)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">mod3b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(bili<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(bili<span class="op">^</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">keep_model =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co"># A function of creat and albu</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">mod3c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(creat<span class="op">/</span>albu<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co"># This function may make more sense to calculate BMI as weight/height^2, but</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># we do not have those variables in the NHANES data...</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co"># Using the sinus and cosinus</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">mod3d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span><span class="kw">sin</span>(creat) <span class="op">+</span><span class="st"> </span><span class="kw">cos</span>(albu),</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div id="what-happens-inside-jointai" class="section level4">
<h4 class="hasAnchor">
<a href="#what-happens-inside-jointai" class="anchor"></a>What happens inside <strong>JointAI</strong>?</h4>
<p>When a function of a complete or incomplete variable is used in the model formula, the main effect of that variable is automatically added as auxiliary variable (more on auxiliary variables in section <a href="#auxvars">Auxiliary variables</a>), and only the main effects are used as predictors in the imputation models.</p>
<p>In <code>mod3b</code>, for example, the spline of age is used as predictor for <code>SBP</code>, but in the imputation model for <code>bili</code>, <code>age</code> enters with a linear effect.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/list_impmodels.html">list_impmodels</a></span>(mod3b, <span class="dt">priors =</span> <span class="ot">FALSE</span>, <span class="dt">regcoef =</span> <span class="ot">FALSE</span>, <span class="dt">otherpars =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; Normal imputation model for 'bili'</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt;   (Intercept), genderfemale, age</span></a></code></pre></div>
<p>The function <a href="https://nerler.github.io/JointAI/reference/list_impmodels.html"><code>list_impmodels</code></a> prints a list of the imputation models used in a JointAI object. Since, at the moment, we are only interested in the predictor variables, we suppress printing of information on prior distributions, regression coefficients and other parameters by setting <code>priors</code>, <code>regcoev</code> and <code>otherpars</code> to <code>FALSE</code>.</p>
<p><br></p>
<p>When a function of a variable is specified as auxiliary variable, this function is used in the imputation models. For example, in <code>mod3e</code>, waist circumference (<code>WC</code>) is not part of the model for <code>SBP</code>, and <code>I(WC^2)</code> is used in the linear predictor of the imputation model for <code>bili</code>: <a id="mod3e"></a></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">mod3e &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>bili, <span class="dt">auxvars =</span> <span class="st">"I(WC^2)"</span>,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="../reference/list_impmodels.html">list_impmodels</a></span>(mod3e, <span class="dt">priors =</span> F, <span class="dt">regcoef =</span> F, <span class="dt">otherpars =</span> F)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; Normal imputation model for 'WC'</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;   (Intercept), age, genderfemale</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; Normal imputation model for 'bili'</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;   (Intercept), age, genderfemale, I(WC^2)</span></a></code></pre></div>
<p>Incomplete variables are always imputed on their original scale, i.e.,</p>
<ul>
<li>in <code>mod3b</code> the variable <code>bili</code> is imputed and the quadratic and cubic versions calculated from the imputed values.</li>
<li>Likewise, <code>creat</code> and <code>albu</code> in <code>mod3c</code> are imputed separately, and <code>I(creat/albu^2)</code> calculated from the imputed (and observed) values.</li>
</ul>
</div>
<div id="functions-with-restricted-support" class="section level4">
<h4 class="hasAnchor">
<a href="#functions-with-restricted-support" class="anchor"></a>Functions with restricted support</h4>
<p>When a function has restricted support, e.g., <code>log(x)</code> is only defined for <code>x &gt; 0</code>, the distribution used to impute that variable needs to comply with these restrictions. This can either be achieved by truncating the distribution, using the argument <code>trunc</code>, or by selecting an imputation method that meets the restrictions. For more information on imputation methods, see the section <a href="#meth">Imputation model types</a>.</p>
<p><strong>Example</strong>:<br> When using a <code>log()</code> transformation for the covariate <code>bili</code>, we can either use the default imputation method <code>norm</code> (a normal distribution) and truncate it by specifying <code>trunc = list(bili = c(lower, upper))</code> (where the lower and upper limits are the smallest and largest allowed values) or choose an imputation method (using the argument <code>meth</code>; more details see the section on <a href="#meth">Imputation model types</a>) that only imputes positive values such as a log-normal distribution (<code>lognorm</code>) or a Gamma distribution (<code>gamma</code>): <a id="mod4"></a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># truncation of the distribution of  bili</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">mod4a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(bili) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(creat),</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                <span class="dt">trunc =</span> <span class="kw">list</span>(<span class="dt">bili =</span> <span class="kw">c</span>(<span class="fl">1e-5</span>, <span class="fl">1e10</span>)),</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">keep_model =</span> T)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># log-normal model for bili</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">mod4b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(bili) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(creat),</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">                <span class="dt">meth =</span> <span class="kw">c</span>(<span class="dt">bili =</span> <span class="st">'lognorm'</span>, <span class="dt">creat =</span> <span class="st">'norm'</span>),</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">keep_model =</span> T)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co"># gamma model for bili</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">mod4c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(bili) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(creat),</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">                <span class="dt">meth =</span> <span class="kw">c</span>(<span class="dt">bili =</span> <span class="st">'gamma'</span>, <span class="dt">creat =</span> <span class="st">'norm'</span>),</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">                <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">keep_model =</span> T)</a></code></pre></div>
<p>Truncation always requires to specify both limits. Since <code>-Inf</code> and <code>Inf</code> are not accepted, a value outside the range of the variable (here: 1e10) can be selected for the second boundary of the truncation interval.</p>
</div>
<div id="functions-that-are-not-available-in-r" class="section level4">
<h4 class="hasAnchor">
<a href="#functions-that-are-not-available-in-r" class="anchor"></a>Functions that are not available in R</h4>
<p>It is possible to use functions that have different names in R and JAGS, or that do exist in JAGS, but not in R, by defining a new function in R that has the name of the function in JAGS.</p>
<p><strong>Example</strong>:<br> In JAGS the inverse logit transformation is defined in the function <code>ilogit</code>. In R, there is no function <code>ilogit</code>, but the inverse logit is available as the distribution function of the logistic distribution <code>plogis</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Define the function ilogit</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">ilogit &lt;-<span class="st"> </span>plogis</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># Use ilogit in the model formula</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">mod5a =<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">ilogit</span>(creat),</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">               <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="nested-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#nested-functions" class="anchor"></a>Nested functions</h4>
<p>It is also possible to nest a function in another function.</p>
<p><strong>Example:</strong><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>The complementary log log transformation is restricted to values larger than 0 and smaller than 1. In order to use this function on a variable that exceeds this range, as is the case for <code>creat</code>, a second transformation might be used, for instance the inverse logit from the previous example.</p>
<p>In JAGS, the complementary log log transformation is implemented as <code>cloglog</code>, but since this function does not exist in (base) R, we first need to define it:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># define the complementary log log transformation</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">cloglog &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">log</span>(<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># define the inverse logit (in case you have not done it in the previous example)</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">ilogit &lt;-<span class="st"> </span>plogis</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co"># nest ilogit inside cloglog</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">mod6a =<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span><span class="kw">cloglog</span>(<span class="kw">ilogit</span>(creat)),</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">               <span class="dt">data =</span> NHANES, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
</div>
</div>
<div id="MultiLevelStructure" class="section level2">
<h2 class="hasAnchor">
<a href="#MultiLevelStructure" class="anchor"></a>Multi level structure &amp; longitudinal covariates</h2>
<p>In multi-level models, additional to the fixed effects structure specified by the argument <code>fixed</code> a random effects structure needs to be provided via the argument <code>random</code>.</p>
<div id="random-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#random-effects" class="anchor"></a>Random effects</h3>
<p><code>random</code> takes a one-sided formula starting with a <code>~</code>. Variables for which a random effect should be included are usually separated by a <code>+</code>, and the grouping variable is separated by <code>|</code>. A random intercept is added automatically and only needs to be specified in a random intercept only model.</p>
<p>A few examples:</p>
<ul>
<li>
<code>random = ~1|id</code>: random intercept only, with <code>id</code> as grouping variable</li>
<li>
<code>random = ~time|id</code>: random intercept and slope for variable <code>time</code>
</li>
<li>
<code>random = ~time + I(time^2)</code>: random intercept, slope and quadratic random effect for <code>time</code>
</li>
<li>
<code>random = ~time + x | id</code> random intercept, random slope for <code>time</code> and random effect for variable <code>x</code>
</li>
</ul>
<p>It is possible to use splines in the random effects structure, e.g.:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">mod7a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>GESTBIR <span class="op">+</span><span class="st"> </span>ETHN <span class="op">+</span><span class="st"> </span>HEIGHT_M <span class="op">+</span><span class="st"> </span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                 <span class="dt">random =</span> <span class="op">~</span><span class="kw">ns</span>(age, <span class="dt">df =</span> <span class="dv">2</span>)<span class="op">|</span>ID, </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                 <span class="dt">data =</span> simLong, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Currently, multiple levels of nesting are not yet available.</p>
</div>
<div id="longitudinal-covariates" class="section level3">
<h3 class="hasAnchor">
<a href="#longitudinal-covariates" class="anchor"></a>Longitudinal covariates</h3>
<p>Longitudinal (“time-varying”) covariates can be used in the model, however, they can not yet be imputed.</p>
</div>
</div>
<div id="meth" class="section level2">
<h2 class="hasAnchor">
<a href="#meth" class="anchor"></a>Imputation model types</h2>
<p><strong>JointAI</strong> automatically selects an imputation model for each of the incomplete variables, based on the <code>class</code> of the variable and the number of levels. The automatically selected types are:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">model</th>
<th align="left">variable type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>norm</code></td>
<td align="left">linear regression</td>
<td align="left">continuous variables</td>
</tr>
<tr class="even">
<td align="left"><code>logit</code></td>
<td align="left">logistic regression</td>
<td align="left">factors with two levels</td>
</tr>
<tr class="odd">
<td align="left"><code>multilogit</code></td>
<td align="left">multinomial logit model</td>
<td align="left">unordered factors with &gt;2 levels</td>
</tr>
<tr class="even">
<td align="left"><code>cumlogit</code></td>
<td align="left">cumulative logit model</td>
<td align="left">ordered factors with &gt;2 levels</td>
</tr>
</tbody>
</table>
<p>The imputation models that are chosen by default may not necessarily be appropriate for the data at hand, especially for continuous variables, which often do not comply with the assumptions of (conditional) normality.</p>
<p>Therefore, alternative imputation methods are available for continuous covariates:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">model</th>
<th align="left">variable type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>lognorm</code></td>
<td align="left">normal regression of the log-transformed variable</td>
<td align="left">right-skewed variables &gt;0</td>
</tr>
<tr class="even">
<td align="left"><code>gamma</code></td>
<td align="left">Gamma regression (with log-link)</td>
<td align="left">right-skewed variables &gt;0</td>
</tr>
<tr class="odd">
<td align="left"><code>beta</code></td>
<td align="left">beta regression (with logit-link)</td>
<td align="left">continuous variables with values in [0, 1]</td>
</tr>
</tbody>
</table>
<p><code>lognorm</code> assumes a normal distribution for the natural logarithm of the variable, but the variable enters the linear predictor of the analysis model (and possibly other imputation models) on its original scale.</p>
<div id="specification-of-imputation-model-types" class="section level3">
<h3 class="hasAnchor">
<a href="#specification-of-imputation-model-types" class="anchor"></a>Specification of imputation model types</h3>
<p>In models <a href="#mod4"><code>mod4b</code> and <code>mod4c</code></a> we have already seen two examples in which the imputation model type was changed using the argument <code>meth</code>. When the model has many incomplete predictor variables, but not all need to be changed, it can be useful to perform a set-up run of the model without any iterations, extract the vector of imputation models that were automatically selected, and apply changes to that vector:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># run the model without iterations</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">mod8a_setup &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">0</span>, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co"># extract the automatically chosen imputation methods</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">newmeth &lt;-<span class="st"> </span>mod8a_setup<span class="op">$</span>meth</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">newmeth</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt;           WC        smoke         bili        occup          alc </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt;       "norm"   "cumlogit"       "norm" "multilogit"      "logit"</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co"># change the method for bili to lognorm</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">newmeth[<span class="st">'bili'</span>] &lt;-<span class="st"> 'lognorm'</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co"># run the model with the specified imputation method</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">mod8a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">                <span class="dt">meth =</span> newmeth,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">                <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>)</a>
<a class="sourceLine" id="cb14-18" data-line-number="18"></a>
<a class="sourceLine" id="cb14-19" data-line-number="19">mod8a<span class="op">$</span>meth</a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt;           WC        smoke         bili        occup          alc </span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt;       "norm"   "cumlogit"    "lognorm" "multilogit"      "logit"</span></a></code></pre></div>
<p>Alternatively, the function <a href="https://nerler.github.io/JointAI/reference/get_imp_meth.html"><code><a href="../reference/get_imp_meth.html">get_imp_meth()</a></code></a> can be called directly. <code>get_imp_meth</code> has arguments</p>
<ul>
<li>
<code>fixed</code>: the fixed effects formula</li>
<li>
<code>random</code>: the random effects formula (if necessary)</li>
<li>
<code>data</code>: the dataset</li>
<li>
<code>auxvars</code>: an optional vector of auxiliary variables.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">mod8a_meth &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_imp_meth.html">get_imp_meth</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>bili <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">                           <span class="dt">data =</span> NHANES)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">mod8a_meth</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt;           WC        smoke         bili        occup          alc </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt;       "norm"   "cumlogit"       "norm" "multilogit"      "logit"</span></a></code></pre></div>
</div>
<div id="order-of-the-sequence-of-imputation-models" class="section level3">
<h3 class="hasAnchor">
<a href="#order-of-the-sequence-of-imputation-models" class="anchor"></a>Order of the sequence of imputation models</h3>
<p>By default, the imputation models are ordered by number of missing values (decreasing), and each model has the (cross-sectional) complete covariates and all incomplete variables that appear earlier in the sequence in its linear predictor:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># number of missing values in the covariates in mod8a</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">colSums</span>(<span class="kw">is.na</span>(NHANES[, <span class="kw">names</span>(newmeth)]))</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt;    WC smoke  bili occup   alc </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt;     2     7     8    28    34</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co"># print information on the imputation models (and omit everything but the predictor variables)</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="../reference/list_impmodels.html">list_impmodels</a></span>(mod8a, <span class="dt">priors =</span> F, <span class="dt">regcoef =</span> F, <span class="dt">otherpars =</span> F, <span class="dt">refcat =</span> F)</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; Normal imputation model for 'WC'</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt;   (Intercept), age, genderfemale</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt; Cumulative logit imputation model for 'smoke'</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt;   age, genderfemale, WC</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#&gt; Log-normal imputation model for 'bili'</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">#&gt;   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">#&gt; Multinomial logit imputation model for 'occup'</span></a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"><span class="co">#&gt;   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent, bili</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-24" data-line-number="24"><span class="co">#&gt; Logistic imputation model for 'alc'</span></a>
<a class="sourceLine" id="cb16-25" data-line-number="25"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb16-26" data-line-number="26"><span class="co">#&gt;   (Intercept), age, genderfemale, WC, smokeformer, smokecurrent, bili, occuplooking for work, occupnot working</span></a></code></pre></div>
<p>By re-ordering the elements in <code>meth</code>, the order of the sequence of imputation models will be changed.</p>
</div>
</div>
<div id="auxvars" class="section level2">
<h2 class="hasAnchor">
<a href="#auxvars" class="anchor"></a>Auxiliary variables</h2>
<p>Auxiliary variables are variables that are not part of the analysis model, but should be considered as predictor variables in the imputation models because they can inform the imputation of on unobserved values.</p>
<p>Good auxiliary variables are</p>
<ul>
<li>associated with an incomplete variable of interest, or are</li>
<li>associated with the missingness of that variable and</li>
<li>do not have too many missing values themselves. Importantly, they should be observed for a large proportion of the cases that have a missing value in the variable to be imputed.</li>
</ul>
<p>In <code><a href="../reference/model_imp.html">lm_imp()</a></code>, <code><a href="../reference/model_imp.html">glm_imp()</a></code> and <code><a href="../reference/model_imp.html">lme_imp()</a></code>, auxiliary variables can be specified with the argument <code>auxvars</code>, which is a vector containing the names of the auxiliary variables.</p>
<p><strong>Example:</strong><br> We might consider the variables <code>educ</code> and <code>smoke</code> as predictors for the imputation of <code>occup</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">mod9a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>occup, <span class="dt">auxvars =</span> <span class="kw">c</span>(<span class="st">'educ'</span>, <span class="st">'smoke'</span>),</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">                <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>The regression coefficients for <code>educ</code> and <code>smoke</code> in the analysis model are fixed to zero so that these two variables do not contribute to the model, and are omitted from the model summary:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">summary</span>(mod9a)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt;  Linear model fitted with JointAI </span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; lm_imp(formula = SBP ~ gender + age + occup, data = NHANES, n.iter = 100, </span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt;     progress.bar = "none", mess = FALSE, auxvars = c("educ", </span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt;         "smoke"))</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; Posterior summary:</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt;                           Mean      SD    2.5%    97.5% tail-prob.</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; (Intercept)           105.3315 3.24114 98.9123 111.3953    0.00000</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; genderfemale           -5.6519 2.33607 -9.7904  -1.0873    0.01333</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; age                     0.3817 0.07877  0.2329   0.5355    0.00000</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; occuplooking for work   3.6034 6.30459 -9.6256  15.7475    0.54000</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; occupnot working       -0.4705 2.79045 -5.7932   4.8042    0.88667</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">#&gt; Posterior summary of residual std. deviation:</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="co">#&gt;            Mean     SD  2.5% 97.5%</span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="co">#&gt; sigma_SBP 14.44 0.7299 13.02  15.8</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="co">#&gt; MCMC settings:</span></a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="co">#&gt; Iterations = 101:200</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="co">#&gt; Sample size per chain = 100 </span></a>
<a class="sourceLine" id="cb18-26" data-line-number="26"><span class="co">#&gt; Thinning interval = 1 </span></a>
<a class="sourceLine" id="cb18-27" data-line-number="27"><span class="co">#&gt; Number of chains = 3 </span></a>
<a class="sourceLine" id="cb18-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29"><span class="co">#&gt; Number of observations: 186</span></a></code></pre></div>
<p>They are, however, used as predictors in the imputation for <code>occup</code> and imputed themselves (if they have missing values):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="../reference/list_impmodels.html">list_impmodels</a></span>(mod9a, <span class="dt">priors =</span> <span class="ot">FALSE</span>, <span class="dt">regcoef =</span> <span class="ot">FALSE</span>, <span class="dt">otherpars =</span> <span class="ot">FALSE</span>, <span class="dt">refcat =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; Cumulative logit imputation model for 'smoke'</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt;   genderfemale, age, educhigh</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt; Multinomial logit imputation model for 'occup'</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt;   (Intercept), genderfemale, age, educhigh, smokeformer, smokecurrent</span></a></code></pre></div>
<div id="functions-of-variables-as-auxiliary-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-of-variables-as-auxiliary-variables" class="anchor"></a>Functions of variables as auxiliary variables</h3>
<p>As shown above in <a href="#mod3e"><code>mod3e</code></a>, it is possible to specify functions of auxiliary variables. In that case, the auxiliary variable is not considered as linear effect but as specified by the function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">mod9b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>occup, <span class="dt">data =</span> NHANES,</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">                <span class="dt">auxvars =</span> <span class="kw">c</span>(<span class="st">'educ'</span>, <span class="st">'smoke'</span>, <span class="st">'log(WC)'</span>),</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">                <span class="dt">trunc =</span> <span class="kw">list</span>(<span class="dt">WC =</span> <span class="kw">c</span>(<span class="fl">1e-10</span>, <span class="fl">1e10</span>)), <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="../reference/list_impmodels.html">list_impmodels</a></span>(mod9b, <span class="dt">priors =</span> <span class="ot">FALSE</span>, <span class="dt">regcoef =</span> <span class="ot">FALSE</span>, <span class="dt">otherpars =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">               <span class="dt">refcat =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt; Normal imputation model for 'WC'</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;   (Intercept), genderfemale, age, educhigh</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; Cumulative logit imputation model for 'smoke'</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt;   genderfemale, age, educhigh, log(WC)</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; Multinomial logit imputation model for 'occup'</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt;   (Intercept), genderfemale, age, educhigh, log(WC), smokeformer, smokecurrent</span></a></code></pre></div>
</div>
</div>
<div id="reference-values-for-categorical-covariates" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-values-for-categorical-covariates" class="anchor"></a>Reference values for categorical covariates</h2>
<p>In <strong>JointAI</strong> dummy coding is used when categorical variables enter a linear predictor, i.e., a binary variables is created for each category, except the reference category. These binary variables have value one when that category was observed and zero otherwise.</p>
<p>By default, the first category of a categorical variable (ordered or unordered) is used as reference, however, this may not always allow the desired interpretation of the regression coefficients. Moreover, when categories are unbalanced, setting the largest group as reference may result in better mixing of the MCMC chains.</p>
<p>Therefore, <strong>JointAI</strong> allows specification of the reference category separately for each variable, via the argument <code>refcats</code>.</p>
<div id="setting-reference-categories-for-all-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-reference-categories-for-all-variables" class="anchor"></a>Setting reference categories for all variables</h3>
<p>To specify the choice of reference category globally for all variables in the model, <code>refcats</code> can be set as</p>
<ul>
<li><code>refcats = "first"</code></li>
<li><code>refcats = "last"</code></li>
<li><code>refcats = "largest"</code></li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">mod10a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                 <span class="dt">refcats =</span> <span class="st">"largest"</span>,</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                 <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="setting-reference-categories-for-individual-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-reference-categories-for-individual-variables" class="anchor"></a>Setting reference categories for individual variables</h3>
<p>Alternatively, <code>refcats</code> takes a named vector, in which the reference category for each variable can be specified either by its number or its name, or one of the three global types: “first”, “last” or “largest”. For variables for which no reference category is specified in the list the default is used.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">mod10b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">                 <span class="dt">refcats =</span> <span class="kw">list</span>(<span class="dt">occup =</span> <span class="st">"not working"</span>, <span class="dt">race =</span> <span class="dv">3</span>, <span class="dt">educ =</span> <span class="st">'largest'</span>),</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">                 <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>To help to specify the reference category, the function <a href="https://nerler.github.io/JointAI/reference/set_refcat.html"><code><a href="../reference/set_refcat.html">set_refcat()</a></code></a> can be used. It prints the names of the categorical variables that are selected by</p>
<ul>
<li>a specified model formula and/or</li>
<li>a vector of auxiliary variables, or</li>
<li>a vector of naming covariates</li>
</ul>
<p>or all categorical variabels in the data if only <code>data</code> is provided, and asks a number of questions which the user needs to reply to by input of a number.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">refs_mod10 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_refcat.html">set_refcat</a></span>(NHANES, <span class="dt">formula =</span> <span class="kw">formula</span>(mod10b))</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt; The categorical variables are:</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; - "gender"</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; - "race"</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt; - "educ"</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt; - "occup"</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt; - "smoke"</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt; How do you want to specify the reference categories?</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">#&gt; 1: Use the first category for each variable.</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">#&gt; 2: Use the last category for each variabe.</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">#&gt; 3: Use the largest category for each variable.</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">#&gt; 4: Specify the reference categories individually.</span></a></code></pre></div>
<p>When option 4 is chosen, a question for each categorical variable is asked, for example:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">#&gt; The reference category for “race” should be </span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">#&gt; 1: Mexican American</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt; 2: Other Hispanic</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt; 3: Non-Hispanic White</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt; 4: Non-Hispanic Black</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt; 5: other</span></a></code></pre></div>
<p>After specification of the reference categories for all categorical variables, the determined specification for the argument <code>refcats</code> is printed:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co">#&gt; In the JointAI model specify:</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">#&gt;  refcats = c(gender = 'female', race = 'Non-Hispanic White', educ = 'low',</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">#&gt;              occup = 'not working', smoke = 'never')</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">#&gt; or use the output of this function.</span></a></code></pre></div>
<p><code><a href="../reference/set_refcat.html">set_refcat()</a></code> also returns a named vector that can be passed to the argument <code>refcats</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">mod10c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>occup <span class="op">+</span><span class="st"> </span>smoke,</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">                 <span class="dt">refcats =</span> refs_mod10,</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">                 <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<!-- ## Scaling -->
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note: these examples are chosen to demonstrate functionality and may not fit the data.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Again, this is just a demonstration of the possibilities in JointAI, but nesting transformations will most often result in coefficients that that do not have meaningful interpretation in practice.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#analysis-model-type">Analysis model type</a></li>
      <li><a href="#ModelFormula">Model formula</a></li>
      <li><a href="#MultiLevelStructure">Multi level structure &amp; longitudinal covariates</a></li>
      <li><a href="#meth">Imputation model types</a></li>
      <li><a href="#auxvars">Auxiliary variables</a></li>
      <li><a href="#reference-values-for-categorical-covariates">Reference values for categorical covariates</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: '0d21d69e7c3eb00e029f5b8d9424cd56',
    indexName: 'jointal',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>

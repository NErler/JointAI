<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minimal Example â€¢ JointAI</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Minimal Example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JointAI</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BasicExample.html">Minimal Example</a>
    </li>
    <li>
      <a href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nerler/JointAI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/N_Erler">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Minimal Example</h1>
                        <h4 class="author">Nicole Erler</h4>
            
            <h4 class="date">2018-07-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/master/vignettes/BasicExample.Rmd"><code>vignettes/BasicExample.Rmd</code></a></small>
      <div class="hidden name"><code>BasicExample.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we use the NHANES data that are part of the <strong>JointAI</strong> package. For more info on this data, check the <a href="https://nerler.github.io/JointAI/reference/NHANES.html">help file</a> for the NHANES data, go to the <a href="https://www.cdc.gov/nchs/nhanes/index.htm">web page of the National Health and Nutrition Examination Survey (NHANES)</a> and check out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>, in which the NHANES data is explored.</p>
<div id="fitting-a-linear-regression-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-linear-regression-model" class="anchor"></a>Fitting a linear regression model</h2>
<p>To fit a linear regression model with <strong>JointAI</strong> is straightforward with the function <code><a href="../reference/model_imp.html">lm_imp()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">lm1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>educ <span class="op">+</span><span class="st"> </span>creat <span class="op">+</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="st">                </span>albu <span class="op">+</span><span class="st"> </span>uricacid <span class="op">+</span><span class="st"> </span>bili,</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">              <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">500</span>)</a></code></pre></div>
<p>The specification of <code><a href="../reference/model_imp.html">lm_imp()</a></code> is similar to the specification of a linear regression model for complete data using <code>lm()</code>. In this minimal example the only difference is that for <code><a href="../reference/model_imp.html">lm_imp()</a></code> the number of iterations <code>n.iter</code> has to be specified. Of course there are many more parameters that can or should be specified, but we will look at that later.</p>
<p><code>n.iter</code> specifies the length of the <a href="https://en.wikipedia.org/wiki/Markov_chain">Markov Chain</a> does, i.e., the number of draws from the posterior distribution of the parameter or unobserved value.</p>
<p>How many iterations are necessary depends on the data and complexity of the model and can vary from as few as 100 up to thousands or millions.</p>
<p>One important criterion is that the Markov chains need to have converged. This can be evaluated visually with a traceplot.</p>
</div>
<div id="traceplot" class="section level2">
<h2 class="hasAnchor">
<a href="#traceplot" class="anchor"></a>Traceplot</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/traceplot.html">traceplot</a></span>(lm1)</a></code></pre></div>
<p><img src="BasicExample_files/figure-html/results_lm1-1.png" width="100%"></p>
<p>The function <code><a href="../reference/traceplot.html">traceplot()</a></code> produces a plot of the sampled values accross iterations per parameter. By default, three Markov chains are produced for each parameter and represented by different colors.</p>
<p>When the sampler has converged the chains show a horizontal band, as in the above figure. Consequently, when traces show a trend, convergence has not been reached and more iterations are necessary (e.g., using <a href="https://nerler.github.io/JointAI/reference/add_samples.html"><code><a href="../reference/add_samples.html">add_samples()</a></code></a>).</p>
<p>When convergence has been achieved, we can obtain the result of the model from the model summary.</p>
</div>
<div id="model-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#model-summary" class="anchor"></a>Model Summary</h2>
<p>Results from a JointAI model can be printed using</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">summary</span>(lm1)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;  Linear model fitted with JointAI </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; lm_imp(formula = SBP ~ gender + age + race + WC + alc + educ + </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;     creat + albu + uricacid + bili, data = NHANES, n.iter = 500)</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; Posterior summary:</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;                             Mean      SD     2.5%     97.5% tail-prob.</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; (Intercept)             69.44642 28.3877  14.2538 125.39691    0.02000</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; genderfemale            -7.03794  3.7134 -14.2137   0.07791    0.05467</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; age                      0.64988  0.1103   0.4354   0.86909    0.00000</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; raceOther Hispanic       1.40109  5.0691  -8.4313  11.66475    0.77867</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; raceNon-Hispanic White   1.40650  4.1988  -6.8996   9.53595    0.75600</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; raceNon-Hispanic Black  11.38504  4.4989   2.3429  19.86364    0.01200</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; raceother                7.71054  5.0370  -2.2305  17.00706    0.12933</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; educhigh                -2.04213  2.7823  -7.4565   3.60248    0.45467</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; WC                       0.09894  0.1035  -0.1063   0.29433    0.32667</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; creat                  -12.27988  7.7976 -27.0383   3.46660    0.11867</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; albu                     5.66832  5.1312  -4.2948  16.00883    0.28667</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; uricacid                 0.89445  1.4840  -2.0648   3.71807    0.55067</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; bili                     1.76952  6.4866 -11.2023  14.75868    0.78000</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; alc&gt;=1                   2.25020  3.1667  -3.9776   8.37425    0.50267</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; Posterior summary of residual std. deviation:</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt;            Mean     SD  2.5% 97.5%</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; sigma_SBP 18.05 0.9781 16.22 20.06</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; MCMC settings:</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; Iterations = 101:600</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; Sample size per chain = 500 </span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; Thinning interval = 1 </span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; Number of chains = 3 </span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; Number of observations: 198</span></a></code></pre></div>
<p>The output gives the posterior summary, i.e., the summary of the MCMC (<a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov Chain Monte Carlo</a>) sample (which consists of all Markov chains combined.</p>
<p>By default, <code>summary()</code> will only print the posterior summary for the main model parameters of the analysis model.</p>
<p>This summary consists of the posterior mean, the standard deviation and the 2.5% and 97.5% quantiles of the MCMC sample, and the tail probability. The tail probability is a measure of how likely the value 0 is under the estimated posterior distribution, and is calculated as <span class="math display">\[2\times\min\left\{Pr(\theta &gt; 0), Pr(\theta &lt; 0)\right\}\]</span> (where <span class="math inline">\(\theta\)</span> is the parameter of interest).</p>
<p>In the following graphics, the shaded areas represent the minimum of <span class="math inline">\(Pr(\theta &gt; 0)\)</span> and <span class="math inline">\(Pr(\theta &lt; 0)\)</span>: <img src="BasicExample_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<p>Additionally, some important characteristics of the MCMC samples on which the summary is based, is given. This includes the range and number of iterations (= <code>Sample size per chain</code>), thinning interval and number of chains.</p>
<p>Furthermore, the number of observations (the sample size of the data) is given.</p>
<p>With the arguments <code>start</code>, <code>end</code> and <code>thin</code> it is possible to select which iterations from the MCMC sample are included in the summary.</p>
<p>For example: When the traceplot shows that the chains only converged after 1500 iterations, <code>start = 1500</code> should be specified in <code>summary()</code>.</p>
</div>
<div id="plot-of-the-posterior-distributions" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-of-the-posterior-distributions" class="anchor"></a>Plot of the posterior distributions</h2>
<p>The posterior distributions can be visualized using the function <code><a href="../reference/densplot.html">densplot()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/densplot.html">densplot</a></span>(lm1)</a></code></pre></div>
<p><img src="BasicExample_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>By default, <code><a href="../reference/densplot.html">densplot()</a></code> plots the empirical distribution of each of the chains separately. When <code>joined = TRUE</code> the distributions of the combined chains are plotted.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/densplot.html">densplot</a></span>(lm1, <span class="dt">joined =</span> T)</a></code></pre></div>
<p><img src="BasicExample_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#fitting-a-linear-regression-model">Fitting a linear regression model</a></li>
      <li><a href="#traceplot">Traceplot</a></li>
      <li><a href="#model-summary">Model Summary</a></li>
      <li><a href="#plot-of-the-posterior-distributions">Plot of the posterior distributions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>

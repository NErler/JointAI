<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parameter Selection • JointAI</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Parameter Selection">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JointAI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AfterFitting.html">After Fitting</a>
    </li>
    <li>
      <a href="../articles/MCMCsettings.html">MCMC Settings</a>
    </li>
    <li>
      <a href="../articles/MinimalExample.html">Minimal Example</a>
    </li>
    <li>
      <a href="../articles/ModelSpecification.html">Model Specification</a>
    </li>
    <li>
      <a href="../articles/SelectingParameters.html">Parameter Selection</a>
    </li>
    <li>
      <a href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nerler/JointAI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/N_Erler">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Parameter Selection</h1>
            <h3 class="subtitle">How to specify which parameters to monitor and display in the results.</h3>
                        <h4 class="author">Nicole Erler</h4>
            
            <h4 class="date">2018-12-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/master/vignettes/SelectingParameters.Rmd"><code>vignettes/SelectingParameters.Rmd</code></a></small>
      <div class="hidden name"><code>SelectingParameters.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we use the <a href="https://nerler.github.io/JointAI/reference/NHANES.html">NHANES</a> data for examples in cross-sectional data and the dataset <a href="https://nerler.github.io/JointAI/reference/simLong.html">simLong</a> for examples in longitudinal data. For more info on these datasets, check out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html"><em>Visualizing Incomplete Data</em></a>, in which the distribution of variables and missing values in both sets is explored.</p>
<p><strong>Note:</strong><br> In many of the examples we use <code>n.adapt = 0</code> (and <code>n.iter = 0</code>, which is the default) in order to prevent the MCMC sampling to reduce computational some time. <code>mess = FALSE</code> is used to suppress messages that are not of interest in this vignette. <code>progress.bar = 'none'</code> prevents printing of the progress of the MCMC sampling, which results in lengthy output in the vignette, but is useful in practice.</p>
<div id="monitoring-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#monitoring-parameters" class="anchor"></a>Monitoring parameters</h2>
<p><strong>JointAI</strong> uses <a href="http://mcmc-jags.sourceforge.net/">JAGS</a> for performing the MCMC (<a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov Chain Monte Carlo</a>) sampling. Since JAGS only saves the values of MCMC chains for those parameters/variables for which the user has specified that they should be monitored, this is also the case in <strong>JointAI</strong>.</p>
<p>For this purpose, <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">lm_imp()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">glm_imp()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">lme_imp()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">glme_imp()</a></code></a> and <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code><a href="../reference/model_imp.html">survreg_imp()</a></code></a> have an argument <code>monitor_params</code>.</p>
<p><code>monitor_params</code> takes a named list (often a named vector also works) with the following possible entries:</p>
<table class="table">
<thead><tr class="header">
<th align="left">name/key word</th>
<th align="left">what is monitored</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>analysis_main</code></td>
<td align="left">
<code>betas</code>, <code>tau_y</code> and <code>sigma_y</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>analysis_random</code></td>
<td align="left">
<code>ranef</code>, <code>D</code>, <code>invD</code>, <code>RinvD</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>imp_pars</code></td>
<td align="left">
<code>alphas</code>, <code>tau_imp</code>, <code>gamma_imp</code>, <code>delta_imp</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>imps</code></td>
<td align="left">imputed values</td>
</tr>
<tr class="odd">
<td align="left"><code>betas</code></td>
<td align="left">regression coefficients of the analysis model</td>
</tr>
<tr class="even">
<td align="left"><code>tau_y</code></td>
<td align="left">precision of the residuals from the analysis model</td>
</tr>
<tr class="odd">
<td align="left"><code>sigma_y</code></td>
<td align="left">standard deviation of the residuals from the analysis model</td>
</tr>
<tr class="even">
<td align="left"><code>ranef</code></td>
<td align="left">random effects</td>
</tr>
<tr class="odd">
<td align="left"><code>D</code></td>
<td align="left">covariance matrix of the random effects</td>
</tr>
<tr class="even">
<td align="left"><code>invD</code></td>
<td align="left">inverse of <code>D</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>RinvD</code></td>
<td align="left">scale matrix in Wishart prior for <code>invD</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>alphas</code></td>
<td align="left">regression coefficients in the imputation models</td>
</tr>
<tr class="odd">
<td align="left"><code>tau_imp</code></td>
<td align="left">precision parameters of the residuals from imputation models</td>
</tr>
<tr class="even">
<td align="left"><code>gamma_imp</code></td>
<td align="left">intercepts in ordinal imputation models</td>
</tr>
<tr class="odd">
<td align="left"><code>delta_imp</code></td>
<td align="left">increments of ordinal intercepts</td>
</tr>
<tr class="even">
<td align="left"><code>other</code></td>
<td align="left">additional parameters</td>
</tr>
</tbody>
</table>
<p>Each of the key words works as a switch.</p>
<div id="parameters-of-the-analysis-model" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters-of-the-analysis-model" class="anchor"></a>Parameters of the analysis model</h3>
<p>The default setting is <code>monitor_params = c(analysis_main = TRUE)</code>, i.e., only the main parameters of the analysis model are monitored, and monitoring is switched off for all other parameters.</p>
<p>The main parameters are the regression coefficients of the analysis model (<code>beta</code>) and the residual standard deviation (<code>sigma_y</code>, and precision <code>tau_y</code>).</p>
<p>The function <a href="https://nerler.github.io/JointAI/reference/parameters.html"><code><a href="../reference/parameters.html">parameters()</a></code></a> returns the parameters that are specified to be followed (even for models where no MCMC sampling was performed, i.e. when <code>n.iter = 0</code> and <code>n.adapt = 0</code>).</p>
<p>For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">lm1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>creat, <span class="dt">data =</span> NHANES, </a>
<a class="sourceLine" id="cb1-2" data-line-number="2">              <span class="dt">n.adpat =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lm1, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; [1] "(Intercept)"  "genderfemale" "WC"           "creat"       </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; [5] "alc&gt;=1"       "sigma_SBP"</span></a></code></pre></div>
</div>
<div id="imputed-values-parameters-of-the-imputation-models" class="section level3">
<h3 class="hasAnchor">
<a href="#imputed-values-parameters-of-the-imputation-models" class="anchor"></a>Imputed values &amp; parameters of the imputation models</h3>
<p>To generate (multiple) imputed datasets that can be used for further analyses, the imputed values need to be monitored. This can be done by setting <code>monitor_params = c(imps = TRUE)</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">lm2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>occup,</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">              <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">              <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">imps =</span> <span class="ot">TRUE</span>, <span class="dt">analysis_main =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lm2, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  [1] "Xc[33,3]"    "Xc[150,3]"   "Xc[1,8]"     "Xc[7,8]"     "Xc[8,8]"    </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  [6] "Xc[12,8]"    "Xc[13,8]"    "Xc[21,8]"    "Xc[22,8]"    "Xc[31,8]"   </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; [11] "Xc[33,8]"    "Xc[34,8]"    "Xc[39,8]"    "Xc[49,8]"    "Xc[66,8]"   </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; [16] "Xc[67,8]"    "Xc[80,8]"    "Xc[86,8]"    "Xc[91,8]"    "Xc[92,8]"   </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [21] "Xc[105,8]"   "Xc[111,8]"   "Xc[115,8]"   "Xc[118,8]"   "Xc[120,8]"  </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [26] "Xc[127,8]"   "Xc[132,8]"   "Xc[139,8]"   "Xc[146,8]"   "Xc[149,8]"  </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; [31] "Xc[152,8]"   "Xc[163,8]"   "Xc[165,8]"   "Xc[169,8]"   "Xc[180,8]"  </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; [36] "Xc[185,8]"   "Xcat[6,1]"   "Xcat[16,1]"  "Xcat[24,1]"  "Xcat[27,1]" </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; [41] "Xcat[45,1]"  "Xcat[57,1]"  "Xcat[58,1]"  "Xcat[60,1]"  "Xcat[61,1]" </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; [46] "Xcat[65,1]"  "Xcat[66,1]"  "Xcat[70,1]"  "Xcat[80,1]"  "Xcat[81,1]" </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; [51] "Xcat[85,1]"  "Xcat[88,1]"  "Xcat[89,1]"  "Xcat[90,1]"  "Xcat[101,1]"</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; [56] "Xcat[104,1]" "Xcat[116,1]" "Xcat[133,1]" "Xcat[137,1]" "Xcat[143,1]"</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; [61] "Xcat[168,1]" "Xcat[170,1]" "Xcat[180,1]" "Xcat[186,1]" "Xcat[16,2]" </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; [66] "Xcat[99,2]"  "Xcat[123,2]" "Xcat[156,2]" "Xcat[158,2]" "Xcat[166,2]"</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; [71] "Xcat[172,2]"</span></a></code></pre></div>
<p><strong>JointAI</strong> uses a number of different design matrices to store different types of variables. The matrix <code>Xc</code> is the design matrix of cross-sectional covariates. For categorical incomplete variables (with more than 2 categories) the original variable is stored in the matrix <code>Xcat</code> and <code>Xc</code> contains the corresponding dummy coded variables. Hence, the imputed values of continuous and binary variables are elements of <code>Xc</code> and imputed values of categorical variables are elements of <code>Xcat</code>.</p>
<p>The parameters of the models for the incomplete variables can be selected with <code>monitor_params = c(imp_pars = TRUE)</code>. This will set monitors for the regression coefficients (<code>alpha</code>) and other parameters, such as precision (<code>tau_*</code>) and intercepts &amp; increments (<code>gamma_*</code> and <code>delta_*</code>) in cumulative logit models.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">lm3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>occup,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">              <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">              <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">imp_pars =</span> <span class="ot">TRUE</span>, <span class="dt">analysis_main =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lm3, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; [1] "alpha"       "tau_WC"      "gamma_smoke" "delta_smoke"</span></a></code></pre></div>
<div id="side-note-getting-information-about-of-the-imputation-models" class="section level4">
<h4 class="hasAnchor">
<a href="#side-note-getting-information-about-of-the-imputation-models" class="anchor"></a>Side note: Getting information about of the imputation models</h4>
<p>An overview of the imputation models used, including the names of the parameters and the hyperparameters can be obtained with</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/list_impmodels.html">list_impmodels</a></span>(lm2)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Normal imputation model for 'WC'</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;   (Intercept), age</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; * Regression coefficients: </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;   alpha[1:2] (normal prior(s) with mean 0 and precision 1e-04)</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; * Pecision of 'WC':</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;   tau_WC (Gamma prior with scale parameter 0.01 and rate parameter 0.01)</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; Cumulative logit imputation model for 'smoke'</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; * Reference category: 'never'</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;   age, WC</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; * Regression coefficients (without intercept): </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;   alpha[3:4] (normal prior(s) with mean 0 and precision 0.001)</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; * Intercepts:</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;   - never: gamma_smoke[1] (normal prior with mean 0 and precision 0.001)</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;   - former: gamma_smoke[2] = gamma_smoke[1] + exp(delta_smoke[1])</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; * Increments:</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;   delta_smoke[1] (normal prior(s) with mean 0 and precision 0.001)</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; Multinomial logit imputation model for 'occup'</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; * Reference category: 'working'</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;   (Intercept), age, WC, smokeformer, smokecurrent</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; * Regression coefficients: </span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt;   - 'occuplooking for work': alpha[5:9] (normal prior(s) with mean 0 and precision 0.001)</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;   - 'occupnot working': alpha[10:14] (normal prior(s) with mean 0 and precision 0.001)</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; Logistic imputation model for 'alc'</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; * Reference category: '&lt;1'</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; * Predictor variables: </span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;   (Intercept), age, WC, smokeformer, smokecurrent, occuplooking for work, occupnot working</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt; * Regression coefficients: </span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt;   alpha[15:21] (normal prior(s) with mean 0 and precision 0.001)</span></a></code></pre></div>
</div>
<div id="side-note-how-to-extract-imputed-datasets" class="section level4">
<h4 class="hasAnchor">
<a href="#side-note-how-to-extract-imputed-datasets" class="anchor"></a>Side note: How to extract imputed datasets</h4>
<p>Imputed datasets can be extracted and exported with the function <a href="https://nerler.github.io/JointAI/reference/get_MIdat.html"><code><a href="../reference/get_MIdat.html">get_MIdat()</a></code></a>. A completed dataset is created by taking the imputed values from a randomly chosen iteration of the MCMC sample (transforming them back to the original scale, if scaling had been performed during the MCMC sampling) and filling them into the original, incomplete data.</p>
<p><code><a href="../reference/get_MIdat.html">get_MIdat()</a></code> returns a long-format <code>data.frame</code> containing the imputed datasets (and possibly the original data) stacked onto each other. The imputation number is given in the variable <code>Imputation_</code>, column <code>.id</code> contains a newly created id variable for each observation in cross-sectional data (multi-level data should already contain an id variable).</p>
<p><code><a href="../reference/get_MIdat.html">get_MIdat()</a></code> takes the arguments:</p>
<table class="table">
<thead><tr class="header">
<th align="left">argument</th>
<th align="left">explanation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>object</code></td>
<td align="left">a JointAI object</td>
</tr>
<tr class="even">
<td align="left"><code>m</code></td>
<td align="left">number of datasets to be created</td>
</tr>
<tr class="odd">
<td align="left"><code>include</code></td>
<td align="left">logical; should the original data be included?</td>
</tr>
<tr class="even">
<td align="left"><code>start</code></td>
<td align="left">the first iteration that may be randomly chosen (i.e., all previous iterations are discarded as burn-in)</td>
</tr>
<tr class="odd">
<td align="left"><code>minspace</code></td>
<td align="left">minimum number of iterations between iterations chosen as imputed values</td>
</tr>
<tr class="even">
<td align="left"><code>seed</code></td>
<td align="left">optional seed value in order to make the random selection</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">of iterations reproducible</td>
</tr>
<tr class="even">
<td align="left"><code>export_to_SPSS</code></td>
<td align="left">logical; should the datasets be exported to SPSS, i.e., written as .txt and .sps file? If <code>export_to_SPSS = FALSE</code> (default) the imputed data is only returned <code>data.frame</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code>resdir</code></td>
<td align="left">directory the files are exported to</td>
</tr>
<tr class="even">
<td align="left"><code>filename</code></td>
<td align="left">the name of the .txt and .sps files</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="random-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#random-effects" class="anchor"></a>Random effects</h3>
<p>For mixed models, <code>analysis_main</code> also includes the random effects covariance matrix <code>D</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">lme1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>EDUC, <span class="dt">random =</span> <span class="op">~</span>age <span class="op">|</span><span class="st"> </span>ID, </a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                <span class="dt">data =</span> simLong, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lme1, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [1] "(Intercept)" "EDUCmid"     "EDUClow"     "age"         "sigma_bmi"  </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; [6] "D[1,1]"      "D[1,2]"      "D[2,2]"</span></a></code></pre></div>
<p>Setting <code>analysis_random = TRUE</code> will switch on monitoring for the random effects (<code>ranef</code>), random effects covariance matrix (<code>D</code>), inverse of the random effects covariance matrix (<code>invD</code>) and the diagonal of the scale matrix of the Wishart-prior of <code>invD</code> (<code>RinvD</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">lme2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>EDUC, <span class="dt">random =</span> <span class="op">~</span>age <span class="op">|</span><span class="st"> </span>ID,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                <span class="dt">data =</span> simLong, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">analysis_random =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lme2, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;  [1] "(Intercept)" "EDUCmid"     "EDUClow"     "age"         "sigma_bmi"  </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  [6] "b"           "invD[1,1]"   "invD[1,2]"   "invD[2,2]"   "D[1,1]"     </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; [11] "D[1,2]"      "D[2,2]"      "RinvD[1,1]"  "RinvD[2,2]"</span></a></code></pre></div>
<p>It is possible to select only a subset of the random effects parameters by specifying them directly, e.g.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">lme3a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>EDUC, <span class="dt">random =</span> <span class="op">~</span>age <span class="op">|</span><span class="st"> </span>ID,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                <span class="dt">data =</span> simLong, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">analysis_main =</span> <span class="ot">TRUE</span>, <span class="dt">RinvD =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lme3a, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  [1] "(Intercept)" "EDUCmid"     "EDUClow"     "age"         "sigma_bmi"  </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  [6] "D[1,1]"      "D[1,2]"      "D[2,2]"      "RinvD[1,1]"  "RinvD[2,2]"</span></a></code></pre></div>
<p>or by switching unwanted parts of <code>analysis_random</code> off, e.g.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">lme3b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>EDUC, <span class="dt">random =</span> <span class="op">~</span>age <span class="op">|</span><span class="st"> </span>ID,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                <span class="dt">data =</span> simLong, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">analysis_main =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                                   <span class="dt">analysis_random =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                                   <span class="dt">RinvD =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                                   <span class="dt">ranef =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lme3b, <span class="dt">mess =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;  [1] "(Intercept)" "EDUCmid"     "EDUClow"     "age"         "sigma_bmi"  </span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;  [6] "invD[1,1]"   "invD[1,2]"   "invD[2,2]"   "D[1,1]"      "D[1,2]"     </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; [11] "D[2,2]"</span></a></code></pre></div>
</div>
<div id="other-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#other-parameters" class="anchor"></a>Other parameters</h3>
<p>The element <code>other</code> in <code>monitor_params</code> allows to specify one or multiple parameters additional parameters to be monitored. When <code>other</code> is used with more than one element, <code>monitor_params</code> has to be a list.</p>
<p>Here, we monitor the probability to be in the <code>alc&gt;=1</code> group for subjects 1 through 3 and the expected value of the distribution of <code>creat</code> for the first subject.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">lm4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>creat,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">              <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">0</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">              <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">analysis_main =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                                    <span class="dt">other =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'p_alc[1:3]'</span>, <span class="st">"mu_creat[1]"</span>)))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lm4)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; 'lm4' does not contain MCMC samples.</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; [1] "p_alc[1:3]"  "mu_creat[1]"</span></a></code></pre></div>
</div>
</div>
<div id="subsets-of-parameters-for-plots-summaries-etc-" class="section level2">
<h2 class="hasAnchor">
<a href="#subsets-of-parameters-for-plots-summaries-etc-" class="anchor"></a>Subsets of Parameters for Plots, Summaries, etc.</h2>
<p>The functions <a href="https://nerler.github.io/JointAI/reference/summary.JointAI.html"><code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/traceplot.html"><code><a href="../reference/traceplot.html">traceplot()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/densplot.html"><code><a href="../reference/densplot.html">densplot()</a></code></a>, <a href="https://nerler.github.io/JointAI/reference/GR_crit.html"><code><a href="../reference/GR_crit.html">GR_crit()</a></code></a> and <a href="https://nerler.github.io/JointAI/reference/MC_error.html"><code><a href="../reference/MC_error.html">MC_error()</a></code></a> all have an argument <code>subset</code>. This argument allows to select a subset of parameters to be shown in the output. Especially when not only the parameters of the main analysis model are followed, but also, for example, imputed values, looking at a subset may be desirable.</p>
<p><code>subset</code> follows the same logic as <code>monitor_params</code> described above.</p>
<p>By default, only the parameters of the main analysis model are displayed if they were monitored:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Run a model monitoring analysis parameters and imputation parameters</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">lm5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>creat,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">              <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">              <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">imp_pars =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># model summary</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(lm5)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;  Linear model fitted with JointAI </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES, </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;     n.iter = 100, monitor_params = c(imp_pars = TRUE), progress.bar = "none", </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;     mess = FALSE)</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; Posterior summary:</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt;                Mean      SD   2.5%   97.5% tail-prob. GR-crit</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; (Intercept)  81.859 10.4860 60.923 102.662     0.0000    1.01</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; genderfemale  0.229  2.5529 -4.727   5.223     0.8733    1.00</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; WC            0.307  0.0821  0.144   0.461     0.0000    1.00</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; creat         6.863  7.8722 -8.479  22.854     0.3733    1.04</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; alc&gt;=1        6.220  2.2881  1.933  10.786     0.0133    1.01</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; Posterior summary of residual std. deviation:</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt;           Mean    SD 2.5% 97.5% GR-crit</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; sigma_SBP 14.3 0.708 13.1  15.9    1.04</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; MCMC settings:</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; Iterations = 101:200</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; Sample size per chain = 100 </span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; Thinning interval = 1 </span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; Number of chains = 3 </span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; Number of observations: 186</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co"># traceplot of the MCMC sample</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="kw"><a href="../reference/traceplot.html">traceplot</a></span>(lm5)</a></code></pre></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co"># density plot of the MCMC sample</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw"><a href="../reference/densplot.html">densplot</a></span>(lm5)</a></code></pre></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># Gelman-Rubin criterion</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="../reference/GR_crit.html">GR_crit</a></span>(lm5)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; Potential scale reduction factors:</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt;              Point est. Upper C.I.</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; (Intercept)       1.002       1.01</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; genderfemale      0.999       1.00</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; WC                1.000       1.00</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; creat             1.007       1.04</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; alc&gt;=1            1.010       1.01</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; sigma_SBP         1.009       1.04</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; Multivariate psrf</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; 1.01</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co"># Monte Carlo Error of the MCMC sample</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="kw"><a href="../reference/MC_error.html">MC_error</a></span>(lm5)</a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt;                 est    MCSE      SD MCSE/SD</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; (Intercept)  46.043 3.59394 46.0449   0.078</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; genderfemale  0.229 0.13110  2.5529   0.051</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; WC            0.021 0.00028  0.0056   0.049</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; creat        40.088 3.39171 45.9834   0.074</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; alc&gt;=1        6.220 0.16404  2.2881   0.072</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; sigma_SBP    14.344 0.04362  0.7083   0.062</span></a></code></pre></div>
<p>When <code>analysis_main</code> was not switched on, all parameters are displayed by default:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Re-run the model from above, now creating MCMC samples</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">lm4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>creat,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">              <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,  <span class="dt">progress.bar =</span> <span class="st">'none'</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">              <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">analysis_main =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                                    <span class="dt">other =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'p_alc[1:3]'</span>, <span class="st">"mu_creat[1]"</span>)))</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw"><a href="../reference/traceplot.html">traceplot</a></span>(lm4, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<div id="select-a-subset-of-the-variables-to-display" class="section level3">
<h3 class="hasAnchor">
<a href="#select-a-subset-of-the-variables-to-display" class="anchor"></a>Select a subset of the variables to display</h3>
<p>To display other parts of the MCMC sample, <code>subset</code> needs to be specified:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># we use lm5 from above</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="../reference/GR_crit.html">GR_crit</a></span>(lm5, <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">analysis_main =</span> <span class="ot">FALSE</span>, <span class="dt">imp_pars =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; Potential scale reduction factors:</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt;           Point est. Upper C.I.</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; alpha[1]       1.019       1.06</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; alpha[2]       1.014       1.06</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; alpha[3]       1.022       1.05</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; alpha[4]       1.035       1.11</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; alpha[5]       0.999       1.00</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; alpha[6]       1.017       1.06</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; alpha[7]       1.044       1.14</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; alpha[8]       1.010       1.05</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; alpha[9]       1.036       1.11</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; tau_WC         1.006       1.03</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; tau_creat      1.015       1.05</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; Multivariate psrf</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; 1.06</span></a></code></pre></div>
<p>To select only some of the parameters, they can be specified directly by name via the <code>other</code> element of <code>subset</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(lm5, <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">other =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'creat'</span>, <span class="st">'alc&gt;=1'</span>)))</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt;  Linear model fitted with JointAI </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; lm_imp(formula = SBP ~ gender + WC + alc + creat, data = NHANES, </span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt;     n.iter = 100, monitor_params = c(imp_pars = TRUE), progress.bar = "none", </span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt;     mess = FALSE)</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; Posterior summary:</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt;        Mean   SD  2.5% 97.5% tail-prob. GR-crit</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; creat  6.86 7.87 -8.48  22.9     0.3733    1.04</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; alc&gt;=1 6.22 2.29  1.93  10.8     0.0133    1.01</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt; MCMC settings:</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt; Iterations = 101:200</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#&gt; Sample size per chain = 100 </span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">#&gt; Thinning interval = 1 </span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">#&gt; Number of chains = 3 </span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt; Number of observations: 186</span></a></code></pre></div>
<p>This also works when a subset of the imputed values should be displayed:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Re-run the model from above, now creating MCMC samples</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">lm2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lm_imp</a></span>(SBP <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>WC <span class="op">+</span><span class="st"> </span>alc <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>occup,</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">              <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>,  <span class="dt">progress.bar =</span> <span class="st">'none'</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">              <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">imps =</span> <span class="ot">TRUE</span>, <span class="dt">analysis_main =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># select only imputed values for 'WC' (3rd column of Xc)</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">sub3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep</a></span>(<span class="st">'Xc</span><span class="ch">\\</span><span class="st">[[[:digit:]]+,3</span><span class="ch">\\</span><span class="st">]'</span>, <span class="kw"><a href="../reference/parameters.html">parameters</a></span>(lm2), <span class="dt">value =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">sub3</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; [1] "Xc[33,3]"  "Xc[150,3]"</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="kw"><a href="../reference/traceplot.html">traceplot</a></span>(lm2, <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">other =</span> sub3), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="SelectingParameters_files/figure-html/lm2_2-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="random-subset-of-subject-specific-values" class="section level3">
<h3 class="hasAnchor">
<a href="#random-subset-of-subject-specific-values" class="anchor"></a>Random subset of subject-specific values</h3>
<p>When the number of imputed values is larger, or in order to check convergence of random effects, it may not be feasible to plot all traceplots. In that case, a random subset of, for instance the random effects, can be selected:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">lme4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_imp.html">lme_imp</a></span>(bmi <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>EDUC, <span class="dt">random =</span> <span class="op">~</span>age<span class="op">|</span>ID,</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">                <span class="dt">data =</span> simLong, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">mess =</span> <span class="ot">FALSE</span>, <span class="dt">progress.bar =</span> <span class="st">'none'</span>,</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                <span class="dt">monitor_params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">analysis_main =</span> <span class="ot">FALSE</span>, <span class="dt">ranef =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co"># exract random intercepts</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">ri &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep</a></span>(<span class="st">'^b</span><span class="ch">\\</span><span class="st">[[[:digit:]]+,1</span><span class="ch">\\</span><span class="st">]$'</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(lme4<span class="op">$</span>MCMC[[<span class="dv">1</span>]]), <span class="dt">value =</span> T)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co"># extract random slopes</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">rs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep</a></span>(<span class="st">'^b</span><span class="ch">\\</span><span class="st">[[[:digit:]]+,2</span><span class="ch">\\</span><span class="st">]$'</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(lme4<span class="op">$</span>MCMC[[<span class="dv">1</span>]]), <span class="dt">value =</span> T)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co"># plot the chains of 8 randomly selected random intercepts</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="kw"><a href="../reference/traceplot.html">traceplot</a></span>(lme4, <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">other =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(ri, <span class="dt">size =</span> <span class="dv">8</span>)), <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co"># plot the chains of 8 randomly selected random slopes</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="kw"><a href="../reference/traceplot.html">traceplot</a></span>(lme4, <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">other =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(rs, <span class="dt">size =</span> <span class="dv">8</span>)), <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="SelectingParameters_files/figure-html/unnamed-chunk-10-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#monitoring-parameters">Monitoring parameters</a></li>
      <li><a href="#subsets-of-parameters-for-plots-summaries-etc-">Subsets of Parameters for Plots, Summaries, etc.</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '0d21d69e7c3eb00e029f5b8d9424cd56',
    indexName: 'jointal',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>

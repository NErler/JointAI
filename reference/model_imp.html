<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Joint Analysis and Imputation of incomplete data — model_imp • JointAI</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Joint Analysis and Imputation of incomplete data — model_imp"><meta property="og:description" content="Main analysis functions to estimate different types of models using MCMC
sampling, while imputing missing values."><meta property="og:image" content="https://nerler.github.io/JointAI/reference/figures/JointAI_191.png"><meta property="og:image:alt" content="JointAI: An R package for Joint Analysis and Imputation"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@N_Erler"><meta name="twitter:site" content="@N_Erler"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-127879026-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-127879026-4');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JointAI</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/AfterFitting.html">After Fitting</a>
    </li>
    <li>
      <a href="../articles/MCMCsettings.html">MCMC Settings</a>
    </li>
    <li>
      <a href="../articles/MinimalExample.html">Minimal Example</a>
    </li>
    <li>
      <a href="../articles/ModelSpecification.html">Model Specification</a>
    </li>
    <li>
      <a href="../articles/SelectingParameters.html">Parameter Selection</a>
    </li>
    <li>
      <a href="../articles/TheoreticalBackground.html">Theoretical Background</a>
    </li>
    <li>
      <a href="../articles/VisualizingIncompleteData.html">Visualizing Incomplete Data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nerler/JointAI/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/N_Erler" class="external-link">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Joint Analysis and Imputation of incomplete data</h1>
    <small class="dont-index">Source: <a href="https://github.com/nerler/JointAI/blob/HEAD/R/model_imp.R" class="external-link"><code>R/model_imp.R</code></a></small>
    <div class="hidden name"><code>model_imp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Main analysis functions to estimate different types of models using MCMC
sampling, while imputing missing values.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">lm_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>,
  ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span><span class="op">)</span>

<span class="fu">glm_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>,
  ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span><span class="op">)</span>

<span class="fu">clm_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, nonprop <span class="op">=</span> <span class="cn">NULL</span>, rev <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">lognorm_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>,
  ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span><span class="op">)</span>

<span class="fu">betareg_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>,
  ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span><span class="op">)</span>

<span class="fu">mlogit_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>,
  ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span><span class="op">)</span>

<span class="fu">lme_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">data</span>, <span class="va">random</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">lmer_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">data</span>, <span class="va">random</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">glme_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">data</span>, <span class="va">random</span>, <span class="va">family</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  auxvars <span class="op">=</span> <span class="cn">NULL</span>, refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">glmer_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">data</span>, <span class="va">random</span>, <span class="va">family</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  auxvars <span class="op">=</span> <span class="cn">NULL</span>, refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">betamm_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">random</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">lognormmm_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">random</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  auxvars <span class="op">=</span> <span class="cn">NULL</span>, refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">clmm_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">data</span>, <span class="va">random</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, nonprop <span class="op">=</span> <span class="cn">NULL</span>, rev <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>,
  models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>,
  seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">mlogitmm_imp</span><span class="op">(</span><span class="va">fixed</span>, <span class="va">data</span>, <span class="va">random</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  auxvars <span class="op">=</span> <span class="cn">NULL</span>, refcats <span class="op">=</span> <span class="cn">NULL</span>, rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>,
  no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">survreg_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>, n.iter <span class="op">=</span> <span class="fl">0</span>,
  thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, auxvars <span class="op">=</span> <span class="cn">NULL</span>,
  refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>,
  ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span><span class="op">)</span>

<span class="fu">coxph_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, df_basehaz <span class="op">=</span> <span class="fl">6</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  auxvars <span class="op">=</span> <span class="cn">NULL</span>, refcats <span class="op">=</span> <span class="cn">NULL</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>,
  shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, inits <span class="op">=</span> <span class="cn">NULL</span>,
  warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">JM_imp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, df_basehaz <span class="op">=</span> <span class="fl">6</span>, n.chains <span class="op">=</span> <span class="fl">3</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, monitor_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>analysis_main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  auxvars <span class="op">=</span> <span class="cn">NULL</span>, timevar <span class="op">=</span> <span class="cn">NULL</span>, refcats <span class="op">=</span> <span class="cn">NULL</span>,
  rd_vcov <span class="op">=</span> <span class="st">"blockdiag"</span>, models <span class="op">=</span> <span class="cn">NULL</span>, no_model <span class="op">=</span> <span class="cn">NULL</span>,
  assoc_type <span class="op">=</span> <span class="cn">NULL</span>, shrinkage <span class="op">=</span> <span class="cn">FALSE</span>, ppc <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,
  inits <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, mess <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>a two sided model formula (see <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>)
or a list of such formulas; (more details below).</p></dd>
<dt>data</dt>
<dd><p>a <code>data.frame</code> containing the original data
(more details below)</p></dd>
<dt>n.chains</dt>
<dd><p>number of MCMC chains</p></dd>
<dt>n.adapt</dt>
<dd><p>number of iterations for adaptation of the MCMC samplers
(see <code><a href="https://rdrr.io/pkg/rjags/man/adapt.html" class="external-link">adapt</a></code>)</p></dd>
<dt>n.iter</dt>
<dd><p>number of iterations of the MCMC chain (after adaptation;
see <code><a href="https://rdrr.io/pkg/rjags/man/coda.samples.html" class="external-link">coda.samples</a></code>)</p></dd>
<dt>thin</dt>
<dd><p>thinning interval (integer; see <code><a href="https://rdrr.io/pkg/coda/man/window.mcmc.html" class="external-link">window.mcmc</a></code>).
For example, <code>thin = 1</code> (default) will keep the MCMC samples
from all iterations; <code>thin = 5</code> would only keep every 5th
iteration.</p></dd>
<dt>monitor_params</dt>
<dd><p>named list or vector specifying which parameters
should be monitored (more details below)</p></dd>
<dt>auxvars</dt>
<dd><p>optional; one-sided formula of variables that should be used
as predictors in the imputation procedure (and will be imputed
if necessary) but are not part of the analysis model(s).
For more details with regards to the behaviour with
non-linear effects see the vignette on
<a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html#auxvars">Model Specification</a></p></dd>
<dt>refcats</dt>
<dd><p>optional; either one of <code>"first"</code>, <code>"last"</code>,
<code>"largest"</code> (which sets the category for all categorical
variables) or a named list specifying which category should
be used as reference category per categorical variable.
Options are the category label, the category number,
or one of "first" (the first category),
"last" (the last category) or "largest" (chooses the category
with the most observations).
Default is "first". If reference categories are specified for
a subset of the categorical variables the default will be
used for the remaining variables.
(See also <code><a href="set_refcat.html">set_refcat</a></code>)</p></dd>
<dt>models</dt>
<dd><p>optional; named vector specifying the types of models for
(incomplete) covariates.
This arguments replaces the argument <code>meth</code> used in
earlier versions.
If <code>NULL</code> (default) models will be determined
automatically based on the class of the respective columns of
<code>data</code>.</p></dd>
<dt>no_model</dt>
<dd><p>optional; vector of names of variables for which no model
should be specified.
Note that this is only possible for completely observed
variables and implies the assumptions of independence between
the excluded variable and the incomplete variables.</p></dd>
<dt>shrinkage</dt>
<dd><p>optional; either a character string naming the shrinkage
method to be used for regression coefficients in all models
or a named vector specifying the type of shrinkage to be
used in the models given as names.</p></dd>
<dt>ppc</dt>
<dd><p>logical: should monitors for posterior predictive checks be
set? (not yet used)</p></dd>
<dt>seed</dt>
<dd><p>optional; seed value (for reproducibility)</p></dd>
<dt>inits</dt>
<dd><p>optional; specification of initial values in the form of a list
or a function (see <code><a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">jags.model</a></code>).
If omitted, starting values for the random number generator are
created by <strong>JointAI</strong>, initial values are then generated
by JAGS.
It is an error to supply an initial value for an observed node.</p></dd>
<dt>warn</dt>
<dd><p>logical; should warnings be given? Default is
<code>TRUE</code>.</p></dd>
<dt>mess</dt>
<dd><p>logical; should messages be given? Default is
<code>TRUE</code>.</p></dd>
<dt>...</dt>
<dd><p>additional, optional arguments</p><dl><dt><code>trunc</code></dt>
<dd><p>named list specifying limits of truncation for the
distribution of the named incomplete variables (see the
vignette
<a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html#functions-with-restricted-support">ModelSpecification</a>)</p></dd>

<dt><code>hyperpars</code></dt>
<dd><p>list of hyper-parameters, as obtained by
<code><a href="default_hyperpars.html">default_hyperpars</a>()</code></p></dd>

<dt><code>scale_vars</code></dt>
<dd><p>named vector of (continuous) variables that
will be centred and scaled (such that mean = 0 and sd = 1)
when they enter a linear predictor to improve
convergence of the MCMC sampling. Default is that all
numeric variables and integer variables with &gt;20 different
values will be scaled.
If set to <code>FALSE</code> no scaling will be done.</p></dd>

<dt><code>custom</code></dt>
<dd><p>named list of JAGS model chunks (character strings)
that replace the model for the given variable.</p></dd>

<dt><code>append_data_list</code></dt>
<dd><p>list that will be appended to the list
containing the data that is passed to <strong>rjags</strong>
(<code>data_list</code>). This may be necessary if additional data /
variables are needed for custom (covariate) models.</p></dd>

<dt><code>progress.bar</code></dt>
<dd><p>character string specifying the type of
progress bar. Possible values are "text" (default), "gui",
and "none" (see <code>update</code>). Note: when
sampling is performed in parallel it is not possible to
display a progress bar.</p></dd>

<dt><code>quiet</code></dt>
<dd><p>logical; if <code>TRUE</code> then messages generated by
<strong>rjags</strong> during compilation as well as the progress bar
for the adaptive phase will be suppressed,
(see <code><a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">jags.model</a></code>)</p></dd>

<dt><code>keep_scaled_mcmc</code></dt>
<dd><p>should the "original" MCMC sample (i.e.,
the scaled version returned by <code>coda.samples()</code>) be
kept? (The MCMC sample that is re-scaled to the scale of the
data is always kept.)</p></dd>

<dt><code>modelname</code></dt>
<dd><p>character string specifying the name of the
model file (including the ending, either .R or .txt). If
unspecified a random name will be generated.</p></dd>

<dt><code>modeldir</code></dt>
<dd><p>directory containing the model file or directory
in which the model file should be written. If unspecified a
temporary directory will be created.</p></dd>

<dt><code>overwrite</code></dt>
<dd><p>logical; whether an existing model file with
the specified <code>&lt;modeldir&gt;/&lt;modelname&gt;</code> should be
overwritten. If set to <code>FALSE</code> and a model already
exists, that model will be used. If unspecified (<code>NULL</code>)
and a file exists, the user is asked for input on how to
proceed.</p></dd>

<dt><code>keep_model</code></dt>
<dd><p>logical; whether the created JAGS model file
should be saved or removed from (<code>FALSE</code>; default) when
the sampling has finished.</p></dd>


</dl></dd>
<dt>family</dt>
<dd><p>only for <code>glm_imp</code> and <code>glmm_imp</code>/<code>glmer_imp</code>:
a description of the distribution and link function to
be used in the model. This can be a character string naming a
family function, a family function or the result of a call to
a family function. (For more details see below and
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code>.)</p></dd>
<dt>nonprop</dt>
<dd><p>optional named list of one-sided formulas specifying
covariates that have non-proportional effects in cumulative
logit models. These covariates should also be part of the
regular model formula, and the names of the list should be
the names of the ordinal response variables.</p></dd>
<dt>rev</dt>
<dd><p>optional character vector; vector of ordinal outcome variable
names for which the odds should be reversed, i.e.,
\(logit(y\le k)\) instead of \(logit(y &gt; k)\).</p></dd>
<dt>fixed</dt>
<dd><p>a two sided formula describing the fixed-effects part of the
model (see <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>)</p></dd>
<dt>random</dt>
<dd><p>only for multi-level models:
a one-sided formula of the form <code>~x1 + ... + xn | g</code>,
where <code>x1 + ... + xn</code> specifies the model for the random
effects and <code>g</code> the grouping variable</p></dd>
<dt>rd_vcov</dt>
<dd><p>character string or list specifying the structure of the
random effects variance covariance matrix, see details below.</p></dd>
<dt>df_basehaz</dt>
<dd><p>degrees of freedom for the B-spline used to model the
baseline hazard in proportional hazards models
(<code>coxph_imp</code> and <code>JM_imp</code>)</p></dd>
<dt>timevar</dt>
<dd><p>name of the variable indicating the time of the measurement of
a time-varying covariate in a proportional hazards survival
model (also in a joint model).
The variable specified in
"timevar" will automatically be added to "no_model".</p></dd>
<dt>assoc_type</dt>
<dd><p>named vector specifying the type of the association used
for a time-varying covariate in the linear predictor of the
survival model when using a "JM" model.
Implemented options are "underl.value"
(linear predictor; default for covariates modelled using a
Gaussian, Gamma, beta or log-normal distribution)
covariates) and "obs.value" (the observed/imputed value;
default for covariates modelled using other distributions).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <a href="JointAIObject.html">JointAI</a>.</p>
    </div>
    <div id="model-formulas">
    <h2>Model formulas</h2>
    
<div class="section">
<h3 id="random-effects">Random effects<a class="anchor" aria-label="anchor" href="#random-effects"></a></h3>


<p>It is possible to specify multi-level models as it is done in the package
<a href="https://CRAN.R-project.org/package=nlme" class="external-link"><span class="pkg">nlme</span></a>,
using <code>fixed</code> and <code>random</code>, or as it is done in the package
<a href="https://CRAN.R-project.org/package=lme4" class="external-link"><span class="pkg">lme4</span></a>,
using <code>formula</code> and specifying the random effects in brackets:</p><div class="sourceCode r"><pre><code><span class="va">formula</span> <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></code></pre><p></p></div>
<p>is equivalent to</p><div class="sourceCode r"><pre><code>fixed = y ~ x1 + x2 + x3, random = ~ 1|id
</code></pre><p></p></div>
</div>

<div class="section">
<h3 id="multiple-levels-of-grouping">Multiple levels of grouping<a class="anchor" aria-label="anchor" href="#multiple-levels-of-grouping"></a></h3>


<p>For multiple levels of grouping the specification using <code>formula</code>
should be used. There is no distinction between nested and crossed random
effects, i.e., <code>... + (1 | id) + (1 | center)</code> is treated the same as
<code>... + (1 | center/id)</code>.</p>
</div>

<div class="section">
<h3 id="nested-vs-crossed-random-effects">Nested vs crossed random effects<a class="anchor" aria-label="anchor" href="#nested-vs-crossed-random-effects"></a></h3>


<p>The distinction between nested and crossed random effects should come from
the levels of the grouping variables, i.e., if <code>id</code> is nested in
<code>center</code>, then there cannot be observations with the same <code>id</code>
but different values for <code>center</code>.</p>
</div>

<div class="section">
<h3 id="modelling-multiple-models-simultaneously-amp-joint-models">Modelling multiple models simultaneously &amp; joint models<a class="anchor" aria-label="anchor" href="#modelling-multiple-models-simultaneously-amp-joint-models"></a></h3>


<p>To fit multiple main models at the same time, a <code>list</code> of <code>formula</code>
objects can be passed to the argument <code>formula</code>.
Outcomes of one model may be contained as covariates in another model and
it is possible to combine models for variables on different levels,
for example:</p><div class="sourceCode r"><pre><code><span class="va">formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="va">time</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,
                     <span class="va">x2</span> <span class="op">~</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">x5</span><span class="op">)</span></code></pre><p></p></div>
<p>This principle is also used for the specification of a joint model for
longitudinal and survival data.</p>
<p>Note that it is not possible to specify multiple models for the same outcome
variable.</p><div class="section">
<h4 id="random-effects-variance-covariance-structure">Random effects variance-covariance structure<a class="anchor" aria-label="anchor" href="#random-effects-variance-covariance-structure"></a></h4>


<p>(Note: This feature is new and has not been fully tested yet.)</p>
<p>By default, a block-diagonal structure is assumed for the variance-covariance
matrices of the random effects in models with random effects. This means that
per outcome and level random effects are assumed to be correlated, but
random effects of different outcomes are modelled as independent.
The argument <code>rd_vcov</code> allows the user specify different assumptions about
these variance-covariance matrices. Implemented structures are <code>full</code>,
<code>blockdiag</code> and <code>indep</code> (all off-diagonal elements are zero).</p>
<p>If <code>rd_vcov</code> is set to one of these options, the structure is assumed for
all random effects variance-covariance matrices.
Alternatively, it is possible to specify a named list of vectors, where
the names are the structures and the vectors contain the names of the
response variables which are included in this structure.</p>
<p>For example, for a multivariate mixed model with five outcomes
<code>y1</code>, ..., <code>y5</code>, the specification could be:</p><div class="sourceCode r"><pre><code><span class="va">rd_vcov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>blockdiag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>,
               full <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y3"</span>, <span class="st">"y4"</span><span class="op">)</span>,
               indep <span class="op">=</span> <span class="st">"y5"</span><span class="op">)</span></code></pre><p></p></div>
<p>This would entail that the random effects for <code>y3</code> and <code>y4</code> are assumed to
be correlated (within and across outcomes),
random effects for <code>y1</code> and <code>y2</code> are assumed to be correlated within each
outcome, and the random effects for <code>y5</code> are assumed to be independent.</p>
<p>It is possible to have multiple sets of response variables for which separate
full variance-covariance matrices are used, for example:</p><div class="sourceCode r"><pre><code><span class="va">rd_vcov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>full <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y5"</span><span class="op">)</span>,
               full <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y3"</span>, <span class="st">"y4"</span><span class="op">)</span><span class="op">)</span></code></pre><p></p></div>
<p>In models with multiple levels of nesting, separate structures can be
specified per level:</p><div class="sourceCode r"><pre><code><span class="va">rd_vcov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>blockdiag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>,
                         full <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y3"</span>, <span class="st">"y4"</span><span class="op">)</span>,
                         indep <span class="op">=</span> <span class="st">"y5"</span><span class="op">)</span>,
              center <span class="op">=</span> <span class="st">"indep"</span><span class="op">)</span></code></pre><p></p></div>
</div>


</div>

<div class="section">
<h3 id="survival-models-with-frailties-or-time-varying-covariates">Survival models with frailties or time-varying covariates<a class="anchor" aria-label="anchor" href="#survival-models-with-frailties-or-time-varying-covariates"></a></h3>


<p>Random effects specified in brackets can also be used to indicate a
multi-level structure in survival models, as would, for instance be needed
in a multi-centre setting, where patients are from multiple hospitals.</p>
<p>It also allows to model time-dependent covariates in a proportional
hazards survival model (using <code>coxph_imp</code>), also in combination with
additional grouping levels.</p>
<p>In time-dependent proportional hazards models,
last-observation-carried-forward is used to fill in missing values in the
time-varying covariates, and to determine the value of the covariate at the
event time. Preferably, all time-varying covariates should be measured at
baseline (<code>timevar = 0</code>). If a value for a time-varying covariate needs to be
filled in and there is no previous observation, the next observation will be
carried backward.</p>
</div>

<div class="section">
<h3 id="differences-to-basic-regression-models">Differences to basic regression models<a class="anchor" aria-label="anchor" href="#differences-to-basic-regression-models"></a></h3>


<p>It is not possible to specify transformations of outcome variables, i.e.,
it is not possible to use a model formula like</p><div class="sourceCode r"><pre><code><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span></code></pre><p></p></div>
<p>In the specific case of a transformation with the natural logarithm,
a log-normal model can be used instead of a normal model.</p>
<p>Moreover, it is not possible to use <code>.</code> to indicate that all variables in a
<code>data.frame</code> other than the outcome variable should be used as covariates.
I.e., a formula <code>y ~ .</code> is not valid in <strong>JointAI</strong>.</p>
</div>

    </div>
    <div id="data-structure">
    <h2>Data structure</h2>
    <p>For multi-level settings, the data must be in long format, so that repeated
measurements are recorded in separate rows.</p>
<p>For survival data with time-varying covariates (<code>coxph_imp</code> and
<code>JM_imp</code>) the data should also be in long format. The
survival/censoring times and event indicator variables must be stored in
separate variables in the same data and should be constant across all rows
referring to the same subject.</p>
<p>During the pre-processing of the data the survival/censoring times will
automatically be merged with the observation times of the  time-varying
covariates (which must be supplied via the argument <code>timevar</code>).</p>
<p>It is possible to have multiple time-varying covariates, which do not
have to be measured at the same time points, but there can only be one
<code>timevar</code>.</p>
    </div>
    <div id="distribution-families-and-link-functions">
    <h2>Distribution families and link functions</h2>
    
<table class="table table"><tr><td><code>gaussian</code></td><td>with links: <code>identity</code>, <code>log</code></td></tr><tr><td><code>binomial</code></td><td>with links: <code>logit</code>, <code>probit</code>, <code>log</code>,
<code>cloglog</code></td></tr><tr><td><code>Gamma</code></td><td>with links: <code>inverse</code>, <code>identity</code>,
<code>log</code></td></tr><tr><td><code>poisson</code></td><td>with links: <code>log</code>, <code>identity</code></td></tr></table></div>
    <div id="imputation-methods-model-types">
    <h2>Imputation methods / model types</h2>
    <p>Implemented model types that can be chosen in the argument <code>models</code>
for baseline covariates (not repeatedly measured) are:</p><table class="table table"><tr><td><code>lm</code></td><td>linear (normal) model with identity link
(alternatively: <code>glm_gaussian_identity</code>); default for
continuous variables</td></tr><tr><td><code>glm_gaussian_log</code></td><td>linear (normal) model with log link</td></tr><tr><td><code>glm_gaussian_inverse</code></td><td>linear (normal) model with inverse link</td></tr><tr><td><code>glm_logit</code></td><td>logistic model for binary data
(alternatively: <code>glm_binomial_logit</code>);
default for binary variables</td></tr><tr><td><code>glm_probit</code></td><td>probit model for binary data
(alternatively: <code>glm_binomial_probit</code>)</td></tr><tr><td><code>glm_binomial_log</code></td><td>binomial model with log link</td></tr><tr><td><code>glm_binomial_cloglog</code></td><td>binomial model with complementary
log-log link</td></tr><tr><td><code>glm_gamma_inverse</code></td><td>gamma model with inverse link for skewed
continuous data</td></tr><tr><td><code>glm_gamma_identity</code></td><td>gamma model with identity link for skewed
continuous data</td></tr><tr><td><code>glm_gamma_log</code></td><td>gamma model with log link for skewed continuous
data</td></tr><tr><td><code>glm_poisson_log</code></td><td>Poisson model with log link for count data</td></tr><tr><td><code>glm_poisson_identity</code></td><td>Poisson model with identity link for count
data</td></tr><tr><td><code>lognorm</code></td><td>log-normal model for skewed continuous data</td></tr><tr><td><code>beta</code></td><td>beta model (with logit link) for skewed continuous
data in (0, 1)</td></tr><tr><td><code>mlogit</code></td><td>multinomial logit model for unordered categorical
variables;
default for unordered factors with &gt;2 levels</td></tr><tr><td><code>clm</code></td><td>cumulative logit model for ordered categorical variables;
default for ordered factors</td></tr></table><p>For repeatedly measured variables the following model types are available:</p><table class="table table"><tr><td><code>lmm</code></td><td>linear (normal) mixed model with identity link
(alternatively: <code>glmm_gaussian_identity</code>);
default for continuous variables</td></tr><tr><td><code>glmm_gaussian_log</code></td><td>linear (normal) mixed model with log link</td></tr><tr><td><code>glmm_gaussian_inverse</code></td><td>linear (normal) mixed model with
inverse link</td></tr><tr><td><code>glmm_logit</code></td><td>logistic mixed model for binary data
(alternatively: <code>glmm_binomial_logit</code>);
default for binary variables</td></tr><tr><td><code>glmm_probit</code></td><td>probit model for binary data
(alternatively: <code>glmm_binomial_probit</code>)</td></tr><tr><td><code>glmm_binomial_log</code></td><td>binomial mixed model with log link</td></tr><tr><td><code>glmm_binomial_cloglog</code></td><td>binomial mixed model with complementary
log-log link</td></tr><tr><td><code>glmm_gamma_inverse</code></td><td>gamma mixed model with inverse link for
skewed continuous data</td></tr><tr><td><code>glmm_gamma_identity</code></td><td>gamma mixed model with identity link for
skewed continuous data</td></tr><tr><td><code>glmm_gamma_log</code></td><td>gamma mixed model with log link for skewed
continuous data</td></tr><tr><td><code>glmm_poisson_log</code></td><td>Poisson mixed model with log link for
count data</td></tr><tr><td><code>glmm_poisson_identity</code></td><td>Poisson mixed model with identity link for
count data</td></tr><tr><td><code>glmm_lognorm</code></td><td>log-normal mixed model for skewed covariates</td></tr><tr><td><code>glmm_beta</code></td><td>beta mixed model for continuous data in (0, 1)</td></tr><tr><td><code>mlogitmm</code></td><td>multinomial logit mixed model for unordered categorical
variables;
default for unordered factors with &gt;2 levels</td></tr><tr><td><code>clmm</code></td><td>cumulative logit mixed model for ordered factors;
default for ordered factors</td></tr></table><p>When models are specified for only a subset of the variables for which a
model is needed, the default model choices (as indicated in the tables)
are used for the unspecified variables.</p>
    </div>
    <div id="parameters-to-follow-monitor-params-">
    <h2>Parameters to follow (<code>monitor_params</code>)</h2>
    <p>See also the vignette:
<a href="https://nerler.github.io/JointAI/articles/SelectingParameters.html">Parameter Selection</a><br></p>
<p>Named vector specifying which parameters should be monitored. This can be
done either directly by specifying the name of the parameter or indirectly
by one of the key words selecting a set of parameters.
Except for <code>other</code>, in which parameter names are specified directly,
parameter (groups) are just set as <code>TRUE</code> or <code>FALSE</code>.</p>
<p>Models are divided into two groups, the main models, which are the models
for which the user has explicitly specified a formula (via <code>formula</code>
or <code>fixed</code>), and all other models, for which models were specified
automatically.</p>
<p>If left unspecified, <code>monitor_params = c("analysis_main" = TRUE)</code>
will be used.</p>
<table class="table table"><tr><td><strong>name/key word</strong></td><td><strong>what is monitored</strong></td></tr><tr><td><code>analysis_main</code></td><td><code>betas</code> and <code>sigma_main</code>, <code>tau_main</code>
(for beta regression) or <code>shape_main</code>
(for parametric survival models), <code>gamma_main</code>
(for cumulative logit models),
codeD_main (for multi-level models) and
<code>basehaz</code> in proportional hazards models)</td></tr><tr><td><code>analysis_random</code></td><td><code>ranef_main</code>, <code>D_main</code>,
<code>invD_main</code>, <code>RinvD_main</code></td></tr><tr><td><code>other_models</code></td><td><code>alphas</code>, <code>tau_other</code>, <code>gamma_other</code>,
<code>delta_other</code></td></tr><tr><td><code>imps</code></td><td>imputed values</td></tr><tr><td><code>betas</code></td><td>regression coefficients of the main analysis model</td></tr><tr><td><code>tau_main</code></td><td>precision of the residuals from the main analysis
model(s)</td></tr><tr><td><code>sigma_main</code></td><td>standard deviation of the residuals from the main
analysis model(s)</td></tr><tr><td><code>gamma_main</code></td><td>intercepts in ordinal main model(s)</td></tr><tr><td><code>delta_main</code></td><td>increments of ordinal main model(s)</td></tr><tr><td><code>ranef_main</code></td><td>random effects from the main analysis model(s)
<code>b</code></td></tr><tr><td><code>D_main</code></td><td>covariance matrix of the random effects from the
main model(s)</td></tr><tr><td><code>invD_main</code></td><td>inverse(s) of <code>D_main</code></td></tr><tr><td><code>RinvD_main</code></td><td>matrices in the priors for <code>invD_main</code></td></tr><tr><td><code>alphas</code></td><td>regression coefficients in the covariate models</td></tr><tr><td><code>tau_other</code></td><td>precision parameters of the residuals from
covariate models</td></tr><tr><td><code>gamma_other</code></td><td>intercepts in ordinal covariate models</td></tr><tr><td><code>delta_other</code></td><td>increments of ordinal intercepts</td></tr><tr><td><code>ranef_other</code></td><td>random effects from the other  models <code>b</code></td></tr><tr><td><code>D_other</code></td><td>covariance matrix of the random effects from the
other models</td></tr><tr><td><code>invD_other</code></td><td>inverses of <code>D_other</code></td></tr><tr><td><code>RinvD_other</code></td><td>matrices in the priors for <code>invD_other</code></td></tr><tr><td><code>other</code></td><td>additional parameters</td></tr></table><p><strong>For example:</strong><br><code>monitor_params = c(analysis_main = TRUE, tau_main = TRUE,
sigma_main = FALSE)</code>
would monitor the regression parameters <code>betas</code> and the
residual precision <code>tau_main</code> instead of the residual standard
deviation <code>sigma_main</code>.</p>
<p>For a linear model, <code>monitor_params = c(imps = TRUE)</code> would monitor
<code>betas</code>, and <code>sigma_main</code> (because <code>analysis_main = TRUE</code> by
default) as well as the imputed values.</p>
<p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>
    <div id="cumulative-logit-mixed-models">
    <h2>Cumulative logit (mixed) models</h2>
    

<p>In the default setting for cumulative logit models, i.e, <code>rev = NULL</code>, the
odds for a variable <em></em>\(y\) with <em></em>\(K\) ordered categories
are defined as \[\log\left(\frac{P(y_i &gt; k)}{P(y_i \leq k)}\right) =
\gamma_k + \eta_i, \quad k = 1, \ldots, K-1,\] where
<em></em>\(\gamma_k\) is a category specific intercept and
<em></em>\(\eta_i\) the subject specific linear predictor.</p>
<p>To reverse the odds to \[\log\left(\frac{P(y_i \leq k)}{P(y_i &gt;
k)}\right) = \gamma_k + \eta_i, \quad k = 1, \ldots, K-1,\] the name of
the response variable has to be specified in the argument <code>rev</code>, e.g., <code>rev = c("y")</code>.</p>
<p>By default, proportional odds are assumed and only the intercepts differ
per category of the ordinal response. To allow for non-proportional odds,
i.e.,
\[\log\left(\frac{P(y_i &gt; k)}{P(y_i \leq k)}\right) =
\gamma_k + \eta_i + \eta_{ki}, \quad k = 1, \ldots, K-1,\]
the argument <code>nonprop</code> can be specified. It takes a one-sided formula or
a list of one-sided formulas. When a single formula is supplied, or a
unnamed list with just one element, it is assumed that the formula
corresponds to the main model.
To specify non-proportional effects for linear predictors in models for
ordinal covariates, the list has to be named with the names of the
ordinal response variables.</p>
<p>For example, the following three specifications are equivalent and assume a
non-proportional effect of <code>C1</code> on <code>O1</code>, but <code>C1</code> is assumed to have a
proportional effect on the incomplete ordinal covariate <code>O2</code>:</p><div class="sourceCode r"><pre><code><span class="fu"><a href="../reference/model_imp.html">clm_imp</a></span><span class="op">(</span><span class="va">O1</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">B2</span> <span class="op">+</span> <span class="va">O2</span>, data <span class="op">=</span> <span class="va">wideDF</span>, nonprop <span class="op">=</span> <span class="op">~</span> <span class="va">C1</span><span class="op">)</span>
<span class="fu"><a href="../reference/model_imp.html">clm_imp</a></span><span class="op">(</span><span class="va">O1</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">B2</span> <span class="op">+</span> <span class="va">O2</span>, data <span class="op">=</span> <span class="va">wideDF</span>, nonprop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="va">C1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/model_imp.html">clm_imp</a></span><span class="op">(</span><span class="va">O1</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">B2</span> <span class="op">+</span> <span class="va">O2</span>, data <span class="op">=</span> <span class="va">wideDF</span>, nonprop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>O1 <span class="op">=</span> <span class="op">~</span> <span class="va">C1</span><span class="op">)</span><span class="op">)</span></code></pre><p></p></div>
<p>To specify non-proportional effects on <code>O2</code>, a named list has to be provided:</p><div class="sourceCode r"><pre><code><span class="fu"><a href="../reference/model_imp.html">clm_imp</a></span><span class="op">(</span><span class="va">O1</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">B2</span> <span class="op">+</span> <span class="va">O2</span> <span class="op">+</span> <span class="va">B1</span>, data <span class="op">=</span> <span class="va">wideDF</span>,
        nonprop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>O1 <span class="op">=</span> <span class="op">~</span> <span class="va">C1</span>,
                       O2 <span class="op">=</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">B1</span><span class="op">)</span><span class="op">)</span></code></pre><p></p></div>
<p>The variables for which a non-proportional effect is assumed also have to be
part of the regular model formula.</p>
    </div>
    <div id="custom-model-parts">
    <h2>Custom model parts</h2>
    

<p>(Note: This feature is experimental and has not been fully tested yet.)</p>
<p>Via the argument <code>custom</code> it is possible to provide custom sub-models that
replace the sub-models that are automatically generated by <strong>JointAI</strong>.</p>
<p>Using this feature it is, for instance, possible to use the value of
a repeatedly measured variable at a specific time point as covariate in
another model. An example would be the use of "baseline" cholesterol
(<code>chol</code> at <code>day = 0</code>) as covariate in a survival model.</p>
<p>First, the variable <code>chol0</code> is added to the <code>PBC</code> data.
For most patients the value of cholesterol at baseline is observed, but not
for all. It is important that the data has a row with <code>day = 0</code> for each
patient.</p><div class="sourceCode r"><pre><code><span class="va">PBC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">PBC</span>,
             <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">PBC</span>, <span class="va">day</span> <span class="op">==</span> <span class="fl">0</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"chol"</span><span class="op">)</span><span class="op">)</span>,
             by <span class="op">=</span> <span class="st">"id"</span>, suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"0"</span><span class="op">)</span><span class="op">)</span></code></pre><p></p></div>
<p>Next, the custom piece of JAGS model syntax needs to be specified.
We loop here only over the patients for which the baseline cholesterol
is missing.</p><div class="sourceCode r"><pre><code><span class="va">calc_chol0</span> <span class="op">&lt;-</span> <span class="st">"
for (ii in 1:28) {
  M_id[row_chol0_id[ii], 3] &lt;- M_lvlone[row_chol0_lvlone[ii], 1]
  }"</span></code></pre><p></p></div>
<p>To be able to run the model with the custom imputation "model" for baseline
cholesterol we need to provide the numbers of the rows in the data matrices
that contain the missing values of baseline cholesterol and the rows that
contain the imputed cholesterol at <code>day = 0</code>:</p><div class="sourceCode r"><pre><code><span class="va">row_chol0_lvlone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">PBC</span><span class="op">$</span><span class="va">day</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">PBC</span><span class="op">$</span><span class="va">chol0</span><span class="op">)</span><span class="op">)</span>
<span class="va">row_chol0_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">PBC</span><span class="op">$</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">PBC</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">row_chol0_lvlone</span><span class="op">]</span></code></pre><p></p></div>
<p>Then we pass both the custom sub-model and the additional data to the
analysis function <code>coxph_imp()</code>. Note that we explicitly need to specify
the model for <code>chol</code>.</p><div class="sourceCode r"><pre><code><span class="fu"><a href="../reference/model_imp.html">coxph_imp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span> <span class="op">!=</span> <span class="st">"censored"</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">chol0</span>,
               <span class="va">chol</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">day</span> <span class="op">+</span> <span class="op">(</span><span class="va">day</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span>,
          no_model <span class="op">=</span> <span class="st">"day"</span>, data <span class="op">=</span> <span class="va">PBC</span>,
          append_data_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>row_chol0_lvlone <span class="op">=</span> <span class="va">row_chol0_lvlone</span>,
                                  row_chol0_id <span class="op">=</span> <span class="va">row_chol0_id</span><span class="op">)</span>,
          custom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>chol0 <span class="op">=</span> <span class="va">calc_chol0</span><span class="op">)</span><span class="op">)</span></code></pre><p></p></div>
    </div>
    <div id="note">
    <h2>Note</h2>
    

<div class="section">
<h3 id="coding-of-variables-">Coding of variables:<a class="anchor" aria-label="anchor" href="#coding-of-variables-"></a></h3>


<p>The default covariate (imputation) models are chosen based on the
<code>class</code> of each of the variables, distinguishing between <code>numeric</code>,
<code>factor</code> with two levels, unordered <code>factor</code> with &gt;2 levels and
ordered <code>factor</code> with &gt;2 levels.<br></p>
<p>When a continuous variable has only two different values it is
assumed to be binary and its coding and default (imputation) model will be
changed accordingly. This behaviour can be overwritten specifying a model
type via the argument <code>models</code>.<br></p>
<p>Variables of type <code>logical</code> are automatically converted to unordered
factors.<br></p><div class="section">
<h4 id="contrasts">Contrasts<a class="anchor" aria-label="anchor" href="#contrasts"></a></h4>


<p><strong>JointAI</strong> version <em></em>\(\geq\) 1.0.0 uses the globally (via
<code>options("contrasts")</code>) specified contrasts. However, for incomplete
categorical variables, for which the contrasts need to be re-calculated
within the JAGS model, currently only <code>contr.treatment</code> and <code>contr.sum</code> are
possible. Therefore, when an in complete ordinal covariate is used and the
default contrasts (<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.poly()</a></code>) are set to be used for ordered factors, a
warning message is printed and dummy coding (<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment()</a></code>) is used for
that variable instead.</p>
</div>


</div>

<div class="section">
<h3 id="non-linear-effects-and-transformation-of-variables-">Non-linear effects and transformation of variables:<a class="anchor" aria-label="anchor" href="#non-linear-effects-and-transformation-of-variables-"></a></h3>


<p><strong>JointAI</strong> handles non-linear effects, transformation of covariates
and interactions the following way:<br>
When, for instance, a model formula contains the function <code>log(x)</code> and
<code>x</code> has missing values, <code>x</code> will be imputed and used in the linear
predictor of models for which no formula was specified,
i.e., it is assumed that the other variables have a linear association with
<code>x</code>. The <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code> of the observed and imputed values of
<code>x</code> is calculated and used in the linear predictor of the main
analysis model.<br></p>
<p>If, instead of using <code>log(x)</code> in the model formula, a pre-calculated
variable <code>logx</code> is used, this variable is imputed directly
and used in the linear predictors of all models, implying that
variables that have <code>logx</code> in their linear predictors have a linear
association with <code>logx</code> but not with <code>x</code>.<br></p>
<p>When different transformations of the same incomplete variable are used in
one model it is strongly discouraged to calculate these transformations
beforehand and supply them as different variables.
If, for example, a model formula contains both <code>x</code> and <code>x2</code> (where
<code>x2</code> = <code>x^2</code>), they are treated as separate variables and imputed
with separate models. Imputed values of <code>x2</code> are thus not equal to the
square of imputed values of <code>x</code>.
Instead, <code>x</code> and <code>I(x^2)</code> should be used in the model formula.
Then only <code>x</code> is imputed and <code>x^2</code> is calculated from the imputed
values of <code>x</code> internally.</p>
<p>The same applies to interactions involving incomplete variables.</p>
</div>

<div class="section">
<h3 id="sequence-of-models-">Sequence of models:<a class="anchor" aria-label="anchor" href="#sequence-of-models-"></a></h3>


<p>Models generated automatically (i.e., not mentioned in <code>formula</code> or <code>fixed</code>
are specified in a sequence based on the level of the outcome of the
respective model in the multi-level hierarchy and within each level
according to the number of missing values.
This means that level-1 variables have all level-2, level-3, ... variables
in their linear predictor, and variables on the highest level only have
variables from the same level in their linear predictor.
Within each level, the variable with the most missing values has the most
variables in its linear predictor.</p>
</div>

<div class="section">
<h3 id="not-yet-possible-">Not (yet) possible:<a class="anchor" aria-label="anchor" href="#not-yet-possible-"></a></h3>


<ul><li><p>prediction (using <code>predict</code>) conditional on random effects</p></li>
<li><p>the use of splines for incomplete variables</p></li>
<li><p>the use of (or equivalents for) <code><a href="https://rdrr.io/pkg/survival/man/pspline.html" class="external-link">pspline</a></code>,
or <code><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></code> in survival models</p></li>
<li><p>left censored or interval censored data</p></li>
</ul></div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="set_refcat.html">set_refcat</a></code>,
<code><a href="traceplot.html">traceplot</a></code>, <code><a href="densplot.html">densplot</a></code>,
<code><a href="summary.JointAI.html">summary.JointAI</a></code>, <code><a href="MC_error.html">MC_error</a></code>,
<code><a href="GR_crit.html">GR_crit</a></code>,
<code><a href="predict.JointAI.html">predict.JointAI</a></code>, <code><a href="add_samples.html">add_samples</a></code>,
<code><a href="JointAIObject.html">JointAIObject</a></code>, <code><a href="add_samples.html">add_samples</a></code>,
<code><a href="parameters.html">parameters</a></code>, <code><a href="list_models.html">list_models</a></code></p>
<p>Vignettes</p><ul><li><p><a href="https://nerler.github.io/JointAI/articles/MinimalExample.html">Minimal Example</a></p></li>
<li><p><a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html">Model Specification</a></p></li>
<li><p><a href="https://nerler.github.io/JointAI/articles/SelectingParameters.html">Parameter Selection</a></p></li>
<li><p><a href="https://nerler.github.io/JointAI/articles/MCMCsettings.html">MCMC Settings</a></p></li>
<li><p><a href="https://nerler.github.io/JointAI/articles/AfterFitting.html">After Fitting</a></p></li>
<li><p><a href="https://nerler.github.io/JointAI/articles/TheoreticalBackground.html">Theoretical Background</a></p></li>
</ul></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Example 1: Linear regression with incomplete covariates</span></span>
<span class="r-in"><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">lm_imp</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">M1</span> <span class="op">+</span> <span class="va">B1</span>, data <span class="op">=</span> <span class="va">wideDF</span>, n.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 2: Logistic regression with incomplete covariates</span></span>
<span class="r-in"><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">glm_imp</span><span class="op">(</span><span class="va">B1</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">M1</span>, data <span class="op">=</span> <span class="va">wideDF</span>,</span>
<span class="r-in">                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, n.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 3: Linear mixed model with incomplete covariates</span></span>
<span class="r-in"><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">lme_imp</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">B2</span> <span class="op">+</span> <span class="va">c1</span> <span class="op">+</span> <span class="va">time</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">time</span><span class="op">|</span><span class="va">id</span>,</span>
<span class="r-in">                data <span class="op">=</span> <span class="va">longDF</span>, n.iter <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 4: Parametric Weibull survival model</span></span>
<span class="r-in"><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">survreg_imp</span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">meal.cal</span> <span class="op">+</span> <span class="va">wt.loss</span>,</span>
<span class="r-in">                    data <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/lung.html" class="external-link">lung</a></span>, n.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 5: Proportional hazards survival model</span></span>
<span class="r-in"><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">coxph_imp</span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">meal.cal</span> <span class="op">+</span> <span class="va">wt.loss</span>,</span>
<span class="r-in">                    data <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/lung.html" class="external-link">lung</a></span>, n.iter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 6: Joint model for longitudinal and survival data</span></span>
<span class="r-in"><span class="va">mod6</span> <span class="op">&lt;-</span> <span class="fu">JM_imp</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span> <span class="op">!=</span> <span class="st">'censored'</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span></span>
<span class="r-in">                    <span class="va">albumin</span> <span class="op">+</span> <span class="va">copper</span> <span class="op">+</span> <span class="va">trig</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span class="r-in">                    <span class="va">albumin</span> <span class="op">~</span> <span class="va">day</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="va">day</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                    timevar <span class="op">=</span> <span class="st">'day'</span>, data <span class="op">=</span> <span class="va">PBC</span>, n.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 7: Proportional hazards  model with a time-dependent covariate</span></span>
<span class="r-in"><span class="va">mod7</span> <span class="op">&lt;-</span> <span class="fu">coxph_imp</span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">status</span> <span class="op">!=</span> <span class="st">'censored'</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">copper</span> <span class="op">+</span></span>
<span class="r-in">                  <span class="va">trig</span> <span class="op">+</span> <span class="va">stage</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span class="r-in">                  timevar <span class="op">=</span> <span class="st">'day'</span>, data <span class="op">=</span> <span class="va">PBC</span>, n.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example 8: Parallel computation</span></span>
<span class="r-in"><span class="co"># If no strategy how the "future" should be handled is specified, the</span></span>
<span class="r-in"><span class="co"># MCMC chains are run sequentially.</span></span>
<span class="r-in"><span class="co"># To run MCMC chains in parallel, a strategy can be specified using the</span></span>
<span class="r-in"><span class="co"># package \pkg{future} (see ?future::plan), for example:</span></span>
<span class="r-in"><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod8</span> <span class="op">&lt;-</span> <span class="fu">lm_imp</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">C1</span> <span class="op">+</span> <span class="va">C2</span> <span class="op">+</span> <span class="va">B2</span>, data <span class="op">=</span> <span class="va">wideDF</span>, n.iter <span class="op">=</span> <span class="fl">500</span>, n.chains <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod8</span><span class="op">$</span><span class="va">comp_info</span><span class="op">$</span><span class="va">future</span></span>
<span class="r-in"><span class="co"># To re-set the strategy to sequential computation, the sequential strategy</span></span>
<span class="r-in"><span class="co"># can be specified:</span></span>
<span class="r-in"><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicole S. Erler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '0d21d69e7c3eb00e029f5b8d9424cd56',
    indexName: 'jointal',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

